'use strict';const _0x2d34e3=_0x317f;(function(_0x28b968,_0x4fd086){const _0x217148=_0x317f,_0x1aa7b8=_0x28b968();while(!![]){try{const _0x4fae0c=parseInt(_0x217148(0x193))/0x1*(-parseInt(_0x217148(0x18b))/0x2)+-parseInt(_0x217148(0x18d))/0x3*(-parseInt(_0x217148(0x1bd))/0x4)+parseInt(_0x217148(0x1c5))/0x5+parseInt(_0x217148(0x1b2))/0x6*(-parseInt(_0x217148(0x1bb))/0x7)+-parseInt(_0x217148(0x18e))/0x8+parseInt(_0x217148(0x1c3))/0x9+parseInt(_0x217148(0x194))/0xa;if(_0x4fae0c===_0x4fd086)break;else _0x1aa7b8['push'](_0x1aa7b8['shift']());}catch(_0x38c65e){_0x1aa7b8['push'](_0x1aa7b8['shift']());}}}(_0x4ad8,0xe49c0));var __decorate=this&&this['__decorate']||function(_0x184374,_0x382f42,_0x1bdd55,_0x1953e4){const _0x36e0e9=_0x317f;var _0x5a0c92=arguments[_0x36e0e9(0x1a8)],_0x500ea6=_0x5a0c92<0x3?_0x382f42:_0x1953e4===null?_0x1953e4=Object[_0x36e0e9(0x1bf)](_0x382f42,_0x1bdd55):_0x1953e4,_0x57ad73;if(typeof Reflect===_0x36e0e9(0x19d)&&typeof Reflect[_0x36e0e9(0x19f)]===_0x36e0e9(0x1c8))_0x500ea6=Reflect['decorate'](_0x184374,_0x382f42,_0x1bdd55,_0x1953e4);else{for(var _0x33279b=_0x184374[_0x36e0e9(0x1a8)]-0x1;_0x33279b>=0x0;_0x33279b--)if(_0x57ad73=_0x184374[_0x33279b])_0x500ea6=(_0x5a0c92<0x3?_0x57ad73(_0x500ea6):_0x5a0c92>0x3?_0x57ad73(_0x382f42,_0x1bdd55,_0x500ea6):_0x57ad73(_0x382f42,_0x1bdd55))||_0x500ea6;}return _0x5a0c92>0x3&&_0x500ea6&&Object[_0x36e0e9(0x1b7)](_0x382f42,_0x1bdd55,_0x500ea6),_0x500ea6;},__metadata=this&&this['__metadata']||function(_0x22722a,_0x4776d0){const _0x4e3fce=_0x317f;if(typeof Reflect===_0x4e3fce(0x19d)&&typeof Reflect['metadata']===_0x4e3fce(0x1c8))return Reflect['metadata'](_0x22722a,_0x4776d0);};Object[_0x2d34e3(0x1b7)](exports,_0x2d34e3(0x1ac),{'value':!![]}),exports[_0x2d34e3(0x1b9)]=void 0x0;function _0x317f(_0x2ccc73,_0x3ec8d9){const _0x4ad8b7=_0x4ad8();return _0x317f=function(_0x317fba,_0x2fa473){_0x317fba=_0x317fba-0x18b;let _0x498889=_0x4ad8b7[_0x317fba];return _0x498889;},_0x317f(_0x2ccc73,_0x3ec8d9);}function _0x4ad8(){const _0x36f24c=['AuthGuard','亲爱的用户,请登录后继续操作,我们正在等您的到来！','createTokenFromFingerprint','canActivate','defineProperty','moduleRef','JwtAuthGuard','jwt','1743SCErxj','get','2238296LARYsr','HttpException','getOwnPropertyDescriptor','handleRequest','log','getRequest','2321046FEbadD','AuthService','5499680xOraqw','env','RedisCacheService','function','56106meLdxm','getGoMaxAiToken','3BEulnj','8693192tYMjwy','user','extractToken','HttpStatus','headers','5KEdLvq','10912490TXxyRQ','authorization','@nestjs/core','visitor','checkTokenAuth','../../modules/globalConfig/globalConfig.service','includes','GlobalConfigService','ModuleRef','object','exit','decorate','../../modules/auth/auth.service','redisCacheService','authService','slice','../../modules/redisCache/redisCache.service','UNAUTHORIZED','id:\x20','fingerprint','length','globalConfigService','JWT_SECRET','@nestjs/passport','__esModule','BAD_REQUEST','decrypt','validateToken','../utils','err:\x20','20370AHdDQG'];_0x4ad8=function(){return _0x36f24c;};return _0x4ad8();}const redisCache_service_1=require(_0x2d34e3(0x1a4)),common_1=require('@nestjs/common'),passport_1=require(_0x2d34e3(0x1ab)),jwt=require('jsonwebtoken'),core_1=require(_0x2d34e3(0x196)),globalConfig_service_1=require(_0x2d34e3(0x199)),utils_1=require(_0x2d34e3(0x1b0)),auth_service_1=require(_0x2d34e3(0x1a0));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x2d34e3(0x1b3)])(_0x2d34e3(0x1ba)){constructor(_0x23673a,_0x130824,_0xff8735,_0xebf411){const _0xbdfb85=_0x2d34e3;super(),this[_0xbdfb85(0x1a1)]=_0x23673a,this[_0xbdfb85(0x1b8)]=_0x130824,this[_0xbdfb85(0x1a9)]=_0xff8735,this[_0xbdfb85(0x1a2)]=_0xebf411;}async[_0x2d34e3(0x1b6)](_0x2e9375){const _0x12c6b4=_0x2d34e3;let _0xbe6941=![];!this[_0x12c6b4(0x1a1)]&&(this[_0x12c6b4(0x1a1)]=this[_0x12c6b4(0x1b8)][_0x12c6b4(0x1bc)](redisCache_service_1[_0x12c6b4(0x1c7)],{'strict':![]}));const _0x135ec9=_0x2e9375['switchToHttp']()[_0x12c6b4(0x1c2)](),_0x45c72b=this[_0x12c6b4(0x190)](_0x135ec9);_0x135ec9[_0x12c6b4(0x18f)]=this[_0x12c6b4(0x1af)](_0x45c72b);if(_0x135ec9[_0x12c6b4(0x18f)]['role']===_0x12c6b4(0x197))throw new common_1['HttpException'](_0x12c6b4(0x1b4),common_1[_0x12c6b4(0x191)][_0x12c6b4(0x1a5)]);const _0xac4e15=this[_0x12c6b4(0x1a9)][_0x12c6b4(0x18c)]();if(_0xac4e15&&!_0x135ec9['path'][_0x12c6b4(0x19a)]('getInfo')){const _0xd79d87=(0x0,utils_1['getRandomItemFromArray'])(utils_1['copyRightMsg']);throw new common_1[(_0x12c6b4(0x1be))]((0x0,utils_1[_0x12c6b4(0x1ae)])(_0xd79d87),common_1[_0x12c6b4(0x191)][_0x12c6b4(0x1ad)]);}else _0xbe6941=!![];return!_0xbe6941&&process[_0x12c6b4(0x19e)](0x1),await this[_0x12c6b4(0x1a1)][_0x12c6b4(0x198)](_0x45c72b,_0x135ec9),!![];}[_0x2d34e3(0x190)](_0x77f311){const _0x49a2ae=_0x2d34e3;if(!_0x77f311[_0x49a2ae(0x192)]['authorization']){if(_0x77f311[_0x49a2ae(0x192)][_0x49a2ae(0x1a7)]){let _0xe5d6d4=_0x77f311[_0x49a2ae(0x192)]['fingerprint'];return _0xe5d6d4>0x7fffffff&&(_0xe5d6d4=_0xe5d6d4['toString']()[_0x49a2ae(0x1a3)](-0x9),_0xe5d6d4=Number(String(Number(_0xe5d6d4))),console[_0x49a2ae(0x1c1)](_0x49a2ae(0x1a6),_0xe5d6d4)),this[_0x49a2ae(0x1a2)][_0x49a2ae(0x1b5)](_0xe5d6d4);}return null;}const _0x39dc82=_0x77f311[_0x49a2ae(0x192)][_0x49a2ae(0x195)]['split']('\x20');if(_0x39dc82[_0x49a2ae(0x1a8)]!==0x2||_0x39dc82[0x0]!=='Bearer')return null;return _0x39dc82[0x1];}[_0x2d34e3(0x1af)](_0x19661e){const _0x52df94=_0x2d34e3;try{return jwt['verify'](_0x19661e,process[_0x52df94(0x1c6)][_0x52df94(0x1aa)]);}catch(_0x5c87f3){throw new common_1[(_0x52df94(0x1be))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1['HttpStatus'][_0x52df94(0x1a5)]);}}[_0x2d34e3(0x1c0)](_0x350496,_0x2a3d14,_0x108265){const _0x21c229=_0x2d34e3;if(_0x350496||!_0x2a3d14){console['log'](_0x21c229(0x1b1),_0x350496);throw _0x350496||new common_1['UnauthorizedException']();}return _0x2a3d14;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata('design:paramtypes',[redisCache_service_1[_0x2d34e3(0x1c7)],core_1[_0x2d34e3(0x19c)],globalConfig_service_1[_0x2d34e3(0x19b)],auth_service_1[_0x2d34e3(0x1c4)]])],JwtAuthGuard),exports[_0x2d34e3(0x1b9)]=JwtAuthGuard;