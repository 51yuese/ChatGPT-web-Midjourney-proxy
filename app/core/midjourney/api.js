'use strict';function _0x1b6f(){const _0x37455f=['data','nonce','5791707zDBHAS','describe','upload_url','post','status','530xSvcgB','/api/v9/channels/','4005883qiVJAX','upload_filename','then','imagine','type','length','8ZbYUhT','image/png','options','random','blend','814642PQjxAf','fetch','12155eQTdFC','./command','/attachments','uploadImage','POST','please\x20invoke\x20`init`\x20method\x20before\x20every\x20operate','nextNonce','info','getPayload','1lQDwYz','session_id','MidjourneyCommand','map','application/json','opts','apiBaseUrl','guild_id','createRandomId','waitMessage','REQUEST_SUCCESS','3zzVJNt','3618498cYqyMx','fast','upload\x20image\x20fail,\x20no\x20attachment','discordsaysUrl','filter','stringify','replace','varyRegion','attachments','interactions','log','getCommand','channel_id','settings','310sjuPvo','upload\x20image\x20fail,\x20because\x20of\x20upload\x20fail','regionNonce:\x20','isomorphic-fetch','MidjourneyApi','24xDKlrh','REQUEST_FAILED','all','__esModule','40074aoNFOb','/inpaint/api/submit-job','setAttachment','catch','325384jNutct','assign','inpaint','relax','action','936929561302675456','token'];_0x1b6f=function(){return _0x37455f;};return _0x1b6f();}const _0xe8b49=_0x50c1;(function(_0xecec7e,_0x23711d){const _0x3cb7ad=_0x50c1,_0x3b43ee=_0xecec7e();while(!![]){try{const _0x113be3=-parseInt(_0x3cb7ad(0x179))/0x1*(-parseInt(_0x3cb7ad(0x16e))/0x2)+parseInt(_0x3cb7ad(0x184))/0x3*(-parseInt(_0x3cb7ad(0x153))/0x4)+-parseInt(_0x3cb7ad(0x146))/0x5*(parseInt(_0x3cb7ad(0x14f))/0x6)+parseInt(_0x3cb7ad(0x163))/0x7+-parseInt(_0x3cb7ad(0x169))/0x8*(parseInt(_0x3cb7ad(0x15c))/0x9)+-parseInt(_0x3cb7ad(0x161))/0xa*(parseInt(_0x3cb7ad(0x170))/0xb)+-parseInt(_0x3cb7ad(0x14b))/0xc*(-parseInt(_0x3cb7ad(0x185))/0xd);if(_0x113be3===_0x23711d)break;else _0x3b43ee['push'](_0x3b43ee['shift']());}catch(_0x4b87c2){_0x3b43ee['push'](_0x3b43ee['shift']());}}}(_0x1b6f,0x52b3e));Object['defineProperty'](exports,_0xe8b49(0x14e),{'value':!![]}),exports[_0xe8b49(0x14a)]=void 0x0;function _0x50c1(_0x4587e0,_0x4bd5cd){const _0x1b6fef=_0x1b6f();return _0x50c1=function(_0x50c1e5,_0x42316d){_0x50c1e5=_0x50c1e5-0x13d;let _0x2ad2a0=_0x1b6fef[_0x50c1e5];return _0x2ad2a0;},_0x50c1(_0x4587e0,_0x4bd5cd);}const fetch=require(_0xe8b49(0x149)),command_1=require(_0xe8b49(0x171)),utils_1=require('./utils');class MidjourneyApi extends command_1[_0xe8b49(0x17b)]{constructor(_0x3ffbf9){const _0x4711b5=_0xe8b49;super(_0x3ffbf9),this[_0x4711b5(0x17e)]=_0x3ffbf9;}['interactions'](_0x42a976,_0x36ca40){const _0x3f1c46=_0xe8b49,_0x2bfb86={'Content-Type':'application/json','Authorization':this[_0x3f1c46(0x17e)][_0x3f1c46(0x159)]};return fetch(this['opts'][_0x3f1c46(0x17f)]+'/api/v9/interactions',{'method':_0x3f1c46(0x174),'body':JSON[_0x3f1c46(0x13d)](_0x42a976),'headers':_0x2bfb86})['then'](_0x342fb3=>_0x342fb3['ok']?_0x36ca40?.('REQUEST_SUCCESS',_0x342fb3):_0x36ca40?.(_0x3f1c46(0x14c),_0x342fb3))[_0x3f1c46(0x152)](_0x4c7639=>_0x36ca40?.(_0x3f1c46(0x14c),_0x4c7639));}[_0xe8b49(0x178)](_0x4892fc,_0x4cc47a,_0x3e2644={},_0x1a9d05=(0x0,utils_1[_0xe8b49(0x176)])()){const _0x31a164=_0xe8b49;if(!this[_0x31a164(0x17e)][_0x31a164(0x17a)])throw new Error(_0x31a164(0x175));return Object[_0x31a164(0x154)]({'type':_0x4892fc,'application_id':_0x31a164(0x158),'guild_id':this[_0x31a164(0x17e)][_0x31a164(0x180)],'channel_id':this[_0x31a164(0x17e)][_0x31a164(0x144)],'session_id':this['opts'][_0x31a164(0x17a)],'nonce':_0x1a9d05,'data':_0x4cc47a},_0x3e2644);}['inpaint'](_0x41b0ce,_0x12184a,_0x2a602f,_0x2e007b){const _0x4cd7f0=_0xe8b49,_0x337804={'Content-Type':_0x4cd7f0(0x17d)};return fetch(this[_0x4cd7f0(0x17e)][_0x4cd7f0(0x188)]+_0x4cd7f0(0x150),{'method':'POST','body':JSON[_0x4cd7f0(0x13d)]({'customId':_0x41b0ce,'prompt':_0x12184a,'mask':_0x2a602f[_0x4cd7f0(0x13e)](/^data:.+?;base64,/,''),'userId':'0','username':'0','full_prompt':null}),'headers':_0x337804})['then'](_0x41dcce=>_0x41dcce['ok']?_0x2e007b?.(_0x4cd7f0(0x183),_0x41dcce):_0x2e007b?.(_0x4cd7f0(0x14c),_0x41dcce))[_0x4cd7f0(0x152)](_0x341216=>_0x2e007b?.(_0x4cd7f0(0x14c),_0x341216));}async[_0xe8b49(0x166)](_0x4c8b0c,_0x5af4a1){const _0x14b20b=_0xe8b49;return this[_0x14b20b(0x143)](_0x14b20b(0x166))['then'](_0x362481=>{const _0x158a19=_0x14b20b,_0x2b5c7c=this['getPayload'](0x2,Object[_0x158a19(0x154)](_0x362481,{'options':[{..._0x362481?.[_0x158a19(0x16b)][0x0],'value':_0x4c8b0c}]}));return Promise['all']([this[_0x158a19(0x141)](_0x2b5c7c,_0x5af4a1),this['opts']['ws']?.[_0x158a19(0x182)]({'nonce':_0x2b5c7c[_0x158a19(0x15b)],'cb':_0x5af4a1})])[_0x158a19(0x165)](([_0x38c7aa,_0x2c7623])=>_0x2c7623);});}async[_0xe8b49(0x151)](_0x4a7b0f){const _0x4065f5=_0xe8b49,_0x3406d6=this['opts'][_0x4065f5(0x17f)]+_0x4065f5(0x162)+this['opts'][_0x4065f5(0x144)]+_0x4065f5(0x172),_0x3453c5={'Content-Type':'application/json','Authorization':this[_0x4065f5(0x17e)][_0x4065f5(0x159)]},{files:_0x337b6a}=_0x4a7b0f;try{return await this[_0x4065f5(0x17e)][_0x4065f5(0x16f)](_0x3406d6,{'headers':_0x3453c5,'body':JSON[_0x4065f5(0x13d)](_0x337b6a),'method':_0x4065f5(0x15f)})[_0x4065f5(0x165)](_0x24ebfb=>_0x24ebfb['json']());}catch(_0xde7916){console[_0x4065f5(0x142)]('提交图片:\x20',_0xde7916);}}[_0xe8b49(0x181)](){const _0x1afa6d=_0xe8b49;return parseInt(Math[_0x1afa6d(0x16c)]()*0x3e8+'')+'';}async[_0xe8b49(0x173)](_0x2c39f2){const _0x3b8bc1=_0xe8b49,{buffer:_0x102a0f,filename:_0x406da1}=_0x2c39f2,_0x490eed=_0x102a0f[_0x3b8bc1(0x168)],_0x301dc8=this[_0x3b8bc1(0x181)](),_0x483e42=await this[_0x3b8bc1(0x151)]({'files':[{'filename':_0x406da1,'file_size':_0x490eed,'id':_0x301dc8,'is_clip':![]}]});if(_0x483e42['status']!=0xc8)throw new Error('upload\x20image\x20fail,\x20no\x20attachment');const _0x37bd21=_0x483e42[_0x3b8bc1(0x15a)];if(_0x37bd21[_0x3b8bc1(0x140)]?.['length']!=0x1)throw new Error(_0x3b8bc1(0x187));const _0x14effd=await this[_0x3b8bc1(0x17e)][_0x3b8bc1(0x16f)](_0x37bd21[_0x3b8bc1(0x140)][0x0][_0x3b8bc1(0x15e)],{'method':'put','body':_0x102a0f,'headers':{'Content-Type':_0x3b8bc1(0x16a)}});if(_0x14effd[_0x3b8bc1(0x160)]!=0xc8)throw new Error(_0x3b8bc1(0x147));const _0x4f0e1e=_0x37bd21['attachments'][0x0][_0x3b8bc1(0x164)],_0x4fd133=_0x4f0e1e['split']('/'),_0x661d23=_0x4fd133['length']>0x1?_0x4fd133[0x1]:_0x4fd133[0x0];return{'attachments':[{'id':_0x301dc8,'filename':_0x661d23,'uploaded_filename':_0x4f0e1e}]};}async[_0xe8b49(0x16d)](_0x234cd1,_0x2679f5){const _0x2ca15e=_0xe8b49;return this[_0x2ca15e(0x143)](_0x2ca15e(0x16d))['then'](_0x4de7a1=>{const _0x307bc7=_0x2ca15e,_0x490d9e=_0x4de7a1[_0x307bc7(0x16b)][_0x307bc7(0x189)](_0x4d405f=>_0x4d405f[_0x307bc7(0x167)]===0xb),_0x2f4a8e=_0x234cd1[_0x307bc7(0x17c)]((_0x2b57e6,_0x4e85d9)=>{return{..._0x490d9e[_0x4e85d9],'value':_0x2b57e6['id']};}),_0x4f2339=this[_0x307bc7(0x178)](0x2,Object[_0x307bc7(0x154)](_0x4de7a1,{'options':_0x2f4a8e,'attachments':_0x234cd1}));return Promise[_0x307bc7(0x14d)]([this['interactions'](_0x4f2339,_0x2679f5),this[_0x307bc7(0x17e)]['ws']?.['waitMessage']({'nonce':_0x4f2339[_0x307bc7(0x15b)],'cb':_0x2679f5})])[_0x307bc7(0x165)](([_0x25131c,_0x87c642])=>_0x87c642);});}async[_0xe8b49(0x15d)](_0x3d109c,_0x132f88){const _0x1e1401=_0xe8b49;return this['getCommand'](_0x1e1401(0x15d))['then'](_0x4a80cc=>{const _0x1b338f=_0x1e1401,_0x12bbab=this[_0x1b338f(0x178)](0x2,Object[_0x1b338f(0x154)](_0x4a80cc,{'options':[{..._0x4a80cc?.[_0x1b338f(0x16b)][0x0],'value':_0x3d109c[0x0]['id']}],'attachments':_0x3d109c}));return Promise[_0x1b338f(0x14d)]([this[_0x1b338f(0x141)](_0x12bbab,_0x132f88),this['opts']['ws']?.[_0x1b338f(0x182)]({'nonce':_0x12bbab[_0x1b338f(0x15b)],'cb':_0x132f88})])['then'](([_0x3d86f8,_0xf3b2ba])=>_0xf3b2ba);});}async[_0xe8b49(0x157)](_0x538299,_0x309cda,_0x5f3399,_0x5caafe){const _0x875815=_0xe8b49,_0x21f61c=this['getPayload'](0x3,{'component_type':0x2,'custom_id':_0x309cda},{'message_flags':_0x5f3399,'message_id':_0x538299});return Promise[_0x875815(0x14d)]([this[_0x875815(0x141)](_0x21f61c,_0x5caafe),this['opts']['ws']?.['waitMessage']({'nonce':_0x21f61c[_0x875815(0x15b)],'cb':_0x5caafe,'parentId':_0x538299})])[_0x875815(0x165)](([_0x4fcc67,_0x20d18f])=>_0x20d18f);}async['remixSubmit'](_0x17cd97,_0x59a28c,_0x2b4988,_0x48e733){const _0x14664e=_0xe8b49,_0x562c8e=this[_0x14664e(0x178)](0x5,{'id':_0x17cd97,'custom_id':_0x59a28c,'components':_0x2b4988});return Promise[_0x14664e(0x14d)]([this[_0x14664e(0x141)](_0x562c8e,_0x48e733),this['opts']['ws']?.['waitMessage']({'nonce':_0x562c8e['nonce'],'cb':_0x48e733})])['then'](([_0x9d6f4d,_0x3ab972])=>_0x3ab972);}async[_0xe8b49(0x13f)](_0x545b29,_0x37ba5d,_0x14983e,_0x228fa4){const _0x1381b6=_0xe8b49,_0x259890=(0x0,utils_1[_0x1381b6(0x176)])();return Promise[_0x1381b6(0x14d)]([this[_0x1381b6(0x155)](_0x545b29,_0x1381b6(0x148)+_0x259890+',\x20'+_0x37ba5d,_0x14983e,_0x228fa4),this['opts']['ws']?.[_0x1381b6(0x182)]({'nonce':_0x259890,'cb':_0x228fa4})])[_0x1381b6(0x165)](([_0x5890bc,_0x4f28ca])=>_0x4f28ca);}async['info'](_0x1555e3){const _0x34daa3=_0xe8b49;return this[_0x34daa3(0x143)](_0x34daa3(0x177))[_0x34daa3(0x165)](_0x4d768c=>{const _0x8fbbca=_0x34daa3,_0x293b7d=this[_0x8fbbca(0x178)](0x2,_0x4d768c);return Promise[_0x8fbbca(0x14d)]([this[_0x8fbbca(0x141)](_0x293b7d,_0x1555e3),this[_0x8fbbca(0x17e)]['ws']?.[_0x8fbbca(0x182)]({'nonce':_0x293b7d[_0x8fbbca(0x15b)],'cb':_0x1555e3})])[_0x8fbbca(0x165)](([_0x1e5492,_0x5eca3f])=>_0x5eca3f);});}async[_0xe8b49(0x145)](_0x298c65){const _0x508179=_0xe8b49;return this[_0x508179(0x143)](_0x508179(0x145))[_0x508179(0x165)](_0x93d134=>{const _0x98baf2=_0x508179,_0x304569=this[_0x98baf2(0x178)](0x2,_0x93d134);return Promise[_0x98baf2(0x14d)]([this[_0x98baf2(0x141)](_0x304569,_0x298c65),this[_0x98baf2(0x17e)]['ws']?.[_0x98baf2(0x182)]({'nonce':_0x304569['nonce'],'cb':_0x298c65})])[_0x98baf2(0x165)](([_0x4f649c,_0x833d2d])=>_0x833d2d);});}async[_0xe8b49(0x186)](_0xab8334){const _0x4134a4=_0xe8b49;return this['getCommand'](_0x4134a4(0x186))[_0x4134a4(0x165)](_0x4bb293=>{const _0x46bcac=_0x4134a4,_0x458a3c=this['getPayload'](0x2,_0x4bb293);return Promise[_0x46bcac(0x14d)]([this[_0x46bcac(0x141)](_0x458a3c,_0xab8334),this[_0x46bcac(0x17e)]['ws']?.['waitMessage']({'nonce':_0x458a3c[_0x46bcac(0x15b)],'cb':_0xab8334})])[_0x46bcac(0x165)](([_0x56391e,_0x4443dc])=>_0x4443dc);});}async[_0xe8b49(0x156)](_0x1f502b){const _0x50c5ae=_0xe8b49;return this[_0x50c5ae(0x143)]('relax')[_0x50c5ae(0x165)](_0x2e925f=>{const _0x38bf21=_0x50c5ae,_0x5b08e2=this[_0x38bf21(0x178)](0x2,_0x2e925f);return Promise['all']([this['interactions'](_0x5b08e2,_0x1f502b),this[_0x38bf21(0x17e)]['ws']?.[_0x38bf21(0x182)]({'nonce':_0x5b08e2[_0x38bf21(0x15b)],'cb':_0x1f502b})])[_0x38bf21(0x165)](([_0x3ebd0b,_0x1789cb])=>_0x1789cb);});}}exports[_0xe8b49(0x14a)]=MidjourneyApi;