'use strict';const _0x5801b0=_0x3884;(function(_0x36d7c2,_0x2404df){const _0x40c688=_0x3884,_0x2b471d=_0x36d7c2();while(!![]){try{const _0x1044f6=parseInt(_0x40c688(0x15b))/0x1*(-parseInt(_0x40c688(0x149))/0x2)+parseInt(_0x40c688(0x16d))/0x3+-parseInt(_0x40c688(0x152))/0x4+-parseInt(_0x40c688(0x16c))/0x5+parseInt(_0x40c688(0x130))/0x6+parseInt(_0x40c688(0x15e))/0x7+parseInt(_0x40c688(0x12f))/0x8;if(_0x1044f6===_0x2404df)break;else _0x2b471d['push'](_0x2b471d['shift']());}catch(_0x1a1cbb){_0x2b471d['push'](_0x2b471d['shift']());}}}(_0x187b,0x5707b));function _0x3884(_0x2314db,_0x4b1a8f){const _0x187b19=_0x187b();return _0x3884=function(_0x388479,_0x2a4abe){_0x388479=_0x388479-0x125;let _0x3b5217=_0x187b19[_0x388479];return _0x3b5217;},_0x3884(_0x2314db,_0x4b1a8f);}function _0x187b(){const _0x17046e=['/api/v9/interactions','getCommand','1543470RDnjdb','1653852CFGvHt','REQUEST_FAILED','type','opts','936929561302675456','assign','regionNonce:\x20','session_id','fast','attachments','upload_filename','options','5120632tRnpaH','976854QrcNzC','upload\x20image\x20fail,\x20because\x20of\x20upload\x20fail','nonce','__esModule','createRandomId','log','提交图片:\x20','application/json','status','interactions','guild_id','filter','setAttachment','settings','discordsaysUrl','fetch','catch','inpaint','MidjourneyApi','length','image/png','action','imagine','blend','all','1262190vRudFX','remixSubmit','info','uploadImage','nextNonce','/attachments','random','apiBaseUrl','then','2240320MInPeS','MidjourneyCommand','map','upload\x20image\x20fail,\x20no\x20attachment','stringify','data','put','channel_id','json','1FPWPrU','./utils','REQUEST_SUCCESS','3515204uxOcxm','/inpaint/api/submit-job','split','post','isomorphic-fetch','getPayload','upload_url','token','/api/v9/channels/','relax','waitMessage','defineProperty'];_0x187b=function(){return _0x17046e;};return _0x187b();}Object[_0x5801b0(0x169)](exports,_0x5801b0(0x133),{'value':!![]}),exports[_0x5801b0(0x142)]=void 0x0;const fetch=require(_0x5801b0(0x162)),command_1=require('./command'),utils_1=require(_0x5801b0(0x15c));class MidjourneyApi extends command_1[_0x5801b0(0x153)]{constructor(_0x1f585c){const _0x34df83=_0x5801b0;super(_0x1f585c),this[_0x34df83(0x126)]=_0x1f585c;}[_0x5801b0(0x139)](_0x13776a,_0x23adac){const _0x45d3a6=_0x5801b0,_0x414de8={'Content-Type':_0x45d3a6(0x137),'Authorization':this[_0x45d3a6(0x126)][_0x45d3a6(0x165)]};return fetch(this[_0x45d3a6(0x126)][_0x45d3a6(0x150)]+_0x45d3a6(0x16a),{'method':'POST','body':JSON['stringify'](_0x13776a),'headers':_0x414de8})[_0x45d3a6(0x151)](_0x5d6771=>_0x5d6771['ok']?_0x23adac?.(_0x45d3a6(0x15d),_0x5d6771):_0x23adac?.(_0x45d3a6(0x16e),_0x5d6771))[_0x45d3a6(0x140)](_0x53c1be=>_0x23adac?.(_0x45d3a6(0x16e),_0x53c1be));}[_0x5801b0(0x163)](_0x15665f,_0x463b8c,_0xe62168={},_0x1fe09d=(0x0,utils_1[_0x5801b0(0x14d)])()){const _0x7bfe81=_0x5801b0;if(!this[_0x7bfe81(0x126)]['session_id'])throw new Error('please\x20invoke\x20`init`\x20method\x20before\x20every\x20operate');return Object[_0x7bfe81(0x128)]({'type':_0x15665f,'application_id':_0x7bfe81(0x127),'guild_id':this[_0x7bfe81(0x126)][_0x7bfe81(0x13a)],'channel_id':this[_0x7bfe81(0x126)][_0x7bfe81(0x159)],'session_id':this[_0x7bfe81(0x126)][_0x7bfe81(0x12a)],'nonce':_0x1fe09d,'data':_0x463b8c},_0xe62168);}[_0x5801b0(0x141)](_0x3c34c3,_0x3627f6,_0x2dc951,_0x31eee5){const _0x473ae3=_0x5801b0,_0x20722e={'Content-Type':_0x473ae3(0x137)};return fetch(this[_0x473ae3(0x126)][_0x473ae3(0x13e)]+_0x473ae3(0x15f),{'method':'POST','body':JSON['stringify']({'customId':_0x3c34c3,'prompt':_0x3627f6,'mask':_0x2dc951['replace'](/^data:.+?;base64,/,''),'userId':'0','username':'0','full_prompt':null}),'headers':_0x20722e})['then'](_0xed852b=>_0xed852b['ok']?_0x31eee5?.(_0x473ae3(0x15d),_0xed852b):_0x31eee5?.(_0x473ae3(0x16e),_0xed852b))['catch'](_0x61378e=>_0x31eee5?.(_0x473ae3(0x16e),_0x61378e));}async['imagine'](_0x18584b,_0x204443){const _0x52d9f4=_0x5801b0;return this[_0x52d9f4(0x16b)](_0x52d9f4(0x146))['then'](_0x46edb4=>{const _0x435bc5=_0x52d9f4,_0xbc757a=this['getPayload'](0x2,Object['assign'](_0x46edb4,{'options':[{..._0x46edb4?.[_0x435bc5(0x12e)][0x0],'value':_0x18584b}]}));return Promise[_0x435bc5(0x148)]([this[_0x435bc5(0x139)](_0xbc757a,_0x204443),this[_0x435bc5(0x126)]['ws']?.[_0x435bc5(0x168)]({'nonce':_0xbc757a[_0x435bc5(0x132)],'cb':_0x204443})])[_0x435bc5(0x151)](([_0x10dadb,_0x389ba3])=>_0x389ba3);});}async[_0x5801b0(0x13c)](_0x1dfef2){const _0x54518d=_0x5801b0,_0x5d7cca=this[_0x54518d(0x126)]['apiBaseUrl']+_0x54518d(0x166)+this[_0x54518d(0x126)][_0x54518d(0x159)]+_0x54518d(0x14e),_0x529ca4={'Content-Type':_0x54518d(0x137),'Authorization':this['opts']['token']},{files:_0x4cc24a}=_0x1dfef2;try{return await this['opts'][_0x54518d(0x13f)](_0x5d7cca,{'headers':_0x529ca4,'body':JSON[_0x54518d(0x156)](_0x4cc24a),'method':_0x54518d(0x161)})[_0x54518d(0x151)](_0x524d08=>_0x524d08[_0x54518d(0x15a)]());}catch(_0x436144){console[_0x54518d(0x135)](_0x54518d(0x136),_0x436144);}}[_0x5801b0(0x134)](){const _0x37a0d9=_0x5801b0;return parseInt(Math[_0x37a0d9(0x14f)]()*0x3e8+'')+'';}async[_0x5801b0(0x14c)](_0x11de40){const _0x5d8884=_0x5801b0,{buffer:_0xa01a87,filename:_0x53870e}=_0x11de40,_0xf5710f=_0xa01a87[_0x5d8884(0x143)],_0x5da507=this[_0x5d8884(0x134)](),_0x1d78bb=await this[_0x5d8884(0x13c)]({'files':[{'filename':_0x53870e,'file_size':_0xf5710f,'id':_0x5da507,'is_clip':![]}]});if(_0x1d78bb[_0x5d8884(0x138)]!=0xc8)throw new Error('upload\x20image\x20fail,\x20no\x20attachment');const _0x9432ef=_0x1d78bb[_0x5d8884(0x157)];if(_0x9432ef['attachments']?.[_0x5d8884(0x143)]!=0x1)throw new Error(_0x5d8884(0x155));const _0x53f27a=await this['opts']['fetch'](_0x9432ef[_0x5d8884(0x12c)][0x0][_0x5d8884(0x164)],{'method':_0x5d8884(0x158),'body':_0xa01a87,'headers':{'Content-Type':_0x5d8884(0x144)}});if(_0x53f27a[_0x5d8884(0x138)]!=0xc8)throw new Error(_0x5d8884(0x131));const _0xec7ab3=_0x9432ef[_0x5d8884(0x12c)][0x0][_0x5d8884(0x12d)],_0x54846c=_0xec7ab3[_0x5d8884(0x160)]('/'),_0x58646d=_0x54846c[_0x5d8884(0x143)]>0x1?_0x54846c[0x1]:_0x54846c[0x0];return{'attachments':[{'id':_0x5da507,'filename':_0x58646d,'uploaded_filename':_0xec7ab3}]};}async['blend'](_0x2d1f67,_0x33a935){const _0x2f4195=_0x5801b0;return this['getCommand'](_0x2f4195(0x147))[_0x2f4195(0x151)](_0x1ac0ef=>{const _0x227e2e=_0x2f4195,_0x4f2429=_0x1ac0ef[_0x227e2e(0x12e)][_0x227e2e(0x13b)](_0x1d50ce=>_0x1d50ce[_0x227e2e(0x125)]===0xb),_0xd9d8e=_0x2d1f67[_0x227e2e(0x154)]((_0x925c4e,_0x46ad29)=>{return{..._0x4f2429[_0x46ad29],'value':_0x925c4e['id']};}),_0x6e4207=this[_0x227e2e(0x163)](0x2,Object[_0x227e2e(0x128)](_0x1ac0ef,{'options':_0xd9d8e,'attachments':_0x2d1f67}));return Promise[_0x227e2e(0x148)]([this['interactions'](_0x6e4207,_0x33a935),this['opts']['ws']?.[_0x227e2e(0x168)]({'nonce':_0x6e4207[_0x227e2e(0x132)],'cb':_0x33a935})])[_0x227e2e(0x151)](([_0x1dfeda,_0x2b74a5])=>_0x2b74a5);});}async['describe'](_0x2eba1f,_0xfaa491){return this['getCommand']('describe')['then'](_0x5cb768=>{const _0x1b1a6e=_0x3884,_0x2af6e2=this[_0x1b1a6e(0x163)](0x2,Object[_0x1b1a6e(0x128)](_0x5cb768,{'options':[{..._0x5cb768?.[_0x1b1a6e(0x12e)][0x0],'value':_0x2eba1f[0x0]['id']}],'attachments':_0x2eba1f}));return Promise[_0x1b1a6e(0x148)]([this[_0x1b1a6e(0x139)](_0x2af6e2,_0xfaa491),this['opts']['ws']?.['waitMessage']({'nonce':_0x2af6e2['nonce'],'cb':_0xfaa491})])[_0x1b1a6e(0x151)](([_0xb00fcb,_0x102d7f])=>_0x102d7f);});}async[_0x5801b0(0x145)](_0x30be81,_0x386833,_0x2c7fcc,_0xa33bf5){const _0x4d8418=_0x5801b0,_0x575b44=this['getPayload'](0x3,{'component_type':0x2,'custom_id':_0x386833},{'message_flags':_0x2c7fcc,'message_id':_0x30be81});return Promise[_0x4d8418(0x148)]([this[_0x4d8418(0x139)](_0x575b44,_0xa33bf5),this[_0x4d8418(0x126)]['ws']?.['waitMessage']({'nonce':_0x575b44[_0x4d8418(0x132)],'cb':_0xa33bf5,'parentId':_0x30be81})])[_0x4d8418(0x151)](([_0x64692e,_0xa26ce4])=>_0xa26ce4);}async[_0x5801b0(0x14a)](_0x3cb846,_0x1b7b8e,_0x29f6bd,_0x3622e1){const _0x44ee79=_0x5801b0,_0x19e361=this[_0x44ee79(0x163)](0x5,{'id':_0x3cb846,'custom_id':_0x1b7b8e,'components':_0x29f6bd});return Promise[_0x44ee79(0x148)]([this[_0x44ee79(0x139)](_0x19e361,_0x3622e1),this[_0x44ee79(0x126)]['ws']?.[_0x44ee79(0x168)]({'nonce':_0x19e361[_0x44ee79(0x132)],'cb':_0x3622e1})])[_0x44ee79(0x151)](([_0x1db13d,_0x25ac8e])=>_0x25ac8e);}async['varyRegion'](_0x910ad4,_0x5e825b,_0x3ca5f0,_0x507c75){const _0x55865c=_0x5801b0,_0x58ceca=(0x0,utils_1[_0x55865c(0x14d)])();return Promise['all']([this[_0x55865c(0x141)](_0x910ad4,_0x55865c(0x129)+_0x58ceca+',\x20'+_0x5e825b,_0x3ca5f0,_0x507c75),this['opts']['ws']?.['waitMessage']({'nonce':_0x58ceca,'cb':_0x507c75})])[_0x55865c(0x151)](([_0x4098fc,_0x3ec194])=>_0x3ec194);}async[_0x5801b0(0x14b)](_0x1c9582){const _0x1ed3bb=_0x5801b0;return this[_0x1ed3bb(0x16b)](_0x1ed3bb(0x14b))[_0x1ed3bb(0x151)](_0x21f2bb=>{const _0x4c06f0=_0x1ed3bb,_0x4fcb64=this[_0x4c06f0(0x163)](0x2,_0x21f2bb);return Promise[_0x4c06f0(0x148)]([this[_0x4c06f0(0x139)](_0x4fcb64,_0x1c9582),this[_0x4c06f0(0x126)]['ws']?.['waitMessage']({'nonce':_0x4fcb64['nonce'],'cb':_0x1c9582})])[_0x4c06f0(0x151)](([_0x39c303,_0x3f31e8])=>_0x3f31e8);});}async[_0x5801b0(0x13d)](_0xc0e48c){const _0x48141a=_0x5801b0;return this[_0x48141a(0x16b)](_0x48141a(0x13d))[_0x48141a(0x151)](_0x38f98e=>{const _0x472b34=_0x48141a,_0x378ed9=this[_0x472b34(0x163)](0x2,_0x38f98e);return Promise[_0x472b34(0x148)]([this[_0x472b34(0x139)](_0x378ed9,_0xc0e48c),this[_0x472b34(0x126)]['ws']?.[_0x472b34(0x168)]({'nonce':_0x378ed9[_0x472b34(0x132)],'cb':_0xc0e48c})])[_0x472b34(0x151)](([_0x335352,_0x4e1aec])=>_0x4e1aec);});}async['fast'](_0x203cc5){const _0x2af1c8=_0x5801b0;return this[_0x2af1c8(0x16b)](_0x2af1c8(0x12b))[_0x2af1c8(0x151)](_0x465ebe=>{const _0x18634a=_0x2af1c8,_0x57bb38=this[_0x18634a(0x163)](0x2,_0x465ebe);return Promise[_0x18634a(0x148)]([this[_0x18634a(0x139)](_0x57bb38,_0x203cc5),this[_0x18634a(0x126)]['ws']?.['waitMessage']({'nonce':_0x57bb38[_0x18634a(0x132)],'cb':_0x203cc5})])[_0x18634a(0x151)](([_0x3741e2,_0x3bb8e0])=>_0x3bb8e0);});}async[_0x5801b0(0x167)](_0x5aeeb8){const _0x25b7c1=_0x5801b0;return this[_0x25b7c1(0x16b)](_0x25b7c1(0x167))['then'](_0x45285d=>{const _0x27d921=_0x25b7c1,_0x176389=this[_0x27d921(0x163)](0x2,_0x45285d);return Promise[_0x27d921(0x148)]([this[_0x27d921(0x139)](_0x176389,_0x5aeeb8),this[_0x27d921(0x126)]['ws']?.['waitMessage']({'nonce':_0x176389[_0x27d921(0x132)],'cb':_0x5aeeb8})])[_0x27d921(0x151)](([_0x1fc349,_0x20aed9])=>_0x20aed9);});}}exports[_0x5801b0(0x142)]=MidjourneyApi;