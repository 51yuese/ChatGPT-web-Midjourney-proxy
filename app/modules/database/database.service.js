'use strict';const _0x35e48d=_0x1e13;(function(_0x39e780,_0x21963d){const _0x9b3eab=_0x1e13,_0x243c3b=_0x39e780();while(!![]){try{const _0x3a2f2b=-parseInt(_0x9b3eab(0x204))/0x1*(parseInt(_0x9b3eab(0x212))/0x2)+parseInt(_0x9b3eab(0x210))/0x3+-parseInt(_0x9b3eab(0x209))/0x4*(parseInt(_0x9b3eab(0x201))/0x5)+-parseInt(_0x9b3eab(0x1f0))/0x6+-parseInt(_0x9b3eab(0x21f))/0x7*(parseInt(_0x9b3eab(0x20e))/0x8)+parseInt(_0x9b3eab(0x20a))/0x9+parseInt(_0x9b3eab(0x205))/0xa*(parseInt(_0x9b3eab(0x22b))/0xb);if(_0x3a2f2b===_0x21963d)break;else _0x243c3b['push'](_0x243c3b['shift']());}catch(_0xc9a180){_0x243c3b['push'](_0x243c3b['shift']());}}}(_0x2744,0x269b8));function _0x1e13(_0x4df6f2,_0x3e07b6){const _0x27440b=_0x2744();return _0x1e13=function(_0x1e13b2,_0x7ab893){_0x1e13b2=_0x1e13b2-0x1e9;let _0x11f5be=_0x27440b[_0x1e13b2];return _0x11f5be;},_0x1e13(_0x4df6f2,_0x3e07b6);}var __decorate=this&&this[_0x35e48d(0x1f2)]||function(_0x5e4270,_0x5642a3,_0x9258ef,_0x8e6d6e){const _0x23081=_0x35e48d;var _0x41c9f8=arguments[_0x23081(0x21d)],_0x4ade7e=_0x41c9f8<0x3?_0x5642a3:_0x8e6d6e===null?_0x8e6d6e=Object['getOwnPropertyDescriptor'](_0x5642a3,_0x9258ef):_0x8e6d6e,_0x647869;if(typeof Reflect==='object'&&typeof Reflect[_0x23081(0x227)]===_0x23081(0x1ea))_0x4ade7e=Reflect[_0x23081(0x227)](_0x5e4270,_0x5642a3,_0x9258ef,_0x8e6d6e);else{for(var _0x665ad6=_0x5e4270[_0x23081(0x21d)]-0x1;_0x665ad6>=0x0;_0x665ad6--)if(_0x647869=_0x5e4270[_0x665ad6])_0x4ade7e=(_0x41c9f8<0x3?_0x647869(_0x4ade7e):_0x41c9f8>0x3?_0x647869(_0x5642a3,_0x9258ef,_0x4ade7e):_0x647869(_0x5642a3,_0x9258ef))||_0x4ade7e;}return _0x41c9f8>0x3&&_0x4ade7e&&Object[_0x23081(0x207)](_0x5642a3,_0x9258ef,_0x4ade7e),_0x4ade7e;},__metadata=this&&this['__metadata']||function(_0x4fc7ef,_0x1b4931){const _0x15f9e5=_0x35e48d;if(typeof Reflect===_0x15f9e5(0x22a)&&typeof Reflect['metadata']==='function')return Reflect[_0x15f9e5(0x1f4)](_0x4fc7ef,_0x1b4931);};function _0x2744(){const _0x4532ea=['INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','replace','default','typeorm','条配置，请前往管理系统系统配置设置','hashSync','bcryptjs','brushDdata','createDefaultUser','INSERT\x20IGNORE\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','defaultAdmin@cooper.com','query','85465BEUXyQ','admin123456','connection','19yKoBUe','10bRRNTG','Connection','defineProperty','本次新增','68wucZsc','1268847TMzBdP','\x27,\x20\x27','log','Injectable','152zJulpz','insertId','101247suPKrc','HttpStatus','7762ZGfqhp','configVal','affectedRows','HttpException','同步网站配置：','Logger','INTERNAL_SERVER_ERROR','super','./ConfigDict','error','design:paramtypes','length','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','10367LhgfrV','admin',']、初始密码为[','public','checkVersion','DatabaseService','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','用户成功、用户名为[','decorate','join','syncConfig','object','4300043RpXQlA','创建默认超级管理员失败:\x20','configKey','function','初始化创建','development','env','super123456','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','90300QAoLDB','ConfigDict','__decorate','@nestjs/common','metadata'];_0x2744=function(){return _0x4532ea;};return _0x2744();}Object[_0x35e48d(0x207)](exports,'__esModule',{'value':!![]}),exports[_0x35e48d(0x224)]=void 0x0;const common_1=require(_0x35e48d(0x1f3)),bcrypt=require(_0x35e48d(0x1fb)),typeorm_1=require(_0x35e48d(0x1f8)),UpdateSqls_1=require('./UpdateSqls'),ConfigDict_1=require(_0x35e48d(0x21a));let DatabaseService=class DatabaseService{constructor(_0x4183cb){const _0xa2a85b=_0x35e48d;this[_0xa2a85b(0x203)]=_0x4183cb;}async['onModuleInit'](){const _0x567873=_0x35e48d;process[_0x567873(0x1ed)]['ENV']!==_0x567873(0x1ec)&&await this[_0x567873(0x223)](),await this[_0x567873(0x1fc)](),await this['checkAdmin'](),await this[_0x567873(0x229)]();}async['checkVersion'](){}async['brushDdata'](){const _0x1310b4=_0x35e48d;for(let _0x50cde0=0x0;_0x50cde0<UpdateSqls_1[_0x1310b4(0x1f7)][_0x1310b4(0x21d)];_0x50cde0++){const _0x41af65=UpdateSqls_1[_0x1310b4(0x1f7)][_0x50cde0];await this[_0x1310b4(0x203)][_0x1310b4(0x200)](_0x41af65);}}async['checkAdmin'](){const _0x345e07=_0x35e48d,_0x52e662=await this[_0x345e07(0x203)][_0x345e07(0x200)](_0x345e07(0x1ef));if(!_0x52e662||_0x52e662['length']===0x0){const _0x584bfb=bcrypt[_0x345e07(0x1fa)](_0x345e07(0x1ee),0xa),_0x222eb8=bcrypt[_0x345e07(0x1fa)]('admin123456',0xa),_0x4a4897='defaultSuper@cooper.com',_0x165c03=_0x345e07(0x1ff),_0x3d1272={'username':_0x345e07(0x219),'password':_0x584bfb,'status':0x1,'email':_0x4a4897,'sex':0x1,'role':_0x345e07(0x219)},_0x2fedc0={'username':_0x345e07(0x220),'password':_0x222eb8,'status':0x1,'email':_0x165c03,'sex':0x1,'role':_0x345e07(0x220)};await this[_0x345e07(0x1fd)](_0x3d1272),await this[_0x345e07(0x1fd)](_0x2fedc0);}}async[_0x35e48d(0x1fd)](_0x6cb7be){const _0x67d541=_0x35e48d;try{const {username:_0x39ad3a,password:_0x2e7d75,status:_0x3cc668,email:_0x53e1c7,role:_0x5e1b4c}=_0x6cb7be,_0x4ff1fb=await this[_0x67d541(0x203)][_0x67d541(0x200)](_0x67d541(0x1f5)+_0x39ad3a+_0x67d541(0x20b)+_0x2e7d75+_0x67d541(0x20b)+_0x3cc668+_0x67d541(0x20b)+_0x53e1c7+_0x67d541(0x20b)+_0x5e1b4c+'\x27)'),_0x4918a1=_0x4ff1fb[_0x67d541(0x20f)],_0x539746=await this[_0x67d541(0x203)]['query'](_0x67d541(0x21e)+_0x4918a1+'\x27,\x200,\x201000,\x20100)');common_1[_0x67d541(0x217)][_0x67d541(0x20c)](_0x67d541(0x1eb)+_0x5e1b4c+_0x67d541(0x226)+_0x39ad3a+_0x67d541(0x221)+(_0x39ad3a===_0x67d541(0x219)?'super123456':_0x67d541(0x202))+']\x20==============>\x20请注意查阅','DatabaseService');}catch(_0x589a31){common_1[_0x67d541(0x217)][_0x67d541(0x21b)](_0x589a31,_0x67d541(0x22c));throw new common_1[(_0x67d541(0x215))]('创建默认超级管理员失败！',common_1['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async[_0x35e48d(0x229)](){const _0x256bc0=_0x35e48d;try{const _0x30e35a=await this['connection']['query'](_0x256bc0(0x1fe)+ConfigDict_1[_0x256bc0(0x1f1)]['map'](_0x11640f=>'(\x27'+_0x11640f[_0x256bc0(0x1e9)]+'\x27,\x20\x27'+_0x11640f[_0x256bc0(0x213)][_0x256bc0(0x1f6)](/'/g,'\x5c\x27')+_0x256bc0(0x20b)+_0x11640f[_0x256bc0(0x222)]+'\x27,\x20\x27'+_0x11640f['encry']+'\x27)')[_0x256bc0(0x228)](',\x20')+_0x256bc0(0x225));common_1['Logger']['log'](_0x256bc0(0x208)+_0x30e35a[_0x256bc0(0x214)]+_0x256bc0(0x1f9),_0x256bc0(0x216));}catch(_0x53d7c6){common_1[_0x256bc0(0x217)]['error'](_0x53d7c6,_0x256bc0(0x216));throw new common_1['HttpException']('同步网站配置失败！',common_1[_0x256bc0(0x211)][_0x256bc0(0x218)]);}}};DatabaseService=__decorate([(0x0,common_1[_0x35e48d(0x20d)])(),__metadata(_0x35e48d(0x21c),[typeorm_1[_0x35e48d(0x206)]])],DatabaseService),exports[_0x35e48d(0x224)]=DatabaseService;