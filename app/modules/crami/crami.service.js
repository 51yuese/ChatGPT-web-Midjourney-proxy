'use strict';const _0x3149d9=_0x1a86;function _0x2912(){const _0x9b65cd=['every','log','更新套餐成功！','error:\x20','__esModule','67353KXTzZI','addBalanceToUser','DESC','save','当前套餐不存在、请确认您选择的套餐是否存在！','find','RechargeType','889650SqTIia','UserBalanceService','当前套餐下存在卡密、请先删除卡密后才可删除套餐！','15AMThkg','__metadata','code','BAD_REQUEST','email','自定义卡密必须至少一项余额不为0️零！','cramiEntity','createCrami','UserEntity','当前卡密已被使用、请确认您输入的卡密是否正确！','length','maskCrami','CramiEntity','findAndCount','MoreThan','Repository','object','HttpStatus','packageId','catch','queryAllCrami','../userBalance/userBalance.service','../user/user.entity','InjectRepository','findOne','super','CramiService','removePackageType','1340145AbVjmH','147516ZnAHVD','HttpException','count','__param','then','map','role','create','function','Logger','updatePackageType','目前只能支持两类套餐！','name','套餐名称或套餐等级重复、请检查！','userBalanceService','CramiPackageEntity','queryAllPackage','typeorm','当前卡密不存在、请确认您输入的卡密是否正确！','maskEmail','userEntity','../../common/constants/balance.constant','cramiPackageTypeEntity','user','查询错误！','该类型绑定有套餐禁止删除！','@nestjs/typeorm','当前套餐不存在、请检查你的输入参数！','queryOnePackage','LessThanOrEqual','./crami.entity','assign','使用卡密成功','createPackageType','../../common/utils','delete','packageName','CramiPackageTypeEntity','saveRecordRechargeLog','generateCrami','batchDelCrami','error','delPackage','forEach','Not','3265402EmBfpO','Injectable','generateCramiCode','status','update','29439960Kahmtb','8Oqlran','useId','套餐类型名称已存在请检查！','cramiPackageEntity','defineProperty','affected','1815612mvOdyF','4rhhfSp','queryPackageType','createPackage','username','metadata'];_0x2912=function(){return _0x9b65cd;};return _0x2912();}(function(_0x7ae69e,_0x1ae5dd){const _0x4c1d4a=_0x1a86,_0x1ef3fc=_0x7ae69e();while(!![]){try{const _0x5aea7e=-parseInt(_0x4c1d4a(0x16c))/0x1+-parseInt(_0x4c1d4a(0x18c))/0x2+parseInt(_0x4c1d4a(0x165))/0x3*(-parseInt(_0x4c1d4a(0x15b))/0x4)+parseInt(_0x4c1d4a(0x16f))/0x5*(-parseInt(_0x4c1d4a(0x15a))/0x6)+-parseInt(_0x4c1d4a(0x14e))/0x7+-parseInt(_0x4c1d4a(0x154))/0x8*(-parseInt(_0x4c1d4a(0x18b))/0x9)+parseInt(_0x4c1d4a(0x153))/0xa;if(_0x5aea7e===_0x1ae5dd)break;else _0x1ef3fc['push'](_0x1ef3fc['shift']());}catch(_0x14a0a5){_0x1ef3fc['push'](_0x1ef3fc['shift']());}}}(_0x2912,0xb2e4e));var __decorate=this&&this['__decorate']||function(_0x52498d,_0x59c4be,_0x22b1b4,_0x58fbb2){const _0x4a4add=_0x1a86;var _0x5e843c=arguments[_0x4a4add(0x179)],_0x4e21e6=_0x5e843c<0x3?_0x59c4be:_0x58fbb2===null?_0x58fbb2=Object['getOwnPropertyDescriptor'](_0x59c4be,_0x22b1b4):_0x58fbb2,_0x2c117c;if(typeof Reflect===_0x4a4add(0x17f)&&typeof Reflect['decorate']===_0x4a4add(0x129))_0x4e21e6=Reflect['decorate'](_0x52498d,_0x59c4be,_0x22b1b4,_0x58fbb2);else{for(var _0x5c8764=_0x52498d[_0x4a4add(0x179)]-0x1;_0x5c8764>=0x0;_0x5c8764--)if(_0x2c117c=_0x52498d[_0x5c8764])_0x4e21e6=(_0x5e843c<0x3?_0x2c117c(_0x4e21e6):_0x5e843c>0x3?_0x2c117c(_0x59c4be,_0x22b1b4,_0x4e21e6):_0x2c117c(_0x59c4be,_0x22b1b4))||_0x4e21e6;}return _0x5e843c>0x3&&_0x4e21e6&&Object['defineProperty'](_0x59c4be,_0x22b1b4,_0x4e21e6),_0x4e21e6;},__metadata=this&&this[_0x3149d9(0x170)]||function(_0x5625a2,_0x35043b){const _0xac820f=_0x3149d9;if(typeof Reflect===_0xac820f(0x17f)&&typeof Reflect[_0xac820f(0x15f)]===_0xac820f(0x129))return Reflect[_0xac820f(0x15f)](_0x5625a2,_0x35043b);},__param=this&&this[_0x3149d9(0x124)]||function(_0x3d54dd,_0x5ab12c){return function(_0x30dcb3,_0x329c82){_0x5ab12c(_0x30dcb3,_0x329c82,_0x3d54dd);};};Object[_0x3149d9(0x158)](exports,_0x3149d9(0x164),{'value':!![]}),exports[_0x3149d9(0x189)]=void 0x0;const common_1=require('@nestjs/common'),crami_entity_1=require(_0x3149d9(0x13f)),typeorm_1=require(_0x3149d9(0x13b)),typeorm_2=require(_0x3149d9(0x132)),cramiPackage_entity_1=require('./cramiPackage.entity'),utils_1=require(_0x3149d9(0x143)),user_entity_1=require(_0x3149d9(0x185)),userBalance_service_1=require(_0x3149d9(0x184)),balance_constant_1=require(_0x3149d9(0x136)),cramiPackageType_entity_1=require('./cramiPackageType.entity');let CramiService=class CramiService{constructor(_0xa57509,_0x66dd1f,_0x80247e,_0x38832f,_0x48dd89){const _0x5ca52f=_0x3149d9;this[_0x5ca52f(0x175)]=_0xa57509,this['cramiPackageEntity']=_0x66dd1f,this[_0x5ca52f(0x137)]=_0x80247e,this[_0x5ca52f(0x135)]=_0x38832f,this['userBalanceService']=_0x48dd89;}async[_0x3149d9(0x13d)](_0x5197b2){const _0x4b7348=_0x3149d9;return await this[_0x4b7348(0x157)][_0x4b7348(0x187)]({'where':{'id':_0x5197b2}});}async[_0x3149d9(0x131)](_0x5a9d6f){const _0x49a876=_0x3149d9;try{const {page:page=0x1,size:size=0xa,name:_0x22242f,status:_0x2148b8,type:_0x44041e}=_0x5a9d6f,_0x394f8a={};return _0x22242f&&Object['assign'](_0x394f8a,{'name':(0x0,typeorm_2['Like'])('%'+_0x22242f+'%')}),_0x2148b8&&Object[_0x49a876(0x140)](_0x394f8a,{'status':_0x2148b8}),_0x44041e&&(_0x44041e>0x0?Object['assign'](_0x394f8a,{'days':(0x0,typeorm_2[_0x49a876(0x17d)])(0x0)}):Object[_0x49a876(0x140)](_0x394f8a,{'days':(0x0,typeorm_2[_0x49a876(0x13e)])(0x0)})),await this[_0x49a876(0x157)]['findAndCount']({'skip':(page-0x1)*size,'take':size,'where':_0x394f8a,'order':{'order':_0x49a876(0x167)}})[_0x49a876(0x125)](([_0x1eb59d,_0x1c157d])=>({'rows':_0x1eb59d||[],'count':_0x1c157d||0x0}))[_0x49a876(0x182)](_0x209a4f=>{const _0x321817=_0x49a876;common_1['Logger'][_0x321817(0x14a)](_0x209a4f);});}catch(_0x1e4086){console[_0x49a876(0x161)](_0x49a876(0x163),_0x1e4086);}}async[_0x3149d9(0x142)](_0x1c86c7){const _0x357bf4=_0x3149d9,{name:_0x345fe7}=_0x1c86c7,_0x44d44e=await this[_0x357bf4(0x137)]['count']();if(_0x44d44e>=0x2)throw new common_1[(_0x357bf4(0x18d))](_0x357bf4(0x12c),common_1[_0x357bf4(0x180)][_0x357bf4(0x172)]);const _0x493148=await this[_0x357bf4(0x137)][_0x357bf4(0x187)]({'where':{'name':_0x345fe7}})[_0x357bf4(0x182)](_0x4950ba=>{common_1['Logger']['error'](_0x4950ba);});if(_0x493148)throw new common_1[(_0x357bf4(0x18d))](_0x357bf4(0x156),common_1[_0x357bf4(0x180)][_0x357bf4(0x172)]);try{return await this['cramiPackageTypeEntity'][_0x357bf4(0x168)](_0x1c86c7)['catch'](_0x52d3ad=>{const _0x44fdde=_0x357bf4;common_1[_0x44fdde(0x12a)][_0x44fdde(0x14a)](_0x52d3ad);});}catch(_0x497e3c){console[_0x357bf4(0x161)](_0x357bf4(0x163),_0x497e3c);throw new common_1[(_0x357bf4(0x18d))](_0x497e3c,common_1['HttpStatus'][_0x357bf4(0x172)]);}}async[_0x3149d9(0x12b)](_0x2ebe57){const _0x1e5b22=_0x3149d9,{id:_0x165e4e}=_0x2ebe57,_0x117a32=await this[_0x1e5b22(0x137)][_0x1e5b22(0x187)]({'where':{'id':_0x165e4e}})['catch'](_0x58d5dc=>{const _0x4a959b=_0x1e5b22;common_1[_0x4a959b(0x12a)][_0x4a959b(0x14a)](_0x58d5dc);});if(!_0x117a32)throw new common_1[(_0x1e5b22(0x18d))]('套餐类型不存在！',common_1['HttpStatus'][_0x1e5b22(0x172)]);try{const {name:_0x1e3abd,desc:_0x13a28b,status:_0x5932ad,order:_0x299b79,title:_0x3ef7ee}=_0x2ebe57;return await this['cramiPackageTypeEntity'][_0x1e5b22(0x152)](_0x165e4e,{'name':_0x1e3abd,'desc':_0x13a28b,'status':_0x5932ad,'order':_0x299b79,'title':_0x3ef7ee})[_0x1e5b22(0x125)](_0xa95014=>_0xa95014[_0x1e5b22(0x159)])['catch'](_0x1d061e=>{const _0x51aa9f=_0x1e5b22;common_1[_0x51aa9f(0x12a)][_0x51aa9f(0x14a)](_0x1d061e);});}catch(_0x29fb0f){console['log'](_0x1e5b22(0x163),_0x29fb0f);throw new common_1['HttpException'](_0x29fb0f,common_1[_0x1e5b22(0x180)][_0x1e5b22(0x172)]);}}async[_0x3149d9(0x15c)](){const _0x19213a=_0x3149d9;return await this[_0x19213a(0x137)][_0x19213a(0x17c)]({'order':{'order':_0x19213a(0x167)}})[_0x19213a(0x125)](([_0x310452,_0x5423dc])=>({'rows':_0x310452,'count':_0x5423dc}))[_0x19213a(0x182)](_0x1511b8=>{const _0x53e44f=_0x19213a;common_1['Logger'][_0x53e44f(0x14a)](_0x1511b8);});}async[_0x3149d9(0x18a)](_0x32f963){const _0x228fb8=_0x3149d9,_0x2d9d3b=await this[_0x228fb8(0x157)][_0x228fb8(0x123)]({'where':{'typeId':_0x32f963}})[_0x228fb8(0x182)](_0x3d336b=>{const _0x56f506=_0x228fb8;common_1['Logger'][_0x56f506(0x14a)](_0x3d336b);});if(_0x2d9d3b>0x0)throw new common_1['HttpException'](_0x228fb8(0x13a),common_1[_0x228fb8(0x180)][_0x228fb8(0x172)]);return await this[_0x228fb8(0x137)]['delete'](_0x32f963)[_0x228fb8(0x125)](_0x5826d0=>_0x5826d0[_0x228fb8(0x159)]>0x0)[_0x228fb8(0x182)](_0x1c73f1=>{const _0x5339e7=_0x228fb8;common_1[_0x5339e7(0x12a)][_0x5339e7(0x14a)](_0x1c73f1);});}async[_0x3149d9(0x15d)](_0x25b0d5){const _0x1ae710=_0x3149d9,{name:_0xb1c598,weight:_0x190459,typeId:_0xa4b178}=_0x25b0d5,_0x2dd8e9=await this[_0x1ae710(0x157)][_0x1ae710(0x187)]({'where':[{'name':_0xb1c598},{'weight':_0x190459}]})[_0x1ae710(0x182)](_0x7f36a5=>{const _0x5f2614=_0x1ae710;common_1[_0x5f2614(0x12a)][_0x5f2614(0x14a)](_0x7f36a5);});if(_0x2dd8e9)throw new common_1[(_0x1ae710(0x18d))](_0x1ae710(0x12e),common_1[_0x1ae710(0x180)]['BAD_REQUEST']);const _0x2422d7=await this[_0x1ae710(0x137)][_0x1ae710(0x187)]({'where':{'id':_0xa4b178}})['then'](_0x40d0cf=>_0x40d0cf[_0x1ae710(0x12d)])[_0x1ae710(0x182)](_0x35a760=>{const _0x2107c=_0x1ae710;common_1[_0x2107c(0x12a)][_0x2107c(0x14a)](_0x35a760);});if(!_0x2422d7)throw new common_1[(_0x1ae710(0x18d))]('套餐类型错误！',common_1[_0x1ae710(0x180)]['BAD_REQUEST']);try{return await this[_0x1ae710(0x157)][_0x1ae710(0x168)]({..._0x25b0d5,'typeName':_0x2422d7})[_0x1ae710(0x182)](_0x666f9b=>{const _0x5484ff=_0x1ae710;common_1[_0x5484ff(0x12a)][_0x5484ff(0x14a)](_0x666f9b);});}catch(_0x43e7ff){console[_0x1ae710(0x161)](_0x1ae710(0x163),_0x43e7ff);throw new common_1[(_0x1ae710(0x18d))](_0x43e7ff,common_1['HttpStatus'][_0x1ae710(0x172)]);}}async['updatePackage'](_0x18ff5d){const _0x4a883c=_0x3149d9,{id:_0x58afa0,name:_0x4925f3,typeId:_0x525f5e,weight:_0x2e4e97}=_0x18ff5d,_0x1d3979=await this[_0x4a883c(0x157)][_0x4a883c(0x187)]({'where':{'id':_0x58afa0}});if(!_0x1d3979)throw new common_1['HttpException'](_0x4a883c(0x13c),common_1['HttpStatus'][_0x4a883c(0x172)]);const _0x172dcc=await this[_0x4a883c(0x157)]['count']({'where':[{'name':_0x4925f3,'id':(0x0,typeorm_2[_0x4a883c(0x14d)])(_0x58afa0)},{'weight':_0x2e4e97,'id':(0x0,typeorm_2[_0x4a883c(0x14d)])(_0x58afa0)}]})[_0x4a883c(0x182)](_0x5a7047=>{const _0x190793=_0x4a883c;common_1['Logger'][_0x190793(0x14a)](_0x5a7047);});if(_0x172dcc)throw new common_1[(_0x4a883c(0x18d))](_0x4a883c(0x12e),common_1['HttpStatus'][_0x4a883c(0x172)]);let _0x5cd2f5='';_0x525f5e&&(_0x5cd2f5=await this[_0x4a883c(0x137)][_0x4a883c(0x187)]({'where':{'id':_0x525f5e}})[_0x4a883c(0x125)](_0x1408ff=>_0x1408ff['name']||'')[_0x4a883c(0x182)](_0x2513f6=>{const _0x1c3503=_0x4a883c;common_1[_0x1c3503(0x12a)][_0x1c3503(0x14a)](_0x2513f6);}));const _0x41dbe7=await this['cramiPackageEntity']['update']({'id':_0x58afa0},{..._0x18ff5d,'typeName':_0x5cd2f5||''})[_0x4a883c(0x182)](_0x8256a5=>{const _0x439725=_0x4a883c;common_1['Logger'][_0x439725(0x14a)](_0x8256a5);});if(_0x41dbe7&&_0x41dbe7[_0x4a883c(0x159)]>0x0)return _0x4a883c(0x162);else throw new common_1['HttpException']('更新套餐失败、请重试！',common_1[_0x4a883c(0x180)][_0x4a883c(0x172)]);}async[_0x3149d9(0x14b)](_0x1e6770){const _0x38a728=_0x3149d9,{id:_0xf4dbdd}=_0x1e6770,_0x5a4eb6=await this[_0x38a728(0x175)]['count']({'where':{'packageId':_0xf4dbdd}})[_0x38a728(0x182)](_0x191dab=>{const _0x2a240e=_0x38a728;common_1[_0x2a240e(0x12a)][_0x2a240e(0x14a)](_0x191dab);});if(_0x5a4eb6)throw new common_1[(_0x38a728(0x18d))](_0x38a728(0x16e),common_1[_0x38a728(0x180)][_0x38a728(0x172)]);return await this[_0x38a728(0x157)]['delete']({'id':_0xf4dbdd})[_0x38a728(0x182)](_0x18921c=>{const _0x45319b=_0x38a728;common_1[_0x45319b(0x12a)][_0x45319b(0x14a)](_0x18921c);});}async[_0x3149d9(0x176)](_0x451976){const _0x42027e=_0x3149d9,{packageId:_0x49d11e,count:count=0x1}=_0x451976;if(_0x49d11e){const _0x2602a2=await this['cramiPackageEntity'][_0x42027e(0x187)]({'where':{'id':_0x49d11e}})[_0x42027e(0x182)](_0x995fa8=>{const _0x1b686d=_0x42027e;common_1[_0x1b686d(0x12a)][_0x1b686d(0x14a)](_0x995fa8);});if(!_0x2602a2)throw new common_1['HttpException'](_0x42027e(0x169),common_1[_0x42027e(0x180)][_0x42027e(0x172)]);const {days:days=-0x1,model3Count:model3Count=0x0,model4Count:model4Count=0x0,drawMjCount:drawMjCount=0x0}=_0x2602a2,_0x3b7b27={'packageId':_0x49d11e,'days':days,'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount};return await this[_0x42027e(0x148)](_0x3b7b27,count)[_0x42027e(0x182)](_0x406c64=>{const _0x45fa42=_0x42027e;common_1[_0x45fa42(0x12a)][_0x45fa42(0x14a)](_0x406c64);});}if(!_0x49d11e){const {model3Count:model3Count=0x0,model4Count:model4Count=0x0,drawMjCount:drawMjCount=0x0}=_0x451976;if([model3Count,model4Count,drawMjCount][_0x42027e(0x160)](_0x54cadb=>!_0x54cadb))throw new common_1['HttpException'](_0x42027e(0x174),common_1[_0x42027e(0x180)][_0x42027e(0x172)]);const _0x5e4b36={'days':-0x1,'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount};return await this[_0x42027e(0x148)](_0x5e4b36,count)[_0x42027e(0x182)](_0x35ce64=>{const _0x1a94c9=_0x42027e;common_1[_0x1a94c9(0x12a)]['error'](_0x35ce64);});}}async[_0x3149d9(0x148)](_0x26d8e1,_0x1009d0){const _0x1ffe36=_0x3149d9,_0xd0049=[];for(let _0x5a84e7=0x0;_0x5a84e7<_0x1009d0;_0x5a84e7++){const _0x3688e5=(0x0,utils_1[_0x1ffe36(0x150)])(),_0xe8cc98=this[_0x1ffe36(0x175)][_0x1ffe36(0x128)]({..._0x26d8e1,'code':_0x3688e5});_0xd0049['push'](_0xe8cc98);}return await this['cramiEntity'][_0x1ffe36(0x168)](_0xd0049)[_0x1ffe36(0x182)](_0x1e1bbb=>{const _0x544d6d=_0x1ffe36;common_1[_0x544d6d(0x12a)]['error'](_0x1e1bbb);});}async['useCrami'](_0xc00de3,_0x1efef1){const _0x1c13c8=_0x3149d9,{id:_0x419b77}=_0xc00de3['user'],_0xb26152=await this[_0x1c13c8(0x175)][_0x1c13c8(0x187)]({'where':{'code':_0x1efef1[_0x1c13c8(0x171)]}});if(!_0xb26152)throw new common_1[(_0x1c13c8(0x18d))](_0x1c13c8(0x133),common_1[_0x1c13c8(0x180)][_0x1c13c8(0x172)]);const {status:_0x4a5be7,days:days=-0x1,model3Count:model3Count=0x0,model4Count:model4Count=0x0,drawMjCount:drawMjCount=0x0,packageId:_0x48ef12}=_0xb26152;if(_0x4a5be7===0x1)throw new common_1[(_0x1c13c8(0x18d))](_0x1c13c8(0x178),common_1[_0x1c13c8(0x180)][_0x1c13c8(0x172)]);const _0x57580d={'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount,'packageId':_0x48ef12};return await this[_0x1c13c8(0x12f)][_0x1c13c8(0x166)](_0x419b77,{..._0x57580d},days)['catch'](_0x43cf3c=>{const _0x4dfe4e=_0x1c13c8;common_1[_0x4dfe4e(0x12a)][_0x4dfe4e(0x14a)](_0x43cf3c);}),await this[_0x1c13c8(0x12f)][_0x1c13c8(0x147)]({'userId':_0x419b77,'rechargeType':balance_constant_1[_0x1c13c8(0x16b)]['PACKAGE_GIFT'],'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount,'days':days})['catch'](_0x3e4e7d=>{const _0x583667=_0x1c13c8;common_1['Logger'][_0x583667(0x14a)](_0x3e4e7d);}),await this['cramiEntity'][_0x1c13c8(0x152)]({'code':_0x1efef1['code']},{'useId':_0x419b77,'status':0x1})[_0x1c13c8(0x182)](_0x676cba=>{const _0x110297=_0x1c13c8;common_1[_0x110297(0x12a)][_0x110297(0x14a)](_0x676cba);}),_0x1c13c8(0x141);}async[_0x3149d9(0x183)](_0x59bf3a,_0x16a002){const _0x3c2c74=_0x3149d9,{page:page=0x1,size:size=0xa,status:_0x3ad140,useId:_0x3e9b5a}=_0x59bf3a,_0x2b1f12={};_0x3ad140&&Object[_0x3c2c74(0x140)](_0x2b1f12,{'status':_0x3ad140}),_0x3e9b5a&&Object['assign'](_0x2b1f12,{'useId':_0x3e9b5a});const _0x5b1c12=await this[_0x3c2c74(0x175)][_0x3c2c74(0x17c)]({'skip':(page-0x1)*size,'take':size,'order':{'createdAt':_0x3c2c74(0x167)},'where':_0x2b1f12})[_0x3c2c74(0x125)](([_0x5cb286,_0x5efa56])=>({'rows':_0x5cb286,'count':_0x5efa56}))['catch'](_0x56af15=>{const _0x5c1dfc=_0x3c2c74;common_1['Logger'][_0x5c1dfc(0x14a)](_0x56af15);});if(!_0x5b1c12)throw new common_1[(_0x3c2c74(0x18d))](_0x3c2c74(0x139),common_1[_0x3c2c74(0x180)]['BAD_REQUEST']);const {rows:_0x486c2e,count:_0x547455}=_0x5b1c12,_0x35b106=_0x486c2e[_0x3c2c74(0x126)](_0x473d06=>_0x473d06[_0x3c2c74(0x155)]),_0x14087b=_0x486c2e['map'](_0x1ac26e=>_0x1ac26e[_0x3c2c74(0x181)]),_0xaf5c82=await this[_0x3c2c74(0x135)][_0x3c2c74(0x16a)]({'where':{'id':(0x0,typeorm_2['In'])(_0x35b106)}}),_0x592e20=await this['cramiPackageEntity']['find']({'where':{'id':(0x0,typeorm_2['In'])(_0x14087b)}});return _0x486c2e[_0x3c2c74(0x14c)](_0x4390e9=>{const _0x5e1198=_0x3c2c74;_0x4390e9[_0x5e1198(0x15e)]=_0xaf5c82['find'](_0x5ef7a1=>_0x5ef7a1['id']===_0x4390e9['useId'])?.[_0x5e1198(0x15e)],_0x4390e9[_0x5e1198(0x173)]=_0xaf5c82[_0x5e1198(0x16a)](_0x14546b=>_0x14546b['id']===_0x4390e9['useId'])?.[_0x5e1198(0x173)],_0x4390e9[_0x5e1198(0x145)]=_0x592e20[_0x5e1198(0x16a)](_0x49354e=>_0x49354e['id']===_0x4390e9['packageId'])?.['name'];}),_0x16a002[_0x3c2c74(0x138)][_0x3c2c74(0x127)]!==_0x3c2c74(0x188)&&_0x486c2e['forEach'](_0x24d392=>_0x24d392[_0x3c2c74(0x173)]=(0x0,utils_1[_0x3c2c74(0x134)])(_0x24d392[_0x3c2c74(0x173)])),_0x16a002[_0x3c2c74(0x138)][_0x3c2c74(0x127)]!==_0x3c2c74(0x188)&&_0x486c2e['forEach'](_0x27f804=>_0x27f804[_0x3c2c74(0x171)]=(0x0,utils_1[_0x3c2c74(0x17a)])(_0x27f804['code'])),{'rows':_0x486c2e,'count':_0x547455};}async['delCrami'](_0x2c11e3){const _0x2870a3=_0x3149d9,_0x3f20d3=await this[_0x2870a3(0x175)][_0x2870a3(0x187)]({'where':{'id':_0x2c11e3}})['catch'](_0x3b43cc=>{const _0x21fb7f=_0x2870a3;common_1[_0x21fb7f(0x12a)][_0x21fb7f(0x14a)](_0x3b43cc);});if(!_0x3f20d3)throw new common_1[(_0x2870a3(0x18d))]('当前卡密不存在、请确认您要删除的卡密是否存在！',common_1[_0x2870a3(0x180)]['BAD_REQUEST']);if(_0x3f20d3[_0x2870a3(0x151)]===0x1)throw new common_1[(_0x2870a3(0x18d))]('当前卡密已被使用、已使用的卡密禁止删除！',common_1[_0x2870a3(0x180)][_0x2870a3(0x172)]);return await this['cramiEntity'][_0x2870a3(0x144)]({'id':_0x2c11e3})[_0x2870a3(0x182)](_0x2065e2=>{const _0x2c977b=_0x2870a3;common_1[_0x2c977b(0x12a)][_0x2c977b(0x14a)](_0x2065e2);});}async[_0x3149d9(0x149)](_0x3531f6){const _0x2559e3=_0x3149d9,{ids:_0x16c9ff}=_0x3531f6,_0x4db842=await this[_0x2559e3(0x175)]['delete'](_0x16c9ff)[_0x2559e3(0x182)](_0x3a6268=>{const _0x2fafca=_0x2559e3;common_1[_0x2fafca(0x12a)][_0x2fafca(0x14a)](_0x3a6268);});if(_0x4db842&&_0x4db842['affected']>0x0)return'删除卡密成功！';else throw new common_1[(_0x2559e3(0x18d))]('删除卡密失败、请重试！',common_1[_0x2559e3(0x180)][_0x2559e3(0x172)]);}};function _0x1a86(_0xb2c7d1,_0x5ecc01){const _0x2912ce=_0x2912();return _0x1a86=function(_0x1a8609,_0x4b3945){_0x1a8609=_0x1a8609-0x123;let _0x5524fc=_0x2912ce[_0x1a8609];return _0x5524fc;},_0x1a86(_0xb2c7d1,_0x5ecc01);}CramiService=__decorate([(0x0,common_1[_0x3149d9(0x14f)])(),__param(0x0,(0x0,typeorm_1[_0x3149d9(0x186)])(crami_entity_1[_0x3149d9(0x17b)])),__param(0x1,(0x0,typeorm_1[_0x3149d9(0x186)])(cramiPackage_entity_1[_0x3149d9(0x130)])),__param(0x2,(0x0,typeorm_1[_0x3149d9(0x186)])(cramiPackageType_entity_1[_0x3149d9(0x146)])),__param(0x3,(0x0,typeorm_1[_0x3149d9(0x186)])(user_entity_1[_0x3149d9(0x177)])),__metadata('design:paramtypes',[typeorm_2[_0x3149d9(0x17e)],typeorm_2[_0x3149d9(0x17e)],typeorm_2[_0x3149d9(0x17e)],typeorm_2[_0x3149d9(0x17e)],userBalance_service_1[_0x3149d9(0x16d)]])],CramiService),exports[_0x3149d9(0x189)]=CramiService;