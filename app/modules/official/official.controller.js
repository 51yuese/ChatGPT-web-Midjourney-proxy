'use strict';const _0x2b7853=_0xe71d;function _0x4bf0(){const _0x5587be=['notify','getQRCodeTicket','UseGuards','log','39iMHTjL','getAccessToken','officialService','design:returntype','Req','465540EMtkpm','getRedirectUrl','__metadata','getOwnPropertyDescriptor','获取二维码','扫码登录轮询查询','split','1049657bPdtow','type','verify','officialBindAccountText','getQRSceneStrByBind','__decorate','sceneStr:\x20','content','getQRSceneStr','客户端发送了文字消息','OfficialController','env','ApiOperation','offical\x20getQRCode','qrscene_','echostr','Get','1556myQSZd','official','scanBindWx','defineProperty','53855LWjYeB','1347498lzHhQc','send','msgtype','default','扫码绑定轮询查询','SCAN','code','获取登录跳转地址','CLICK','decorate','../../common/auth/jwtAuth.guard','scan','fromusername','https://ceshi.qumao518.vip/api/official/notify','aotoPlay','7660doQhJx','getJsapiTicket','./dto/getQrCode.dto','GetQrSceneStrDto','officialSubscribeText','GetQrCodeDto','@nestjs/swagger','24vuiZBT','design:paramtypes','genXmlMsgByConfig','sceneStr','公众号静默登录','ApiTags','__param','eventkey','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','loginByCode','metadata','GOMAXAI_HOST','genXmlMsg','length','98HUbIGT','timestamp','__esModule','Query','url','OfficialService','@nestjs/common','225904zfMTOw','notifyPost','ApiResponse','./official.service','design:type','./dto/getQrSceneStr.dto','Body','获取注册配置','JwtAuthGuard','event','status','includes','OfficialLoginVO','object','公众号通知接口POST','success','bindWxBySceneStr','getQRCode','loginBySceneStr','function','获取绑定二维码的sceneStr','unsubscribe','公众号通知接口GET','officialScanLoginText','text','Post','Res','POST','prototype','nonce','xml:\x20'];_0x4bf0=function(){return _0x5587be;};return _0x4bf0();}(function(_0xbefcb6,_0x3e04b4){const _0x2a892e=_0xe71d,_0x1f1e73=_0xbefcb6();while(!![]){try{const _0x1db4dd=parseInt(_0x2a892e(0x177))/0x1*(parseInt(_0x2a892e(0x1a0))/0x2)+parseInt(_0x2a892e(0x1ca))/0x3*(parseInt(_0x2a892e(0x18b))/0x4)+-parseInt(_0x2a892e(0x17b))/0x5*(parseInt(_0x2a892e(0x192))/0x6)+parseInt(_0x2a892e(0x166))/0x7+parseInt(_0x2a892e(0x1a7))/0x8+-parseInt(_0x2a892e(0x17c))/0x9+parseInt(_0x2a892e(0x1cf))/0xa;if(_0x1db4dd===_0x3e04b4)break;else _0x1f1e73['push'](_0x1f1e73['shift']());}catch(_0x519d12){_0x1f1e73['push'](_0x1f1e73['shift']());}}}(_0x4bf0,0x207d4));function _0xe71d(_0x41ceab,_0x548916){const _0x4bf003=_0x4bf0();return _0xe71d=function(_0xe71d5e,_0x26e961){_0xe71d5e=_0xe71d5e-0x161;let _0x5ca0d8=_0x4bf003[_0xe71d5e];return _0x5ca0d8;},_0xe71d(_0x41ceab,_0x548916);}var __decorate=this&&this[_0x2b7853(0x16b)]||function(_0x19116b,_0x4fb2b6,_0x5c787a,_0x585016){const _0xc6dd99=_0x2b7853;var _0x58a342=arguments[_0xc6dd99(0x19f)],_0x3abd63=_0x58a342<0x3?_0x4fb2b6:_0x585016===null?_0x585016=Object[_0xc6dd99(0x162)](_0x4fb2b6,_0x5c787a):_0x585016,_0x4b14d0;if(typeof Reflect===_0xc6dd99(0x1b4)&&typeof Reflect[_0xc6dd99(0x185)]===_0xc6dd99(0x1ba))_0x3abd63=Reflect[_0xc6dd99(0x185)](_0x19116b,_0x4fb2b6,_0x5c787a,_0x585016);else{for(var _0x3f7fe2=_0x19116b[_0xc6dd99(0x19f)]-0x1;_0x3f7fe2>=0x0;_0x3f7fe2--)if(_0x4b14d0=_0x19116b[_0x3f7fe2])_0x3abd63=(_0x58a342<0x3?_0x4b14d0(_0x3abd63):_0x58a342>0x3?_0x4b14d0(_0x4fb2b6,_0x5c787a,_0x3abd63):_0x4b14d0(_0x4fb2b6,_0x5c787a))||_0x3abd63;}return _0x58a342>0x3&&_0x3abd63&&Object[_0xc6dd99(0x17a)](_0x4fb2b6,_0x5c787a,_0x3abd63),_0x3abd63;},__metadata=this&&this[_0x2b7853(0x161)]||function(_0x1c5c2a,_0x5c0471){const _0x535f99=_0x2b7853;if(typeof Reflect===_0x535f99(0x1b4)&&typeof Reflect[_0x535f99(0x19c)]===_0x535f99(0x1ba))return Reflect[_0x535f99(0x19c)](_0x1c5c2a,_0x5c0471);},__param=this&&this[_0x2b7853(0x198)]||function(_0x24ecf2,_0x55df55){return function(_0x5bdcbd,_0x959eeb){_0x55df55(_0x5bdcbd,_0x959eeb,_0x24ecf2);};};Object[_0x2b7853(0x17a)](exports,_0x2b7853(0x1a2),{'value':!![]}),exports[_0x2b7853(0x170)]=void 0x0;const common_1=require(_0x2b7853(0x1a6)),swagger_1=require(_0x2b7853(0x191)),jwtAuth_guard_1=require(_0x2b7853(0x186)),official_service_1=require(_0x2b7853(0x1aa)),axios_1=require('axios'),getQrCode_dto_1=require(_0x2b7853(0x18d)),getQrSceneStr_dto_1=require(_0x2b7853(0x1ac)),Login_vo_1=require('./vo/Login.vo');let OfficialController=class OfficialController{constructor(_0x1e48c2){const _0x435ff4=_0x2b7853;this[_0x435ff4(0x1cc)]=_0x1e48c2;}async[_0x2b7853(0x1c6)](_0x5a6cc2,_0x46ea85,_0x58ecaf){const _0x22c35f=_0x2b7853;console[_0x22c35f(0x1c9)]('get\x20通知>>>',_0x46ea85,_0x58ecaf);const _0x245737=await this[_0x22c35f(0x1cc)][_0x22c35f(0x168)](_0x46ea85['signature'],_0x46ea85[_0x22c35f(0x1c4)],_0x46ea85[_0x22c35f(0x1a1)]);return _0x245737?_0x46ea85[_0x22c35f(0x175)]:'';}async[_0x2b7853(0x1a8)](_0x43609e,_0xae1632,_0x5a083c,_0x53a948){const _0x2067fc=_0x2b7853,{xml:_0x1f009b}=_0x5a083c;console['log'](_0x2067fc(0x1c5),_0x1f009b);const _0x5abe82=process[_0x2067fc(0x171)][_0x2067fc(0x19d)];_0x5abe82==='gomaxai.qumao518.vip'&&((0x0,axios_1[_0x2067fc(0x17f)])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0x5a083c,'method':_0x2067fc(0x1c2),'headers':{'Content-Type':'application/json'}}),(0x0,axios_1[_0x2067fc(0x17f)])({'url':_0x2067fc(0x189),'data':_0x5a083c,'method':'POST','headers':{'Content-Type':'application/json'}}));if(_0x1f009b[_0x2067fc(0x17e)][0x0]==_0x2067fc(0x1b0)){if(_0x1f009b[_0x2067fc(0x1b0)][0x0]=='VIEW'||_0x1f009b[_0x2067fc(0x1b0)][0x0]==_0x2067fc(0x184))return _0x53a948['status'](0xc8)[_0x2067fc(0x17d)]('');if(_0x1f009b['event'][0x0]==_0x2067fc(0x181)){console[_0x2067fc(0x1c9)]('扫码');const _0xc541cc=_0x1f009b[_0x2067fc(0x199)][0x0];if(_0xc541cc['includes']('/')){this[_0x2067fc(0x1cc)][_0x2067fc(0x179)](_0x1f009b[_0x2067fc(0x188)][0x0],_0xc541cc);const _0x5970da=await this['officialService'][_0x2067fc(0x194)](_0x1f009b,'officialBindAccountText');return _0x53a948[_0x2067fc(0x1b1)](0xc8)['send'](_0x5970da);}this[_0x2067fc(0x1cc)][_0x2067fc(0x187)](_0x1f009b['fromusername'][0x0],_0xc541cc);const _0x2b8c2f=await this[_0x2067fc(0x1cc)]['genXmlMsgByConfig'](_0x1f009b,_0x2067fc(0x1be));return _0x53a948['status'](0xc8)[_0x2067fc(0x17d)](_0x2b8c2f);}if(_0x1f009b[_0x2067fc(0x1b0)][0x0]=='subscribe'){console[_0x2067fc(0x1c9)]('订阅',_0x1f009b[_0x2067fc(0x199)][0x0]);const _0xc33225=_0x1f009b[_0x2067fc(0x199)][0x0][_0x2067fc(0x165)](_0x2067fc(0x174))[0x1];console[_0x2067fc(0x1c9)](_0x2067fc(0x16c),_0xc33225);if(!_0xc33225){const _0x24a394=await this[_0x2067fc(0x1cc)]['genXmlMsgByConfig'](_0x1f009b,_0x2067fc(0x18f));return _0x53a948[_0x2067fc(0x1b1)](0xc8)[_0x2067fc(0x17d)](_0x24a394);}if(_0xc33225[_0x2067fc(0x1b2)]('/')){this['officialService'][_0x2067fc(0x179)](_0x1f009b['fromusername'][0x0],_0xc33225);const _0x27bfe9=await this[_0x2067fc(0x1cc)]['genXmlMsgByConfig'](_0x1f009b,_0x2067fc(0x169));return _0x53a948[_0x2067fc(0x1b1)](0xc8)[_0x2067fc(0x17d)](_0x27bfe9);}this['officialService'][_0x2067fc(0x187)](_0x1f009b[_0x2067fc(0x188)][0x0],_0xc33225);const _0x2d76fb=await this[_0x2067fc(0x1cc)][_0x2067fc(0x194)](_0x1f009b,_0x2067fc(0x18f));return _0x53a948['status'](0xc8)[_0x2067fc(0x17d)](_0x2d76fb);}if(_0x1f009b[_0x2067fc(0x1b0)][0x0]==_0x2067fc(0x1bc))return _0x53a948[_0x2067fc(0x1b1)](0xc8)[_0x2067fc(0x17d)]('');}if(_0x1f009b[_0x2067fc(0x17e)][0x0]==_0x2067fc(0x1bf)){console['log'](_0x2067fc(0x16f));const _0x5a74ff=await this[_0x2067fc(0x1cc)][_0x2067fc(0x18a)](_0x1f009b[_0x2067fc(0x16d)][0x0]),_0x53f940=await this[_0x2067fc(0x1cc)][_0x2067fc(0x19e)](_0x1f009b,_0x5a74ff);return _0x53a948['status'](0xc8)[_0x2067fc(0x17d)](_0x53f940);}return _0x2067fc(0x1b6);}async[_0x2b7853(0x16e)](_0x52c4e4){const _0x5a5031=_0x2b7853;return this[_0x5a5031(0x1cc)][_0x5a5031(0x16e)](_0x52c4e4);}async[_0x2b7853(0x16a)](_0x4abada){return this['officialService']['getQRSceneStrByBind'](_0x4abada);}async[_0x2b7853(0x1b8)](_0x1f71ef){const _0x3f30ae=_0x2b7853,_0x293c42=await this[_0x3f30ae(0x1cc)][_0x3f30ae(0x1c7)](_0x1f71ef[_0x3f30ae(0x195)]);return common_1['Logger'][_0x3f30ae(0x1c9)](_0x293c42,_0x3f30ae(0x173)),_0x3f30ae(0x19a)+encodeURIComponent(_0x293c42);}async[_0x2b7853(0x1b9)](_0x24610c,_0x2241aa){const _0xfcb4de=_0x2b7853;return this['officialService'][_0xfcb4de(0x1b9)](_0x24610c,_0x2241aa[_0xfcb4de(0x195)]);}async[_0x2b7853(0x1b7)](_0x2cdb75,_0x2b65bf){const _0x45d0ce=_0x2b7853;return this['officialService']['bindWxBySceneStr'](_0x2cdb75,_0x2b65bf[_0x45d0ce(0x195)]);}async[_0x2b7853(0x1d0)](_0x5e71f6){const _0x37da12=_0x2b7853;return this['officialService'][_0x37da12(0x1d0)](_0x5e71f6[_0x37da12(0x1a4)]);}async[_0x2b7853(0x18c)](_0x1fc995){const _0x1d3220=_0x2b7853;return this[_0x1d3220(0x1cc)][_0x1d3220(0x18c)](_0x1fc995[_0x1d3220(0x1a4)]);}async[_0x2b7853(0x19b)](_0x5908fb,_0x13a260){const _0x2af438=_0x2b7853;return this[_0x2af438(0x1cc)][_0x2af438(0x19b)](_0x5908fb,_0x13a260[_0x2af438(0x182)]);}async[_0x2b7853(0x1cb)](_0x1dc292,_0x3ea485){const _0x272d4c=_0x2b7853;return this[_0x272d4c(0x1cc)][_0x272d4c(0x1cb)](_0x1dc292,_0x3ea485);}};__decorate([(0x0,common_1['Get'])(_0x2b7853(0x1c6)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2b7853(0x1bd)}),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__param(0x1,(0x0,common_1[_0x2b7853(0x1a3)])()),__param(0x2,(0x0,common_1[_0x2b7853(0x1ad)])()),__metadata(_0x2b7853(0x1ab),Function),__metadata(_0x2b7853(0x193),[Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2b7853(0x1c6),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x1c6)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2b7853(0x1b5)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x2b7853(0x1a3)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x2b7853(0x1c1)])()),__metadata(_0x2b7853(0x1ab),Function),__metadata(_0x2b7853(0x193),[Object,Object,Object,Object]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController['prototype'],_0x2b7853(0x1a8),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])('getQRSceneStr'),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x2b7853(0x193),[getQrSceneStr_dto_1[_0x2b7853(0x18e)]]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController['prototype'],'getQRSceneStr',null),__decorate([(0x0,common_1['Post'])(_0x2b7853(0x16a)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x1bb)}),(0x0,common_1[_0x2b7853(0x1c8)])(jwtAuth_guard_1[_0x2b7853(0x1af)]),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__metadata(_0x2b7853(0x1ab),Function),__metadata(_0x2b7853(0x193),[Object]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])(_0x2b7853(0x1b8)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x163)}),__param(0x0,(0x0,common_1[_0x2b7853(0x1a3)])()),__metadata(_0x2b7853(0x1ab),Function),__metadata(_0x2b7853(0x193),[getQrCode_dto_1[_0x2b7853(0x190)]]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x1b8),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x1b9)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x164)}),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x2b7853(0x1ab),Function),__metadata(_0x2b7853(0x193),[Object,getQrCode_dto_1[_0x2b7853(0x190)]]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x1b9),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x1b7)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2b7853(0x180)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x2b7853(0x1af)]),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__param(0x1,(0x0,common_1[_0x2b7853(0x1ad)])()),__metadata('design:type',Function),__metadata(_0x2b7853(0x193),[Object,getQrCode_dto_1[_0x2b7853(0x190)]]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x1b7),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x1d0)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x183)}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x2b7853(0x193),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x1d0),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x18c)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x1ae)}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x2b7853(0x193),[Object]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x18c),null),__decorate([(0x0,common_1[_0x2b7853(0x1c0)])(_0x2b7853(0x19b)),(0x0,swagger_1[_0x2b7853(0x172)])({'summary':_0x2b7853(0x196)}),(0x0,swagger_1[_0x2b7853(0x1a9)])({'type':Login_vo_1[_0x2b7853(0x1b3)]}),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__param(0x1,(0x0,common_1[_0x2b7853(0x1ad)])()),__metadata('design:type',Function),__metadata(_0x2b7853(0x193),[Object,Object]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController[_0x2b7853(0x1c3)],_0x2b7853(0x19b),null),__decorate([(0x0,common_1[_0x2b7853(0x176)])(_0x2b7853(0x1cb)),__param(0x0,(0x0,common_1[_0x2b7853(0x1ce)])()),__param(0x1,(0x0,common_1[_0x2b7853(0x1a3)])(_0x2b7853(0x167))),__metadata(_0x2b7853(0x1ab),Function),__metadata('design:paramtypes',[Object,String]),__metadata(_0x2b7853(0x1cd),Promise)],OfficialController['prototype'],_0x2b7853(0x1cb),null),OfficialController=__decorate([(0x0,swagger_1[_0x2b7853(0x197)])(_0x2b7853(0x178)),(0x0,common_1['Controller'])('official'),__metadata(_0x2b7853(0x193),[official_service_1[_0x2b7853(0x1a5)]])],OfficialController),exports[_0x2b7853(0x170)]=OfficialController;