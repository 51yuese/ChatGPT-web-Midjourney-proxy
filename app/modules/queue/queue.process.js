'use strict';var _0x36f1e2=_0x3177;function _0x1191(){var _0x50ee25=['1914480nKRVmG','OnQueueResumed','18KuDFsV','914152YStKQV','onQueueProgress','1293JXslON',':\x20绘画失败\x20','message','log','prototype','logger','MJDRAW','onQueueCompleted','design:returntype','onQueueActive','mjDraw','midjourneyService','OnQueueActive','onQueuePaused','__metadata','__decorate','onQueueError','error','446201SHEuXb','\x20jobs\x20of\x20type\x20','getOwnPropertyDescriptor','onQueueFailed','object','OnQueueDrained','5679GoiYmx','onQueueResumed','handleJob','data','onQueueDrained','108155xqSZky','env','@nestjs/common','OnQueueCompleted','function','Queue\x20failed:\x20','OnQueueFailed','metadata','../midjourney/midjourney.service','design:paramtypes','374cmINep','队列恢复的时候调用','QueueProcessor','draw','Logger','OnQueueError','158367oPCNAZ','Queue\x20cleaned:\x20','design:type','Process','1064qddssK','110CIwngH','defineProperty','decorate','CONCURRENCY','length','OnQueueCleaned'];_0x1191=function(){return _0x50ee25;};return _0x1191();}(function(_0x391273,_0x149b3d){var _0x317c4f=_0x3177,_0x3129f7=_0x391273();while(!![]){try{var _0x455e0f=parseInt(_0x317c4f(0x149))/0x1+-parseInt(_0x317c4f(0x135))/0x2*(parseInt(_0x317c4f(0x14b))/0x3)+-parseInt(_0x317c4f(0x146))/0x4+parseInt(_0x317c4f(0x12b))/0x5+parseInt(_0x317c4f(0x148))/0x6*(parseInt(_0x317c4f(0x15d))/0x7)+parseInt(_0x317c4f(0x13f))/0x8*(parseInt(_0x317c4f(0x126))/0x9)+parseInt(_0x317c4f(0x140))/0xa*(-parseInt(_0x317c4f(0x13b))/0xb);if(_0x455e0f===_0x149b3d)break;else _0x3129f7['push'](_0x3129f7['shift']());}catch(_0x444994){_0x3129f7['push'](_0x3129f7['shift']());}}}(_0x1191,0x78727));function _0x3177(_0xa1835c,_0x42bed1){var _0x119105=_0x1191();return _0x3177=function(_0x3177d,_0x54e28f){_0x3177d=_0x3177d-0x122;var _0x3f319e=_0x119105[_0x3177d];return _0x3f319e;},_0x3177(_0xa1835c,_0x42bed1);}var __decorate=this&&this[_0x36f1e2(0x15a)]||function(_0x59bdbc,_0x549d91,_0x48349a,_0x260013){var _0xa8bbd4=_0x36f1e2,_0x323f38=arguments[_0xa8bbd4(0x144)],_0x30d7f2=_0x323f38<0x3?_0x549d91:_0x260013===null?_0x260013=Object[_0xa8bbd4(0x122)](_0x549d91,_0x48349a):_0x260013,_0x41b8a4;if(typeof Reflect===_0xa8bbd4(0x124)&&typeof Reflect[_0xa8bbd4(0x142)]==='function')_0x30d7f2=Reflect[_0xa8bbd4(0x142)](_0x59bdbc,_0x549d91,_0x48349a,_0x260013);else{for(var _0x3d41da=_0x59bdbc[_0xa8bbd4(0x144)]-0x1;_0x3d41da>=0x0;_0x3d41da--)if(_0x41b8a4=_0x59bdbc[_0x3d41da])_0x30d7f2=(_0x323f38<0x3?_0x41b8a4(_0x30d7f2):_0x323f38>0x3?_0x41b8a4(_0x549d91,_0x48349a,_0x30d7f2):_0x41b8a4(_0x549d91,_0x48349a))||_0x30d7f2;}return _0x323f38>0x3&&_0x30d7f2&&Object[_0xa8bbd4(0x141)](_0x549d91,_0x48349a,_0x30d7f2),_0x30d7f2;},__metadata=this&&this[_0x36f1e2(0x159)]||function(_0x396430,_0x35e82b){var _0xda9a82=_0x36f1e2;if(typeof Reflect===_0xda9a82(0x124)&&typeof Reflect[_0xda9a82(0x132)]===_0xda9a82(0x12f))return Reflect[_0xda9a82(0x132)](_0x396430,_0x35e82b);},QueueProcessor_1;Object[_0x36f1e2(0x141)](exports,'__esModule',{'value':!![]}),exports[_0x36f1e2(0x137)]=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require(_0x36f1e2(0x12d)),midjourney_service_1=require(_0x36f1e2(0x133));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x4a3a5f){var _0x297b17=_0x36f1e2;this[_0x297b17(0x156)]=_0x4a3a5f,this[_0x297b17(0x150)]=new common_1[(_0x297b17(0x139))](QueueProcessor_1['name']);}async[_0x36f1e2(0x128)](_0x35a795){var _0x2b49e2=_0x36f1e2;const _0x28b20d=await this[_0x2b49e2(0x156)][_0x2b49e2(0x138)](_0x35a795[_0x2b49e2(0x129)],_0x35a795['id']);return _0x28b20d;}['onQueueActive'](_0x14ae77){}['onQueueError'](_0xd38771){var _0xc1727f=_0x36f1e2;console[_0xc1727f(0x14e)]('队列发生错误',_0xd38771);}[_0x36f1e2(0x14a)](_0x2a255c,_0x1082e9){console['log']('队列任务的一个回调用于通知当前进度',_0x2a255c['id'],_0x1082e9);}[_0x36f1e2(0x152)](_0x578263,_0x396d00){}[_0x36f1e2(0x123)](_0x1f4461,_0x24bbad){var _0x34abe1=_0x36f1e2;common_1[_0x34abe1(0x139)][_0x34abe1(0x15c)](_0x34abe1(0x130)+_0x24bbad[_0x34abe1(0x14d)]+_0x34abe1(0x14c)+_0x1f4461['id'],'QueueProcessor'),this['midjourneyService']['drawFailed'](_0x1f4461[_0x34abe1(0x129)]);}[_0x36f1e2(0x158)](){var _0x145804=_0x36f1e2;console[_0x145804(0x14e)]('队列暂停的时候调用');}[_0x36f1e2(0x127)](){var _0x39a860=_0x36f1e2;console[_0x39a860(0x14e)](_0x39a860(0x136));}['onQueueCleaned'](_0x6404af,_0x4eb99d){var _0xd2b607=_0x36f1e2;common_1[_0xd2b607(0x139)][_0xd2b607(0x14e)](_0xd2b607(0x13c)+_0x6404af[_0xd2b607(0x144)]+_0xd2b607(0x15e)+_0x4eb99d+'\x20were\x20cleaned.','QueueProcessor');}[_0x36f1e2(0x12a)](){}};__decorate([(0x0,bull_1[_0x36f1e2(0x13e)])({'name':_0x36f1e2(0x155),'concurrency':process[_0x36f1e2(0x12c)][_0x36f1e2(0x143)]?+process[_0x36f1e2(0x12c)]['CONCURRENCY']:0x3}),__metadata(_0x36f1e2(0x13d),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x36f1e2(0x153),Promise)],QueueProcessor[_0x36f1e2(0x14f)],_0x36f1e2(0x128),null),__decorate([(0x0,bull_1[_0x36f1e2(0x157)])(),__metadata('design:type',Function),__metadata(_0x36f1e2(0x134),[Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],_0x36f1e2(0x154),null),__decorate([(0x0,bull_1[_0x36f1e2(0x13a)])(),__metadata('design:type',Function),__metadata(_0x36f1e2(0x134),[Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],_0x36f1e2(0x15b),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x36f1e2(0x13d),Function),__metadata(_0x36f1e2(0x134),[Object,Number]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor['prototype'],_0x36f1e2(0x14a),null),__decorate([(0x0,bull_1[_0x36f1e2(0x12e)])(),__metadata(_0x36f1e2(0x13d),Function),__metadata(_0x36f1e2(0x134),[Object,Object]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],'onQueueCompleted',null),__decorate([(0x0,bull_1[_0x36f1e2(0x131)])(),__metadata(_0x36f1e2(0x13d),Function),__metadata(_0x36f1e2(0x134),[Object,Error]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],'onQueueFailed',null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata(_0x36f1e2(0x13d),Function),__metadata('design:paramtypes',[]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],_0x36f1e2(0x158),null),__decorate([(0x0,bull_1[_0x36f1e2(0x147)])(),__metadata(_0x36f1e2(0x13d),Function),__metadata(_0x36f1e2(0x134),[]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor['prototype'],'onQueueResumed',null),__decorate([(0x0,bull_1[_0x36f1e2(0x145)])(),__metadata(_0x36f1e2(0x13d),Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0x36f1e2(0x153),void 0x0)],QueueProcessor[_0x36f1e2(0x14f)],'onQueueCleaned',null),__decorate([(0x0,bull_1[_0x36f1e2(0x125)])(),__metadata(_0x36f1e2(0x13d),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x36f1e2(0x12a),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x36f1e2(0x151)),__metadata(_0x36f1e2(0x134),[midjourney_service_1['MidjourneyService']])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;