'use strict';var _0x5c6871=_0x3f26;(function(_0x5a44bf,_0x4cdefc){var _0x587c1e=_0x3f26,_0x3593ff=_0x5a44bf();while(!![]){try{var _0x3d77e4=parseInt(_0x587c1e(0x14d))/0x1+parseInt(_0x587c1e(0x141))/0x2*(-parseInt(_0x587c1e(0x16c))/0x3)+-parseInt(_0x587c1e(0x150))/0x4+-parseInt(_0x587c1e(0x12f))/0x5*(parseInt(_0x587c1e(0x132))/0x6)+parseInt(_0x587c1e(0x137))/0x7*(parseInt(_0x587c1e(0x13f))/0x8)+parseInt(_0x587c1e(0x14a))/0x9*(-parseInt(_0x587c1e(0x16b))/0xa)+-parseInt(_0x587c1e(0x157))/0xb*(-parseInt(_0x587c1e(0x13d))/0xc);if(_0x3d77e4===_0x4cdefc)break;else _0x3593ff['push'](_0x3593ff['shift']());}catch(_0x2e5fa4){_0x3593ff['push'](_0x3593ff['shift']());}}}(_0x9b07,0x558d7));function _0x3f26(_0xc04a7d,_0x8974e6){var _0x9b07c3=_0x9b07();return _0x3f26=function(_0x3f265d,_0x1e1617){_0x3f265d=_0x3f265d-0x12e;var _0x947305=_0x9b07c3[_0x3f265d];return _0x947305;},_0x3f26(_0xc04a7d,_0x8974e6);}function _0x9b07(){var _0x206481=['@nestjs/common','onQueueResumed','midjourneyService','\x20were\x20cleaned.','OnQueueDrained\x20当前队列已经空了','prototype','队列暂停的时候调用','logger','OnQueueProgress','OnQueueResumed','OnQueueFailed','Logger','data','design:type','error','20aGssYW','69EFZBuo','defineProperty','onQueueCompleted','onQueueActive','5Tghmel','Queue\x20cleaned:\x20','OnQueueError','102612LcrAOF','Process','onQueueDrained','MJDRAW','log','7yKfiMW','OnQueueDrained','../midjourney/midjourney.service','QueueProcessor','name','metadata','48Zglcdz','object','5032752ZrXdWw','mjDraw','34154PVabNl','length','OnQueueCleaned','design:returntype','onQueueProgress','function','env','handleJob','OnQueuePaused','2129877eGhVmh','onQueueCleaned','Processor','181507OVRiyh','__decorate','队列任务完成的时候调用','1014860TCDwsa','绘图队列发生错误','__metadata','process',':\x20绘画失败\x20','将在队列中的任务变为活动状态时被调用','design:paramtypes','1860969SnUlKs','draw\x20mj\x20failed:\x20','onQueuePaused','__esModule','getOwnPropertyDescriptor'];_0x9b07=function(){return _0x206481;};return _0x9b07();}var __decorate=this&&this[_0x5c6871(0x14e)]||function(_0x2407d3,_0x596696,_0x20593a,_0x3e1593){var _0x512e9f=_0x5c6871,_0x4f40cf=arguments[_0x512e9f(0x142)],_0x5dc28a=_0x4f40cf<0x3?_0x596696:_0x3e1593===null?_0x3e1593=Object[_0x512e9f(0x15b)](_0x596696,_0x20593a):_0x3e1593,_0x2df7f1;if(typeof Reflect===_0x512e9f(0x13e)&&typeof Reflect['decorate']==='function')_0x5dc28a=Reflect['decorate'](_0x2407d3,_0x596696,_0x20593a,_0x3e1593);else{for(var _0x5e5d28=_0x2407d3[_0x512e9f(0x142)]-0x1;_0x5e5d28>=0x0;_0x5e5d28--)if(_0x2df7f1=_0x2407d3[_0x5e5d28])_0x5dc28a=(_0x4f40cf<0x3?_0x2df7f1(_0x5dc28a):_0x4f40cf>0x3?_0x2df7f1(_0x596696,_0x20593a,_0x5dc28a):_0x2df7f1(_0x596696,_0x20593a))||_0x5dc28a;}return _0x4f40cf>0x3&&_0x5dc28a&&Object['defineProperty'](_0x596696,_0x20593a,_0x5dc28a),_0x5dc28a;},__metadata=this&&this[_0x5c6871(0x152)]||function(_0x439040,_0xbf9390){var _0x4ab6f9=_0x5c6871;if(typeof Reflect===_0x4ab6f9(0x13e)&&typeof Reflect['metadata']===_0x4ab6f9(0x146))return Reflect[_0x4ab6f9(0x13c)](_0x439040,_0xbf9390);},QueueProcessor_1;Object[_0x5c6871(0x16d)](exports,_0x5c6871(0x15a),{'value':!![]}),exports[_0x5c6871(0x13a)]=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require(_0x5c6871(0x15c)),midjourney_service_1=require(_0x5c6871(0x139)),process=require(_0x5c6871(0x153));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x16991d){var _0x3ad2e4=_0x5c6871;this[_0x3ad2e4(0x15e)]=_0x16991d,this[_0x3ad2e4(0x163)]=new common_1[(_0x3ad2e4(0x167))](QueueProcessor_1[_0x3ad2e4(0x13b)]);}async['handleJob'](_0x4fb7de){var _0x4138a3=_0x5c6871;common_1['Logger'][_0x4138a3(0x136)](process[_0x4138a3(0x147)]['CONCURRENCY'],'current\x20CONCURRENCY');}[_0x5c6871(0x12e)](_0x17f68c){var _0x293e7f=_0x5c6871;this[_0x293e7f(0x163)][_0x293e7f(0x136)](_0x293e7f(0x155),_0x17f68c['id']);}['onQueueError'](_0x197b68){var _0x28c7c3=_0x5c6871;this[_0x28c7c3(0x163)]['log'](_0x28c7c3(0x151),_0x197b68);}[_0x5c6871(0x145)](_0x171d19,_0x1974b1){var _0x1c427c=_0x5c6871;this['logger'][_0x1c427c(0x136)]('队列任务的一个回调用于通知当前进度',_0x171d19['id'],_0x1974b1);}['onQueueCompleted'](_0x3d51a8,_0x1651a6){var _0x299a09=_0x5c6871;this['logger'][_0x299a09(0x136)](_0x299a09(0x14f),_0x3d51a8['id'],_0x1651a6);}['onQueueFailed'](_0x1dd623,_0x1738d6){var _0x243f93=_0x5c6871;common_1[_0x243f93(0x167)][_0x243f93(0x16a)](_0x243f93(0x158)+_0x1738d6['message']+_0x243f93(0x154)+_0x1dd623['id'],_0x243f93(0x13a)),this[_0x243f93(0x15e)]['drawFailed'](_0x1dd623[_0x243f93(0x168)]);}['onQueuePaused'](){var _0x5d0403=_0x5c6871;this['logger'][_0x5d0403(0x136)](_0x5d0403(0x162));}[_0x5c6871(0x15d)](){var _0x3aee22=_0x5c6871;this[_0x3aee22(0x163)][_0x3aee22(0x136)]('队列恢复的时候调用');}[_0x5c6871(0x14b)](_0x5106fe,_0x5ea1e7){var _0x464d92=_0x5c6871;common_1['Logger']['log'](_0x464d92(0x130)+_0x5106fe[_0x464d92(0x142)]+'\x20jobs\x20of\x20type\x20'+_0x5ea1e7+_0x464d92(0x15f),_0x464d92(0x13a));}[_0x5c6871(0x134)](){var _0x43242d=_0x5c6871;this[_0x43242d(0x163)][_0x43242d(0x136)](_0x43242d(0x160));}};__decorate([(0x0,bull_1[_0x5c6871(0x133)])({'name':_0x5c6871(0x140),'concurrency':process[_0x5c6871(0x147)]['CONCURRENCY']?+process[_0x5c6871(0x147)]['CONCURRENCY']:0xa}),__metadata('design:type',Function),__metadata(_0x5c6871(0x156),[Object]),__metadata('design:returntype',Promise)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x148),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x5c6871(0x12e),null),__decorate([(0x0,bull_1[_0x5c6871(0x131)])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x5c6871(0x161)],'onQueueError',null),__decorate([(0x0,bull_1[_0x5c6871(0x164)])(),__metadata('design:type',Function),__metadata(_0x5c6871(0x156),[Object,Number]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x145),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x16e),null),__decorate([(0x0,bull_1[_0x5c6871(0x166)])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[Object,Error]),__metadata(_0x5c6871(0x144),void 0x0)],QueueProcessor[_0x5c6871(0x161)],'onQueueFailed',null),__decorate([(0x0,bull_1[_0x5c6871(0x149)])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[]),__metadata(_0x5c6871(0x144),void 0x0)],QueueProcessor['prototype'],_0x5c6871(0x159),null),__decorate([(0x0,bull_1[_0x5c6871(0x165)])(),__metadata(_0x5c6871(0x169),Function),__metadata(_0x5c6871(0x156),[]),__metadata(_0x5c6871(0x144),void 0x0)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x15d),null),__decorate([(0x0,bull_1[_0x5c6871(0x143)])(),__metadata('design:type',Function),__metadata(_0x5c6871(0x156),[Array,String]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x14b),null),__decorate([(0x0,bull_1[_0x5c6871(0x138)])(),__metadata('design:type',Function),__metadata(_0x5c6871(0x156),[]),__metadata(_0x5c6871(0x144),void 0x0)],QueueProcessor[_0x5c6871(0x161)],_0x5c6871(0x134),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x5c6871(0x14c)])(_0x5c6871(0x135)),__metadata(_0x5c6871(0x156),[midjourney_service_1['MidjourneyService']])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;