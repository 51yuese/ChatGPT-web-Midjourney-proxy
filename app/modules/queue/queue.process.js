'use strict';var _0x48f5b6=_0xf80d;(function(_0x176e1d,_0x19a6c7){var _0x17f532=_0xf80d,_0x3f8659=_0x176e1d();while(!![]){try{var _0x2e8b14=-parseInt(_0x17f532(0xaa))/0x1*(-parseInt(_0x17f532(0xa9))/0x2)+parseInt(_0x17f532(0xbc))/0x3+parseInt(_0x17f532(0xbf))/0x4+-parseInt(_0x17f532(0xa0))/0x5+parseInt(_0x17f532(0xab))/0x6*(parseInt(_0x17f532(0xcc))/0x7)+-parseInt(_0x17f532(0xc3))/0x8+parseInt(_0x17f532(0xac))/0x9*(-parseInt(_0x17f532(0x9a))/0xa);if(_0x2e8b14===_0x19a6c7)break;else _0x3f8659['push'](_0x3f8659['shift']());}catch(_0x31ca38){_0x3f8659['push'](_0x3f8659['shift']());}}}(_0x40f8,0x6b19b));var __decorate=this&&this[_0x48f5b6(0x8a)]||function(_0x53c8bb,_0x3362dc,_0x36a2e1,_0x589468){var _0x5030e1=_0x48f5b6,_0x214170=arguments[_0x5030e1(0xbd)],_0x258ef9=_0x214170<0x3?_0x3362dc:_0x589468===null?_0x589468=Object[_0x5030e1(0xad)](_0x3362dc,_0x36a2e1):_0x589468,_0x4ee4e3;if(typeof Reflect===_0x5030e1(0xc5)&&typeof Reflect[_0x5030e1(0xba)]===_0x5030e1(0x8f))_0x258ef9=Reflect[_0x5030e1(0xba)](_0x53c8bb,_0x3362dc,_0x36a2e1,_0x589468);else{for(var _0x348ef7=_0x53c8bb[_0x5030e1(0xbd)]-0x1;_0x348ef7>=0x0;_0x348ef7--)if(_0x4ee4e3=_0x53c8bb[_0x348ef7])_0x258ef9=(_0x214170<0x3?_0x4ee4e3(_0x258ef9):_0x214170>0x3?_0x4ee4e3(_0x3362dc,_0x36a2e1,_0x258ef9):_0x4ee4e3(_0x3362dc,_0x36a2e1))||_0x258ef9;}return _0x214170>0x3&&_0x258ef9&&Object[_0x5030e1(0xa4)](_0x3362dc,_0x36a2e1,_0x258ef9),_0x258ef9;},__metadata=this&&this[_0x48f5b6(0xb9)]||function(_0x6ff9d4,_0x5899d9){var _0x260aef=_0x48f5b6;if(typeof Reflect===_0x260aef(0xc5)&&typeof Reflect['metadata']===_0x260aef(0x8f))return Reflect['metadata'](_0x6ff9d4,_0x5899d9);},QueueProcessor_1;Object[_0x48f5b6(0xa4)](exports,_0x48f5b6(0xa1),{'value':!![]}),exports['QueueProcessor']=void 0x0;const bull_1=require('@nestjs/bull'),common_1=require(_0x48f5b6(0xc1)),midjourney_service_1=require(_0x48f5b6(0xb6)),process=require(_0x48f5b6(0xae));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x5d7486){var _0x4d41f1=_0x48f5b6;this[_0x4d41f1(0xc6)]=_0x5d7486,this[_0x4d41f1(0x9d)]=new common_1['Logger'](QueueProcessor_1[_0x4d41f1(0xa2)]);}async['handleJob'](_0x172e47){var _0x3edf64=_0x48f5b6;common_1[_0x3edf64(0x8c)]['log'](process[_0x3edf64(0xca)]['CONCURRENCY'],_0x3edf64(0xb5));}['onQueueActive'](_0x8e9446){var _0x504e28=_0x48f5b6;this[_0x504e28(0x9d)]['log'](_0x504e28(0xb7),_0x8e9446['id']);}[_0x48f5b6(0x9e)](_0x3806ce){var _0x406ee1=_0x48f5b6;this[_0x406ee1(0x9d)][_0x406ee1(0xb2)](_0x406ee1(0xa3),_0x3806ce);}['onQueueProgress'](_0xf9f907,_0x37eb50){var _0x17fe53=_0x48f5b6;this[_0x17fe53(0x9d)]['log'](_0x17fe53(0xc8),_0xf9f907['id'],_0x37eb50);}[_0x48f5b6(0x97)](_0xeab664,_0x347413){var _0x199d6a=_0x48f5b6;this['logger']['log'](_0x199d6a(0x94),_0xeab664['id'],_0x347413);}[_0x48f5b6(0xa7)](_0x353a8a,_0x20250a){var _0x5325e1=_0x48f5b6;common_1[_0x5325e1(0x8c)][_0x5325e1(0xc9)](_0x5325e1(0x95)+_0x20250a[_0x5325e1(0xc0)]+_0x5325e1(0x93)+_0x353a8a['id'],_0x5325e1(0xa5)),this[_0x5325e1(0xc6)][_0x5325e1(0x91)](_0x353a8a[_0x5325e1(0xb3)]);}['onQueuePaused'](){var _0x413f52=_0x48f5b6;this[_0x413f52(0x9d)]['log'](_0x413f52(0xbe));}[_0x48f5b6(0x98)](){var _0x433ec5=_0x48f5b6;this[_0x433ec5(0x9d)]['log']('队列恢复的时候调用');}[_0x48f5b6(0xb4)](_0x316970,_0x197f69){var _0x479599=_0x48f5b6;common_1[_0x479599(0x8c)][_0x479599(0xb2)]('Queue\x20cleaned:\x20'+_0x316970[_0x479599(0xbd)]+_0x479599(0x99)+_0x197f69+'\x20were\x20cleaned.',_0x479599(0xa5));}[_0x48f5b6(0xb1)](){var _0x1c7b4=_0x48f5b6;this[_0x1c7b4(0x9d)][_0x1c7b4(0xb2)]('OnQueueDrained\x20当前队列已经空了');}};function _0xf80d(_0x11122a,_0x3bebae){var _0x40f89b=_0x40f8();return _0xf80d=function(_0xf80dda,_0x1aacb3){_0xf80dda=_0xf80dda-0x8a;var _0x4aafa6=_0x40f89b[_0xf80dda];return _0x4aafa6;},_0xf80d(_0x11122a,_0x3bebae);}function _0x40f8(){var _0x341b1b=['drawFailed','CONCURRENCY',':\x20绘画失败\x20','队列任务完成的时候调用','draw\x20mj\x20failed:\x20','OnQueueProgress','onQueueCompleted','onQueueResumed','\x20jobs\x20of\x20type\x20','10YWwtaw','onQueuePaused','OnQueuePaused','logger','onQueueError','design:paramtypes','3763335nbjZNH','__esModule','name','绘图队列发生错误','defineProperty','QueueProcessor','MJDRAW','onQueueFailed','OnQueueResumed','48990POxxLL','19SLDJyj','6XANtQw','2826459sqzkZm','getOwnPropertyDescriptor','process','design:type','OnQueueError','onQueueDrained','log','data','onQueueCleaned','current\x20CONCURRENCY','../midjourney/midjourney.service','将在队列中的任务变为活动状态时被调用','OnQueueCleaned','__metadata','decorate','OnQueueFailed','2117736fWrNsN','length','队列暂停的时候调用','867184HkXTWN','message','@nestjs/common','Process','365368veFdRp','Processor','object','midjourneyService','OnQueueDrained','队列任务的一个回调用于通知当前进度','error','env','prototype','1140713OPHGKx','__decorate','design:returntype','Logger','MidjourneyService','OnQueueCompleted','function','onQueueProgress'];_0x40f8=function(){return _0x341b1b;};return _0x40f8();}__decorate([(0x0,bull_1[_0x48f5b6(0xc2)])({'name':'mjDraw','concurrency':process[_0x48f5b6(0xca)][_0x48f5b6(0x92)]?+process[_0x48f5b6(0xca)][_0x48f5b6(0x92)]:0xa}),__metadata('design:type',Function),__metadata(_0x48f5b6(0x9f),[Object]),__metadata('design:returntype',Promise)],QueueProcessor[_0x48f5b6(0xcb)],'handleJob',null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[Object]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor['prototype'],'onQueueActive',null),__decorate([(0x0,bull_1[_0x48f5b6(0xb0)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[Error]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor[_0x48f5b6(0xcb)],_0x48f5b6(0x9e),null),__decorate([(0x0,bull_1[_0x48f5b6(0x96)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[Object,Number]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor[_0x48f5b6(0xcb)],_0x48f5b6(0x90),null),__decorate([(0x0,bull_1[_0x48f5b6(0x8e)])(),__metadata('design:type',Function),__metadata(_0x48f5b6(0x9f),[Object,Object]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor['prototype'],'onQueueCompleted',null),__decorate([(0x0,bull_1[_0x48f5b6(0xbb)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,Error]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor[_0x48f5b6(0xcb)],_0x48f5b6(0xa7),null),__decorate([(0x0,bull_1[_0x48f5b6(0x9c)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor[_0x48f5b6(0xcb)],_0x48f5b6(0x9b),null),__decorate([(0x0,bull_1[_0x48f5b6(0xa8)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor['prototype'],_0x48f5b6(0x98),null),__decorate([(0x0,bull_1[_0x48f5b6(0xb8)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[Array,String]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor['prototype'],_0x48f5b6(0xb4),null),__decorate([(0x0,bull_1[_0x48f5b6(0xc7)])(),__metadata(_0x48f5b6(0xaf),Function),__metadata(_0x48f5b6(0x9f),[]),__metadata(_0x48f5b6(0x8b),void 0x0)],QueueProcessor[_0x48f5b6(0xcb)],_0x48f5b6(0xb1),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x48f5b6(0xc4)])(_0x48f5b6(0xa6)),__metadata('design:paramtypes',[midjourney_service_1[_0x48f5b6(0x8d)]])],QueueProcessor),exports[_0x48f5b6(0xa5)]=QueueProcessor;