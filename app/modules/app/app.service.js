'use strict';const _0x134882=_0x21f6;(function(_0x3e1169,_0x2caf5e){const _0x163c03=_0x21f6,_0x1588c5=_0x3e1169();while(!![]){try{const _0x19ccce=parseInt(_0x163c03(0xab))/0x1*(parseInt(_0x163c03(0xcc))/0x2)+parseInt(_0x163c03(0xd3))/0x3*(parseInt(_0x163c03(0xce))/0x4)+parseInt(_0x163c03(0xd8))/0x5+-parseInt(_0x163c03(0xcf))/0x6+-parseInt(_0x163c03(0xf3))/0x7+parseInt(_0x163c03(0xd0))/0x8*(parseInt(_0x163c03(0xb3))/0x9)+parseInt(_0x163c03(0x111))/0xa*(parseInt(_0x163c03(0x100))/0xb);if(_0x19ccce===_0x2caf5e)break;else _0x1588c5['push'](_0x1588c5['shift']());}catch(_0x3edf30){_0x1588c5['push'](_0x1588c5['shift']());}}}(_0x30e0,0xecc83));function _0x21f6(_0x443ec8,_0x52fe7c){const _0x30e038=_0x30e0();return _0x21f6=function(_0x21f6a8,_0x2577d6){_0x21f6a8=_0x21f6a8-0xa6;let _0x1ee7d6=_0x30e038[_0x21f6a8];return _0x1ee7d6;},_0x21f6(_0x443ec8,_0x52fe7c);}var __decorate=this&&this[_0x134882(0xdc)]||function(_0x317f54,_0x38bb6a,_0x14ce58,_0x17aa9e){const _0x2145f3=_0x134882;var _0x1a6780=arguments[_0x2145f3(0xec)],_0x4e721f=_0x1a6780<0x3?_0x38bb6a:_0x17aa9e===null?_0x17aa9e=Object['getOwnPropertyDescriptor'](_0x38bb6a,_0x14ce58):_0x17aa9e,_0x451b4e;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x2145f3(0xc5))_0x4e721f=Reflect[_0x2145f3(0x101)](_0x317f54,_0x38bb6a,_0x14ce58,_0x17aa9e);else{for(var _0x142dd4=_0x317f54[_0x2145f3(0xec)]-0x1;_0x142dd4>=0x0;_0x142dd4--)if(_0x451b4e=_0x317f54[_0x142dd4])_0x4e721f=(_0x1a6780<0x3?_0x451b4e(_0x4e721f):_0x1a6780>0x3?_0x451b4e(_0x38bb6a,_0x14ce58,_0x4e721f):_0x451b4e(_0x38bb6a,_0x14ce58))||_0x4e721f;}return _0x1a6780>0x3&&_0x4e721f&&Object[_0x2145f3(0x114)](_0x38bb6a,_0x14ce58,_0x4e721f),_0x4e721f;},__metadata=this&&this[_0x134882(0xf0)]||function(_0x672c1a,_0x26022a){const _0x1070d1=_0x134882;if(typeof Reflect==='object'&&typeof Reflect[_0x1070d1(0xf2)]==='function')return Reflect[_0x1070d1(0xf2)](_0x672c1a,_0x26022a);},__param=this&&this[_0x134882(0xfe)]||function(_0x11c7d5,_0x30d1e6){return function(_0x5bddba,_0x5bfb55){_0x30d1e6(_0x5bddba,_0x5bfb55,_0x11c7d5);};};Object[_0x134882(0x114)](exports,_0x134882(0x109),{'value':!![]}),exports[_0x134882(0xeb)]=void 0x0;const common_1=require(_0x134882(0x105)),appCats_entity_1=require(_0x134882(0xd1)),typeorm_1=require(_0x134882(0xc0)),typeorm_2=require(_0x134882(0xed)),app_entity_1=require(_0x134882(0xc1)),userApps_entity_1=require(_0x134882(0xa7)),gpts_model_entity_1=require('../gpts/gpts.model.entity');function _0x30e0(){const _0x408aa6=['createApp','18ZqmHEl','preset','mineAppsV3','\x20OFFSET\x20','IsNull','collectCount','BAD_REQUEST','createAppCat','updateApp','auditFail','修改App信息失败！','find','message','typeorm','./app.entity','coverImg','GptsModelEntity','role','function','应用审核拒绝完成','system','appId','Logger','Repository','user','4NuAGCm','该分类下存在App，不可删除！','4696ZtZCsY','7053396ZeYcuH','5221496ItRzgD','./appCats.entity','该应用已被用户关联使用中，不可删除！','1461XHMlyL','log','Not','affected','collect','3144505PHzWiT','Injectable','forEach','connection','__decorate','gptsModelEntity','appName','******','frontAppList','delete','删除App失败！','name','round','修改失败！','findAndCount','des','catName','AppCatsEntity','random','AppService','length','@nestjs/typeorm','HttpException','应用审核通过','__metadata','status','metadata','11119948wEmywv','该分类不存在！','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20','catch','updateAppCats','HttpStatus','map','已将应用移除我的应用!','\x0a\x20\x20\x20\x20\x20\x20','query','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','__param','DESC','198SIcuRC','decorate','delMineApp','该应用名称已存在！','customApp','@nestjs/common','count','userId','appList','__esModule','delApp','catId','该分类名称已存在！','update','删除应用成功！','save','appEntity','426050BVqDyx','MoreThan','该应用不存在！','defineProperty','AppEntity','demoData','appCatsEntity','InjectRepository','./userApps.entity','appDes','findOne','UserAppsEntity','230543fQwtzp','Like','userAppsEntity','删除失败！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','已将应用添加到我的应用！','appCount'];_0x30e0=function(){return _0x408aa6;};return _0x30e0();}let AppService=class AppService{constructor(_0x597c14,_0x59a085,_0x59d001,_0x3764a1,_0x2b3fcb){const _0x1d34f0=_0x134882;this[_0x1d34f0(0x117)]=_0x597c14,this[_0x1d34f0(0x110)]=_0x59a085,this[_0x1d34f0(0xdd)]=_0x59d001,this[_0x1d34f0(0xad)]=_0x3764a1,this[_0x1d34f0(0xdb)]=_0x2b3fcb;}async[_0x134882(0xba)](_0x36b6d3){const _0x141273=_0x134882,{name:_0x51ebeb}=_0x36b6d3,_0x20072e=await this['appCatsEntity'][_0x141273(0xa9)]({'where':{'name':_0x51ebeb}});if(_0x20072e)throw new common_1[(_0x141273(0xee))](_0x141273(0x10c),common_1['HttpStatus'][_0x141273(0xb9)]);return await this[_0x141273(0x117)]['save'](_0x36b6d3);}async['delAppCat'](_0x5080c9){const _0x303bc2=_0x134882,{id:_0x5e4266}=_0x5080c9,_0x305edc=await this[_0x303bc2(0x117)][_0x303bc2(0xa9)]({'where':{'id':_0x5e4266}});if(!_0x305edc)throw new common_1[(_0x303bc2(0xee))]('该分类不存在！',common_1[_0x303bc2(0xf8)][_0x303bc2(0xb9)]);const _0x395409=await this[_0x303bc2(0x110)]['count']({'where':{'catId':_0x5e4266}});if(_0x395409>0x0)throw new common_1[(_0x303bc2(0xee))](_0x303bc2(0xcd),common_1[_0x303bc2(0xf8)]['BAD_REQUEST']);const _0x1e76c4=await this[_0x303bc2(0x117)][_0x303bc2(0xe1)](_0x5e4266);if(_0x1e76c4[_0x303bc2(0xd6)]>0x0)return'删除成功';throw new common_1[(_0x303bc2(0xee))](_0x303bc2(0xae),common_1[_0x303bc2(0xf8)]['BAD_REQUEST']);}async[_0x134882(0xf7)](_0x297d18){const _0x2b2963=_0x134882,{id:_0x16cc67,name:_0x4caaab}=_0x297d18,_0x151793=await this['appCatsEntity']['findOne']({'where':{'name':_0x4caaab,'id':(0x0,typeorm_1[_0x2b2963(0xd5)])(_0x16cc67)}});if(_0x151793)throw new common_1[(_0x2b2963(0xee))](_0x2b2963(0x10c),common_1[_0x2b2963(0xf8)][_0x2b2963(0xb9)]);const _0x4a113a=await this[_0x2b2963(0x117)][_0x2b2963(0x10d)]({'id':_0x16cc67},_0x297d18);if(_0x4a113a[_0x2b2963(0xd6)]>0x0)return'修改成功';throw new common_1['HttpException'](_0x2b2963(0xe5),common_1['HttpStatus']['BAD_REQUEST']);}async['appCatsList'](_0x41c84a){const _0x268db8=_0x134882,{page:page=0x1,size:size=0xa,name:_0x58b76a,status:_0x2e016a}=_0x41c84a,_0x10a9eb={};_0x58b76a&&(_0x10a9eb['name']=(0x0,typeorm_1[_0x268db8(0xac)])('%'+_0x58b76a+'%')),[0x0,0x1,'0','1']['includes'](_0x2e016a)&&(_0x10a9eb[_0x268db8(0xf1)]=_0x2e016a);const [_0x42fc92,_0x7904ac]=await this['appCatsEntity'][_0x268db8(0xe6)]({'where':_0x10a9eb,'order':{'order':'DESC'},'skip':(page-0x1)*size,'take':size}),_0x329420=_0x42fc92[_0x268db8(0xf9)](_0x60e06d=>_0x60e06d['id']),_0x5633cb=await this[_0x268db8(0x110)][_0x268db8(0xbe)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x329420)}}),_0x20e11e={};return _0x5633cb[_0x268db8(0xda)](_0x8efdd3=>{const _0x451a6c=_0x268db8;_0x20e11e[_0x8efdd3[_0x451a6c(0x10b)]]?_0x20e11e[_0x8efdd3[_0x451a6c(0x10b)]]+=0x1:_0x20e11e[_0x8efdd3[_0x451a6c(0x10b)]]=0x1;}),_0x42fc92['forEach'](_0x232406=>_0x232406[_0x268db8(0xb1)]=_0x20e11e[_0x232406['id']]||0x0),{'rows':_0x42fc92,'count':_0x7904ac};}async[_0x134882(0x108)](_0x5208ef,_0x9c9ccc,_0x77e078='id'){const _0x291536=_0x134882;console['log'](_0x9c9ccc);const {page:page=0x1,size:size=0xa,name:_0x15ce55,status:_0x5db3e6,catId:_0x433962,role:_0xaa8947}=_0x9c9ccc,_0xcbca52={};_0x15ce55&&(_0xcbca52[_0x291536(0xe3)]=(0x0,typeorm_1[_0x291536(0xac)])('%'+_0x15ce55+'%')),_0x433962&&(_0xcbca52[_0x291536(0x10b)]=_0x433962),_0xaa8947&&(_0xcbca52['role']=_0xaa8947),_0x5db3e6&&(_0xcbca52['status']=_0x5db3e6);const [_0x1d2225,_0x4a750a]=await this['appEntity'][_0x291536(0xe6)]({'where':_0xcbca52,'order':{[_0x77e078]:_0x291536(0xff)},'skip':(page-0x1)*size,'take':size}),_0xad363d=_0x1d2225[_0x291536(0xf9)](_0x14b261=>_0x14b261['catId']),_0x575e4c=await this['appCatsEntity'][_0x291536(0xbe)]({'where':{'id':(0x0,typeorm_1['In'])(_0xad363d)}});return _0x1d2225['forEach'](_0x124491=>{const _0x57ce7e=_0x291536,_0x5b2a9d=_0x575e4c[_0x57ce7e(0xbe)](_0x401c6d=>_0x401c6d['id']===_0x124491[_0x57ce7e(0x10b)]);_0x124491[_0x57ce7e(0xe8)]=_0x5b2a9d?_0x5b2a9d['name']:'';}),_0x5208ef?.[_0x291536(0xcb)]?.[_0x291536(0xc4)]!=='super'&&_0x1d2225[_0x291536(0xda)](_0x3dfaa6=>{delete _0x3dfaa6['preset'];}),{'rows':_0x1d2225,'count':_0x4a750a};}async[_0x134882(0xe0)](_0x4c2996,_0x9b32f1,_0x1e6d6a='id'){const _0x13c8db=_0x134882,{page:page=0x1,size:size=0x64,name:_0x54c91b,catId:_0x2416b5,role:_0x21999a}=_0x9b32f1,_0x4c9510=[{'status':(0x0,typeorm_1['In'])([0x1,0x4]),'userId':(0x0,typeorm_1[_0x13c8db(0xb7)])(),'public':![]},{'userId':(0x0,typeorm_1[_0x13c8db(0x112)])(0x0),'public':!![]}],[_0x19525b,_0x392f4f]=await this[_0x13c8db(0x110)][_0x13c8db(0xe6)]({'where':_0x4c9510,'order':{'order':_0x13c8db(0xff)},'skip':(page-0x1)*size,'take':size}),_0x301f58=_0x19525b[_0x13c8db(0xf9)](_0x220232=>_0x220232[_0x13c8db(0x10b)]),_0x1aeaee=await this['appCatsEntity']['find']({'where':{'id':(0x0,typeorm_1['In'])(_0x301f58)}});return _0x19525b['forEach'](_0x1bbf13=>{const _0x57224f=_0x13c8db,_0x2b779c=_0x1aeaee[_0x57224f(0xbe)](_0x349f25=>_0x349f25['id']===_0x1bbf13[_0x57224f(0x10b)]);_0x1bbf13[_0x57224f(0xe8)]=_0x2b779c?_0x2b779c['name']:'';}),_0x4c2996?.[_0x13c8db(0xcb)]?.[_0x13c8db(0xc4)]!=='super'&&_0x19525b['forEach'](_0x384351=>{delete _0x384351['preset'];}),{'rows':_0x19525b,'count':_0x392f4f};}async[_0x134882(0xb2)](_0x4d64b9){const _0x9aa39b=_0x134882,{name:_0x170ce0,catId:_0x41b7a7}=_0x4d64b9;_0x4d64b9[_0x9aa39b(0xc4)]=_0x9aa39b(0xc7);const _0x4dfbff=await this['appEntity'][_0x9aa39b(0xa9)]({'where':{'name':_0x170ce0}});if(_0x4dfbff)throw new common_1[(_0x9aa39b(0xee))]('该应用名称已存在！',common_1[_0x9aa39b(0xf8)][_0x9aa39b(0xb9)]);const _0x453526=await this[_0x9aa39b(0x117)]['findOne']({'where':{'id':_0x41b7a7}});if(!_0x453526)throw new common_1[(_0x9aa39b(0xee))]('该分类不存在！',common_1['HttpStatus'][_0x9aa39b(0xb9)]);return await this[_0x9aa39b(0x110)]['save'](_0x4d64b9);}async[_0x134882(0x104)](_0xc6de36,_0x5bffc6){const _0x5a1f48=_0x134882,{id:_0x19b6e9}=_0x5bffc6[_0x5a1f48(0xcb)],{name:_0x497ac9,catId:_0x5dbe88,des:_0x108967,preset:_0xf8a0f9,coverImg:_0x580a10,demoData:_0x493cb5,public:_0x567c57,appId:_0x5185e3}=_0xc6de36;if(_0x5185e3){const _0x1a9fb4=await this['appEntity'][_0x5a1f48(0xa9)]({'where':{'id':_0x5185e3,'userId':_0x19b6e9}});if(!_0x1a9fb4)throw new common_1[(_0x5a1f48(0xee))]('您正在编辑一个不存在的应用！',common_1['HttpStatus'][_0x5a1f48(0xb9)]);const _0x52307b={'name':_0x497ac9,'catId':_0x5dbe88,'des':_0x108967,'preset':_0xf8a0f9,'coverImg':_0x580a10,'demoData':_0x493cb5,'public':_0x567c57,'status':_0x567c57?0x3:0x1},_0x1fd49d=await this[_0x5a1f48(0x110)]['update']({'id':_0x5185e3,'userId':_0x19b6e9},_0x52307b);if(_0x1fd49d[_0x5a1f48(0xd6)])return'修改成功';else throw new common_1[(_0x5a1f48(0xee))]('修改失败！',common_1[_0x5a1f48(0xf8)][_0x5a1f48(0xb9)]);}if(!_0x5185e3){const _0x45c18c=await this[_0x5a1f48(0x117)][_0x5a1f48(0xa9)]({'where':{'id':_0x5dbe88}});if(!_0x45c18c)throw new common_1[(_0x5a1f48(0xee))](_0x5a1f48(0xf4),common_1[_0x5a1f48(0xf8)][_0x5a1f48(0xb9)]);const _0x52f957=await this[_0x5a1f48(0x110)]['findOne']({'where':{'name':_0x497ac9}});if(_0x52f957)throw new common_1[(_0x5a1f48(0xee))](_0x5a1f48(0x103),common_1[_0x5a1f48(0xf8)][_0x5a1f48(0xb9)]);const _0x1cf5ca={'name':_0x497ac9,'catId':_0x5dbe88,'des':_0x108967,'preset':_0xf8a0f9,'coverImg':_0x580a10,'status':_0x567c57?0x3:0x1,'demoData':_0x493cb5,'public':_0x567c57,'role':_0x5a1f48(0xcb),'userId':_0x19b6e9},_0x525ca8=await this[_0x5a1f48(0x110)][_0x5a1f48(0x10f)](_0x1cf5ca),_0x1156f3={'appId':_0x525ca8['id'],'userId':_0x19b6e9,'appType':_0x5a1f48(0xcb),'public':_0x567c57,'status':_0x567c57?0x3:0x1,'catId':_0x5dbe88};return this[_0x5a1f48(0xad)][_0x5a1f48(0x10f)](_0x1156f3);}}async[_0x134882(0xbb)](_0x575654){const _0x5b052c=_0x134882,{id:_0x3fbce3,name:_0x309b41,catId:_0x57d0bd,status:_0x489ddf}=_0x575654,_0x4ba4a3=await this[_0x5b052c(0x110)]['findOne']({'where':{'name':_0x309b41,'id':(0x0,typeorm_1[_0x5b052c(0xd5)])(_0x3fbce3)}});if(_0x4ba4a3)throw new common_1[(_0x5b052c(0xee))](_0x5b052c(0x103),common_1[_0x5b052c(0xf8)][_0x5b052c(0xb9)]);const _0x43ca67=await this['appCatsEntity'][_0x5b052c(0xa9)]({'where':{'id':_0x57d0bd}});if(!_0x43ca67)throw new common_1[(_0x5b052c(0xee))](_0x5b052c(0xf4),common_1[_0x5b052c(0xf8)][_0x5b052c(0xb9)]);const _0xd93333=await this[_0x5b052c(0x110)][_0x5b052c(0xa9)]({'where':{'id':_0x3fbce3}});_0xd93333[_0x5b052c(0xf1)]!==_0x575654[_0x5b052c(0xf1)]&&await this['userAppsEntity'][_0x5b052c(0x10d)]({'appId':_0x3fbce3},{'status':_0x489ddf});const _0x9d27d5=await this[_0x5b052c(0x110)][_0x5b052c(0x10d)]({'id':_0x3fbce3},_0x575654);if(_0x9d27d5[_0x5b052c(0xd6)]>0x0)return'修改App信息成功';throw new common_1['HttpException'](_0x5b052c(0xbd),common_1[_0x5b052c(0xf8)][_0x5b052c(0xb9)]);}async[_0x134882(0x10a)](_0x45f7ce){const _0x1b596d=_0x134882,{id:_0x4f57a2}=_0x45f7ce,_0x41507f=await this[_0x1b596d(0x110)]['findOne']({'where':{'id':_0x4f57a2}});if(!_0x41507f)throw new common_1[(_0x1b596d(0xee))](_0x1b596d(0x113),common_1['HttpStatus'][_0x1b596d(0xb9)]);const _0x407f3c=await this[_0x1b596d(0xad)][_0x1b596d(0x106)]({'where':{'appId':_0x4f57a2}});if(_0x407f3c>0x0)throw new common_1[(_0x1b596d(0xee))](_0x1b596d(0xd2),common_1[_0x1b596d(0xf8)]['BAD_REQUEST']);const _0x5dc09c=await this[_0x1b596d(0x110)][_0x1b596d(0xe1)](_0x4f57a2);if(_0x5dc09c[_0x1b596d(0xd6)]>0x0)return'删除App成功';throw new common_1['HttpException'](_0x1b596d(0xe2),common_1[_0x1b596d(0xf8)][_0x1b596d(0xb9)]);}async['auditPass'](_0xa4b3db){const _0x684628=_0x134882,{id:_0x509f03}=_0xa4b3db,_0x5ee501=await this['appEntity'][_0x684628(0xa9)]({'where':{'id':_0x509f03,'status':0x3}});if(!_0x5ee501)throw new common_1[(_0x684628(0xee))](_0x684628(0x113),common_1['HttpStatus'][_0x684628(0xb9)]);return await this[_0x684628(0x110)][_0x684628(0x10d)]({'id':_0x509f03},{'status':0x4}),await this['userAppsEntity'][_0x684628(0x10d)]({'appId':_0x509f03},{'status':0x4}),_0x684628(0xef);}async[_0x134882(0xbc)](_0x56321d){const _0x59d434=_0x134882,{id:_0x26c419}=_0x56321d,_0x323e85=await this[_0x59d434(0x110)][_0x59d434(0xa9)]({'where':{'id':_0x26c419,'status':0x3}});if(!_0x323e85)throw new common_1['HttpException'](_0x59d434(0x113),common_1[_0x59d434(0xf8)][_0x59d434(0xb9)]);return await this['appEntity']['update']({'id':_0x26c419},{'status':0x5}),await this['userAppsEntity'][_0x59d434(0x10d)]({'appId':_0x26c419},{'status':0x5}),_0x59d434(0xc6);}async[_0x134882(0x102)](_0x42e061,_0x52d6d6){const _0x4af4a8=_0x134882,{id:_0x11a899}=_0x42e061,_0x25ede0=await this[_0x4af4a8(0x110)][_0x4af4a8(0xa9)]({'where':{'id':_0x11a899,'userId':_0x52d6d6[_0x4af4a8(0xcb)]['id']}});if(!_0x25ede0)throw new common_1['HttpException']('您正在操作一个不存在的资源！',common_1[_0x4af4a8(0xf8)][_0x4af4a8(0xb9)]);return await this[_0x4af4a8(0x110)][_0x4af4a8(0xe1)](_0x11a899),await this[_0x4af4a8(0xad)][_0x4af4a8(0xe1)]({'appId':_0x11a899,'userId':_0x52d6d6[_0x4af4a8(0xcb)]['id']}),_0x4af4a8(0x10e);}async[_0x134882(0xd7)](_0x250953,_0x13d41a){const _0x826839=_0x134882,{appId:_0x3e7f87}=_0x250953,{id:_0x32334c}=_0x13d41a[_0x826839(0xcb)];try{const _0x5015bf=await this[_0x826839(0xad)][_0x826839(0xa9)]({'where':{'appId':_0x3e7f87,'userId':_0x32334c}})['catch'](_0x197f4b=>{const _0x82bc70=_0x826839;common_1[_0x82bc70(0xc9)][_0x82bc70(0xd4)](_0x197f4b);});if(_0x5015bf){const _0x192a22=await this[_0x826839(0xad)][_0x826839(0xe1)]({'appId':_0x3e7f87,'userId':_0x32334c})[_0x826839(0xf6)](_0x4d30f0=>{const _0x2c5c93=_0x826839;common_1[_0x2c5c93(0xc9)][_0x2c5c93(0xd4)](_0x4d30f0);});if(!_0x192a22||_0x192a22[_0x826839(0xd6)]<=0x0)throw new common_1[(_0x826839(0xee))]('取消移除我的应用失败！',common_1['HttpStatus']['BAD_REQUEST']);return _0x826839(0xfa);}const _0x544530=await this['gptsModelEntity'][_0x826839(0xa9)]({'where':{'id':_0x3e7f87}})[_0x826839(0xf6)](_0x15fc41=>{const _0x55e28a=_0x826839;common_1[_0x55e28a(0xc9)][_0x55e28a(0xd4)](_0x15fc41);});if(!_0x544530)throw new common_1[(_0x826839(0xee))]('操作失败！',common_1[_0x826839(0xf8)][_0x826839(0xb9)]);const _0x47e20d={'userId':_0x32334c,'appId':_0x544530['id'],'catId':_0x544530['groupId'],'appRole':_0x826839(0xc7),'public':!![],'status':0x1};return await this[_0x826839(0xad)][_0x826839(0x10f)](_0x47e20d)[_0x826839(0xf6)](_0x579a27=>{const _0x236c70=_0x826839;common_1[_0x236c70(0xc9)][_0x236c70(0xd4)](_0x579a27);}),_0x544530[_0x826839(0xb8)]=_0x544530['collectCount']+Math[_0x826839(0xe4)](Math[_0x826839(0xea)]()*0xa),await this['gptsModelEntity'][_0x826839(0x10f)](_0x544530),_0x826839(0xb0);}catch(_0x330146){console['log'](_0x330146);}}async['mineApps'](_0x512ff5,_0x4a9935={'page':0x1,'size':0x1e}){const _0x356529=_0x134882,{id:_0x15c1fb}=_0x512ff5[_0x356529(0xcb)],{page:page=0x1,size:size=0x1e}=_0x4a9935,[_0x5911b1,_0x54364b]=await this['userAppsEntity'][_0x356529(0xe6)]({'where':{'userId':_0x15c1fb,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':_0x356529(0xff)},'skip':(page-0x1)*size,'take':size});if(_0x5911b1['length']===0x0)return{'rows':_0x5911b1,'count':_0x54364b};const _0x53b883=_0x5911b1[_0x356529(0xf9)](_0x547ff3=>_0x547ff3['appId']),_0x26430a=await this[_0x356529(0x110)][_0x356529(0xbe)]({'where':{'id':(0x0,typeorm_1['In'])(_0x53b883)}});return _0x5911b1[_0x356529(0xda)](_0x3ed3dd=>{const _0x34115b=_0x356529,_0x1290fe=_0x26430a[_0x34115b(0xbe)](_0x49cfc5=>_0x49cfc5['id']===_0x3ed3dd[_0x34115b(0xc8)]);_0x1290fe&&(_0x3ed3dd[_0x34115b(0xde)]=_0x1290fe[_0x34115b(0xe3)]||'',_0x3ed3dd[_0x34115b(0xa8)]=_0x1290fe[_0x34115b(0xe7)]||'',_0x3ed3dd[_0x34115b(0xc2)]=_0x1290fe[_0x34115b(0xc2)]||'',_0x3ed3dd[_0x34115b(0x116)]=_0x1290fe['demoData']||'',_0x3ed3dd['appRole']=_0x1290fe[_0x34115b(0xc4)]||'',_0x3ed3dd[_0x34115b(0xb4)]=_0x1290fe[_0x34115b(0x107)]===_0x15c1fb?_0x1290fe[_0x34115b(0xb4)]:_0x34115b(0xdf));}),{'rows':_0x5911b1,'count':_0x54364b};}async[_0x134882(0xb5)](_0x1630c9,_0xbb9a17={'page':0x1,'size':0x1e}){const _0x2e7f63=_0x134882,{id:_0x477ecd}=_0x1630c9[_0x2e7f63(0xcb)],{page:page=0x1,size:size=0x1e}=_0xbb9a17;try{const _0x194352=await this[_0x2e7f63(0xdb)][_0x2e7f63(0xfc)](_0x2e7f63(0xaf)+_0x477ecd+_0x2e7f63(0xf5)),_0x4c602d=await this[_0x2e7f63(0xdb)][_0x2e7f63(0xfc)](_0x2e7f63(0xfd)+_0x477ecd+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20'+size+_0x2e7f63(0xb6)+(page-0x1)*size+_0x2e7f63(0xfb));return{'rows':_0x4c602d,'count':Number(_0x194352[0x0]?.[_0x2e7f63(0x106)]||0x0)};}catch(_0x295d92){console[_0x2e7f63(0xd4)](_0x295d92[_0x2e7f63(0xbf)]);}}};AppService=__decorate([(0x0,common_1[_0x134882(0xd9)])(),__param(0x0,(0x0,typeorm_2['InjectRepository'])(appCats_entity_1[_0x134882(0xe9)])),__param(0x1,(0x0,typeorm_2[_0x134882(0xa6)])(app_entity_1[_0x134882(0x115)])),__param(0x2,(0x0,typeorm_2['InjectRepository'])(gpts_model_entity_1[_0x134882(0xc3)])),__param(0x3,(0x0,typeorm_2['InjectRepository'])(userApps_entity_1[_0x134882(0xaa)])),__metadata('design:paramtypes',[typeorm_1[_0x134882(0xca)],typeorm_1[_0x134882(0xca)],typeorm_1['Repository'],typeorm_1[_0x134882(0xca)],typeorm_1['Connection']])],AppService),exports[_0x134882(0xeb)]=AppService;