'use strict';const _0x44336f=_0x3ff5;(function(_0x1f3bb7,_0x278ecd){const _0x3dbc0f=_0x3ff5,_0x2e566b=_0x1f3bb7();while(!![]){try{const _0xf7aa36=-parseInt(_0x3dbc0f(0x160))/0x1+parseInt(_0x3dbc0f(0x157))/0x2*(-parseInt(_0x3dbc0f(0x1ce))/0x3)+parseInt(_0x3dbc0f(0x1af))/0x4+parseInt(_0x3dbc0f(0x18c))/0x5+parseInt(_0x3dbc0f(0x1ba))/0x6+-parseInt(_0x3dbc0f(0x1a6))/0x7+parseInt(_0x3dbc0f(0x15e))/0x8;if(_0xf7aa36===_0x278ecd)break;else _0x2e566b['push'](_0x2e566b['shift']());}catch(_0x3d9fb6){_0x2e566b['push'](_0x2e566b['shift']());}}}(_0x5313,0xe7fe8));var __decorate=this&&this[_0x44336f(0x1be)]||function(_0x2a20d8,_0x5a4308,_0x507a20,_0x9183aa){const _0x82d172=_0x44336f;var _0xf9ad0c=arguments[_0x82d172(0x19b)],_0x45a4da=_0xf9ad0c<0x3?_0x5a4308:_0x9183aa===null?_0x9183aa=Object[_0x82d172(0x18e)](_0x5a4308,_0x507a20):_0x9183aa,_0x136f3e;if(typeof Reflect===_0x82d172(0x180)&&typeof Reflect['decorate']==='function')_0x45a4da=Reflect[_0x82d172(0x17b)](_0x2a20d8,_0x5a4308,_0x507a20,_0x9183aa);else{for(var _0x5f2836=_0x2a20d8['length']-0x1;_0x5f2836>=0x0;_0x5f2836--)if(_0x136f3e=_0x2a20d8[_0x5f2836])_0x45a4da=(_0xf9ad0c<0x3?_0x136f3e(_0x45a4da):_0xf9ad0c>0x3?_0x136f3e(_0x5a4308,_0x507a20,_0x45a4da):_0x136f3e(_0x5a4308,_0x507a20))||_0x45a4da;}return _0xf9ad0c>0x3&&_0x45a4da&&Object[_0x82d172(0x1b6)](_0x5a4308,_0x507a20,_0x45a4da),_0x45a4da;},__metadata=this&&this[_0x44336f(0x1cb)]||function(_0x562f69,_0x195f61){const _0x1e71d3=_0x44336f;if(typeof Reflect===_0x1e71d3(0x180)&&typeof Reflect['metadata']===_0x1e71d3(0x163))return Reflect['metadata'](_0x562f69,_0x195f61);},__param=this&&this[_0x44336f(0x153)]||function(_0x5da803,_0x5b035d){return function(_0x27ffed,_0x1993da){_0x5b035d(_0x27ffed,_0x1993da,_0x5da803);};};function _0x3ff5(_0x2057f3,_0x3f2aa1){const _0x5313ca=_0x5313();return _0x3ff5=function(_0x3ff55b,_0xed7008){_0x3ff55b=_0x3ff55b-0x148;let _0xb9c1=_0x5313ca[_0x3ff55b];return _0xb9c1;},_0x3ff5(_0x2057f3,_0x3f2aa1);}Object['defineProperty'](exports,_0x44336f(0x184),{'value':!![]}),exports[_0x44336f(0x181)]=void 0x0;const common_1=require(_0x44336f(0x154)),typeorm_1=require(_0x44336f(0x168)),user_entity_1=require(_0x44336f(0x1ca)),typeorm_2=require(_0x44336f(0x15b)),chatLog_entity_1=require(_0x44336f(0x17e)),balance_constant_1=require(_0x44336f(0x167)),date_1=require(_0x44336f(0x193)),axios_1=require(_0x44336f(0x1ae)),config_entity_1=require(_0x44336f(0x191)),order_entity_1=require(_0x44336f(0x17a)),midjourney_entity_1=require(_0x44336f(0x1d3)),midjourney_constant_1=require(_0x44336f(0x186));function _0x5313(){const _0x485e27=['day','setHours','DATE(chatlog.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','chatlog.type\x20=\x20:type','sum','请先配置百度统计accessToken','countDraws','getRawMany','getTime','overview/getTimeTrendRpt','https://openapi.baidu.com/rest/2.0/tongji/report/getData?access_token=','getChatStatistic','midjourneyEntity','userEntity','countTotalCollection','__param','@nestjs/common','where','push','4cdXnTy','countChatsByTimeRange','diff','ConfigEntity','typeorm','configVal','countMjDrawsByTimeRange','17466544EErTlR','midjourney.status\x20=\x20:status','827989LhUVgM','&end_date=','configKey','function','countNewUsersToday','chatLogEntity','countTotalMusic','../../common/constants/balance.constant','@nestjs/typeorm','getBaiduVisit','configEntity','countNewOrdersToday','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATE_FORMAT(\x20createdAt,\x20\x27','DRAWED','\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27','countNewChatsToday','midjourney','value','DATE(midjourney.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','baiduSiteId','YYYYMMDD','countNewDrawsToday','PAINT_TYPE','orderBy','chatLog','startTime','../order/order.entity','decorate','now','chatLog.createdAt\x20<\x20:tomorrow','../chatLog/chatLog.entity','count','object','StatisticService','get','HttpStatus','__esModule','百度授权码过期','../../common/constants/midjourney.constant','date','andWhere','CHAT_TYPE','result','BAD_REQUEST','277950wYUZzC','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20model\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20count(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','getOwnPropertyDescriptor','chatlog.modelType\x20=\x20\x27music\x27','map','../globalConfig/config.entity','Repository','../../common/utils/date','setDate','getBaiduStatistics','groupBy','InjectRepository','countChats','SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201','countUsers','length','music','data','orderEntity','countTodayMusic','getCount','getDate','order.createdAt\x20>=\x20:today','Injectable','%Y-%m-%d\x20%H:00','midjourney.createdAt\x20>=\x20:today','5913964HVImxL','HttpException','OrderEntity','toFixed','connection','M.DD','chatlog','getBaseStatistic','axios','959632CBsYMr','pv_count,visitor_count,ip_count,bounce_ratio,avg_visit_time','endTime','select','query','baiduToken','formatDate','defineProperty','&metrics=','order','midjourney.createdAt\x20<\x20:tomorrow','9604554orZKOd','design:paramtypes','&method=','countNewMidhourneysToday','__decorate','请先配置百度统计siteId','order.createdAt\x20<\x20:tomorrow','default','find','createQueryBuilder','ChatLogEntity','\x27\x20)\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','modelUse','chatLog.type\x20=\x20:type','DeductionKey','chatlog.createdAt\x20>=\x20:startDate','../user/user.entity','__metadata','IsNull','countOrders','2184729nUmpZW','user.createdAt\x20>=\x20:today','MidjourneyStatusEnum','midjourney.createdAt\x20>=\x20:startDate','SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201\x20AND\x20DATE(updatedAt)\x20=\x20CURDATE()','../midjourney/midjourney.entity'];_0x5313=function(){return _0x485e27;};return _0x5313();}let StatisticService=class StatisticService{constructor(_0x424c66,_0x194aa8,_0x17e276,_0x5abc14,_0x246768,_0x94005f){const _0x1fd445=_0x44336f;this[_0x1fd445(0x151)]=_0x424c66,this[_0x1fd445(0x165)]=_0x194aa8,this[_0x1fd445(0x16a)]=_0x17e276,this['orderEntity']=_0x5abc14,this[_0x1fd445(0x150)]=_0x246768,this[_0x1fd445(0x1aa)]=_0x94005f;}async[_0x44336f(0x1ad)](){const _0x383354=_0x44336f,_0x39c56f=await this[_0x383354(0x19a)](),_0x49263f=await this['countNewUsersToday'](),_0x5dc71d=await this[_0x383354(0x198)](),_0x4ed4db=await this[_0x383354(0x16f)](),_0x397b98=await this['countDraws'](),_0x4613a9=await this['countNewDrawsToday'](),_0x16557a=await this[_0x383354(0x1bd)](),_0x50eca3=await this[_0x383354(0x1cd)](),_0x32aaf4=await this[_0x383354(0x16b)](),_0x33256e=await this['countTodayCollection'](),_0x2c5e4e=await this[_0x383354(0x152)](),_0x144a6c=await this[_0x383354(0x19f)](),_0xfbde6c=await this['countTotalMusic']();return{'userCount':_0x39c56f,'newUserCount':_0x49263f,'chatCount':_0x5dc71d,'newChatCount':_0x4ed4db,'drawCount':_0x397b98,'newDrawCount':_0x16557a+_0x4613a9,'orderCount':_0x50eca3,'newOrderCount':_0x32aaf4,'todayBrokerage':0x0,'totalBrokerage':0x0,'todayCollection':_0x33256e,'totalCollection':_0x2c5e4e,'todayMusic':_0x144a6c,'totalMusic':_0xfbde6c,'todayVideo':0x0,'totalVideo':0x0};}async[_0x44336f(0x14f)]({days:days=0x7}){const _0x32ebdd=_0x44336f,_0x5eb582=await this[_0x32ebdd(0x158)](days),_0x336e9=await this['countDrawsByTimeRange'](days),_0x5a1635=await this[_0x32ebdd(0x15d)](days);return{'date':_0x5eb582['map'](_0x2fb285=>_0x2fb285['date']),'chat':_0x5eb582[_0x32ebdd(0x190)](_0x237dc5=>_0x237dc5['value']),'draw':_0x336e9[_0x32ebdd(0x190)]((_0x23bdb6,_0x202f4c)=>{const _0x5bb0a8=_0x32ebdd;return _0x23bdb6[_0x5bb0a8(0x171)]+_0x5a1635[_0x202f4c][_0x5bb0a8(0x171)];})};}async[_0x44336f(0x169)]({days:days=0x7}){const _0x32f14d=await this['getBaiduStatistics'](days);return _0x32f14d;}async[_0x44336f(0x19a)](){const _0x33a4db=await this['userEntity']['count']();return _0x33a4db;}async[_0x44336f(0x164)](){const _0x3a98f4=_0x44336f,_0x5ba07f=new Date();_0x5ba07f[_0x3a98f4(0x1d5)](0x0,0x0,0x0,0x0);const _0x2dc57c=new Date(_0x5ba07f[_0x3a98f4(0x14c)]()+0x18*0x3c*0x3c*0x3e8),_0x1721ce=this[_0x3a98f4(0x151)]['createQueryBuilder']('user'),_0x3a12f4=await _0x1721ce[_0x3a98f4(0x155)](_0x3a98f4(0x1cf),{'today':_0x5ba07f})[_0x3a98f4(0x188)]('user.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x2dc57c})[_0x3a98f4(0x1a0)]();return _0x3a12f4;}async[_0x44336f(0x198)](){const _0x29c39a=_0x44336f,_0x5284e5=await this[_0x29c39a(0x165)][_0x29c39a(0x17f)]({'where':{'type':balance_constant_1[_0x29c39a(0x1c8)]['CHAT_TYPE']}});return _0x5284e5;}async[_0x44336f(0x16f)](){const _0x2cd31a=_0x44336f,_0x264598=new Date();_0x264598[_0x2cd31a(0x1d5)](0x0,0x0,0x0,0x0);const _0x51d1e2=new Date(_0x264598['getTime']()+0x18*0x3c*0x3c*0x3e8),_0x38153f=this[_0x2cd31a(0x165)]['createQueryBuilder'](_0x2cd31a(0x178)),_0x9a6cab=await _0x38153f[_0x2cd31a(0x155)](_0x2cd31a(0x1c7),{'type':balance_constant_1[_0x2cd31a(0x1c8)]['CHAT_TYPE']})[_0x2cd31a(0x188)]('chatLog.createdAt\x20>=\x20:today',{'today':_0x264598})['andWhere'](_0x2cd31a(0x17d),{'tomorrow':_0x51d1e2})[_0x2cd31a(0x1a0)]();return _0x9a6cab;}async[_0x44336f(0x14a)](){const _0x1f9fe5=_0x44336f,_0x447c2a=await this[_0x1f9fe5(0x165)]['count']({'where':{'type':balance_constant_1['DeductionKey'][_0x1f9fe5(0x176)]}});return _0x447c2a;}async[_0x44336f(0x175)](){const _0x414e98=_0x44336f,_0x130dc9=new Date();_0x130dc9[_0x414e98(0x1d5)](0x0,0x0,0x0,0x0);const _0x25c33c=new Date(_0x130dc9['getTime']()+0x18*0x3c*0x3c*0x3e8),_0x1f7463=this[_0x414e98(0x165)][_0x414e98(0x1c3)]('chatLog'),_0x2bf0b9=await _0x1f7463['where']('chatLog.type\x20=\x20:type',{'type':balance_constant_1['DeductionKey'][_0x414e98(0x176)]})[_0x414e98(0x188)]('chatLog.createdAt\x20>=\x20:today',{'today':_0x130dc9})[_0x414e98(0x188)](_0x414e98(0x17d),{'tomorrow':_0x25c33c})[_0x414e98(0x1a0)]();return _0x2bf0b9;}async['countNewMidhourneysToday'](){const _0x4b078b=_0x44336f,_0x1204ce=new Date();_0x1204ce[_0x4b078b(0x1d5)](0x0,0x0,0x0,0x0);const _0x6d276a=new Date(_0x1204ce[_0x4b078b(0x14c)]()+0x18*0x3c*0x3c*0x3e8),_0x218a5c=this[_0x4b078b(0x150)][_0x4b078b(0x1c3)](_0x4b078b(0x170)),_0x56eb31=await _0x218a5c[_0x4b078b(0x155)](_0x4b078b(0x1a5),{'today':_0x1204ce})[_0x4b078b(0x188)](_0x4b078b(0x1b9),{'tomorrow':_0x6d276a})[_0x4b078b(0x1a0)]();return _0x56eb31;}async[_0x44336f(0x158)](_0x358931){const _0x467246=_0x44336f,_0x20d8f7=new Date();_0x20d8f7[_0x467246(0x1d5)](0x0,0x0,0x0,0x0);const _0x445ede=new Date(_0x20d8f7[_0x467246(0x14c)]()-(_0x358931-0x1)*0x18*0x3c*0x3c*0x3e8),_0x45c92b=this[_0x467246(0x165)][_0x467246(0x1c3)]('chatlog'),_0x3bd4c2=await _0x45c92b[_0x467246(0x1b2)](_0x467246(0x1d6))[_0x467246(0x155)](_0x467246(0x1d7),{'type':balance_constant_1[_0x467246(0x1c8)][_0x467246(0x189)]})[_0x467246(0x188)](_0x467246(0x1c9),{'startDate':_0x445ede})[_0x467246(0x196)](_0x467246(0x187))[_0x467246(0x177)](_0x467246(0x187))['getRawMany'](),_0x5289bc=[],_0x4e52bd=_0x445ede;for(let _0x1efa00=0x0;_0x1efa00<_0x358931;_0x1efa00++){const _0x1a391c=(0x0,date_1['formatDate'])(new Date(_0x4e52bd),'M.DD'),_0x5107d8=_0x3bd4c2[_0x467246(0x1c2)](_0x394855=>(0x0,date_1[_0x467246(0x1b5)])(new Date(_0x394855[_0x467246(0x187)]),_0x467246(0x1ab))===_0x1a391c)?.['count']??0x0;_0x5107d8>0x0?_0x5289bc[_0x467246(0x156)]({'date':_0x1a391c,'value':Number(_0x5107d8)}):_0x5289bc[_0x467246(0x156)]({'date':_0x1a391c,'value':0x0}),_0x4e52bd[_0x467246(0x194)](_0x4e52bd['getDate']()+0x1);}return _0x5289bc;}async['countDrawsByTimeRange'](_0x2f565a){const _0x2aba20=_0x44336f,_0x164dac=new Date();_0x164dac['setHours'](0x0,0x0,0x0,0x0);const _0x4b6067=new Date(_0x164dac[_0x2aba20(0x14c)]()-(_0x2f565a-0x1)*0x18*0x3c*0x3c*0x3e8),_0x35e71f=this[_0x2aba20(0x165)][_0x2aba20(0x1c3)]('chatlog'),_0x394498=await _0x35e71f[_0x2aba20(0x1b2)](_0x2aba20(0x1d6))['where'](_0x2aba20(0x1d7),{'type':balance_constant_1['DeductionKey'][_0x2aba20(0x176)]})[_0x2aba20(0x188)](_0x2aba20(0x1c9),{'startDate':_0x4b6067})[_0x2aba20(0x196)](_0x2aba20(0x187))[_0x2aba20(0x177)](_0x2aba20(0x187))[_0x2aba20(0x14b)](),_0x5e312f=[],_0x2a451a=_0x4b6067;for(let _0x59c69c=0x0;_0x59c69c<_0x2f565a;_0x59c69c++){const _0x25c470=(0x0,date_1[_0x2aba20(0x1b5)])(new Date(_0x2a451a),_0x2aba20(0x1ab)),_0x79016=_0x394498[_0x2aba20(0x1c2)](_0x53ae70=>(0x0,date_1['formatDate'])(new Date(_0x53ae70[_0x2aba20(0x187)]),'M.DD')===_0x25c470)?.['count']??0x0;_0x79016>0x0?_0x5e312f['push']({'date':_0x25c470,'value':Number(_0x79016)}):_0x5e312f[_0x2aba20(0x156)]({'date':_0x25c470,'value':0x0}),_0x2a451a[_0x2aba20(0x194)](_0x2a451a[_0x2aba20(0x1a1)]()+0x1);}return _0x5e312f;}async[_0x44336f(0x15d)](_0xf44232){const _0x531b11=_0x44336f,_0x55d206=new Date();_0x55d206[_0x531b11(0x1d5)](0x0,0x0,0x0,0x0);const _0x16dcca=new Date(_0x55d206[_0x531b11(0x14c)]()-(_0xf44232-0x1)*0x18*0x3c*0x3c*0x3e8),_0x3e43cf=this[_0x531b11(0x150)][_0x531b11(0x1c3)](_0x531b11(0x170)),_0x34dfdb=await _0x3e43cf[_0x531b11(0x1b2)](_0x531b11(0x172))[_0x531b11(0x155)](_0x531b11(0x15f),{'status':midjourney_constant_1[_0x531b11(0x1d0)][_0x531b11(0x16d)]})['andWhere'](_0x531b11(0x1d1),{'startDate':_0x16dcca})[_0x531b11(0x196)](_0x531b11(0x187))[_0x531b11(0x177)]('date')[_0x531b11(0x14b)](),_0x14a021=[],_0x4478b0=_0x16dcca;for(let _0x321869=0x0;_0x321869<_0xf44232;_0x321869++){const _0x43ee27=(0x0,date_1[_0x531b11(0x1b5)])(new Date(_0x4478b0),_0x531b11(0x1ab)),_0x2b97d1=_0x34dfdb['find'](_0x5a3a5e=>(0x0,date_1[_0x531b11(0x1b5)])(new Date(_0x5a3a5e['date']),_0x531b11(0x1ab))===_0x43ee27)?.[_0x531b11(0x17f)]??0x0;_0x2b97d1>0x0?_0x14a021[_0x531b11(0x156)]({'date':_0x43ee27,'value':Number(_0x2b97d1)}):_0x14a021[_0x531b11(0x156)]({'date':_0x43ee27,'value':0x0}),_0x4478b0[_0x531b11(0x194)](_0x4478b0[_0x531b11(0x1a1)]()+0x1);}return _0x14a021;}async[_0x44336f(0x195)](_0x1b6b3d){const _0x5f1c87=_0x44336f,_0x16f7ed=(0x0,date_1[_0x5f1c87(0x1b5)])(new Date(),_0x5f1c87(0x174)),_0x38410a=(0x0,date_1['formatDate'])(new Date(Date[_0x5f1c87(0x17c)]()-Number(_0x1b6b3d-0x1)*0x18*0x3c*0x3c*0x3e8),_0x5f1c87(0x174)),_0x3c92c7=_0x5f1c87(0x1b0),_0x3d6ca7=_0x5f1c87(0x14d),_0x456e3b=await this[_0x5f1c87(0x16a)][_0x5f1c87(0x1c2)]({'where':{'configKey':(0x0,typeorm_2['In'])([_0x5f1c87(0x1b4),_0x5f1c87(0x173)])}}),_0x5ef66a=_0x456e3b[_0x5f1c87(0x1c2)](_0x54602f=>_0x54602f[_0x5f1c87(0x162)]===_0x5f1c87(0x173))?.[_0x5f1c87(0x15c)],_0x4d1a10=_0x456e3b['find'](_0x309ed4=>_0x309ed4['configKey']===_0x5f1c87(0x1b4))?.[_0x5f1c87(0x15c)];if(!_0x5ef66a||!_0x4d1a10)return[];if(!_0x5ef66a)throw new common_1[(_0x5f1c87(0x1a7))](_0x5f1c87(0x1bf),common_1[_0x5f1c87(0x183)][_0x5f1c87(0x18b)]);if(!_0x4d1a10)throw new common_1[(_0x5f1c87(0x1a7))](_0x5f1c87(0x149),common_1['HttpStatus'][_0x5f1c87(0x18b)]);const _0x382548=_0x5f1c87(0x14e)+_0x4d1a10+'&site_id='+_0x5ef66a+_0x5f1c87(0x1bc)+_0x3d6ca7+'&start_date='+_0x38410a+_0x5f1c87(0x161)+_0x16f7ed+_0x5f1c87(0x1b7)+_0x3c92c7,_0x57dfe1=await axios_1['default'][_0x5f1c87(0x182)](_0x382548),{error_code:_0xcc5e8e,message:_0x32dbc8}=_0x57dfe1[_0x5f1c87(0x19d)];if(_0xcc5e8e===0x6f)throw new common_1[(_0x5f1c87(0x1a7))](_0x32dbc8||_0x5f1c87(0x185),common_1['HttpStatus'][_0x5f1c87(0x18b)]);if(_0xcc5e8e&&_0xcc5e8e!==0xc8)throw new common_1[(_0x5f1c87(0x1a7))](_0x32dbc8||'获取百度统计数据失败',common_1[_0x5f1c87(0x183)][_0x5f1c87(0x18b)]);return _0x57dfe1[_0x5f1c87(0x19d)][_0x5f1c87(0x18a)];}async[_0x44336f(0x1cd)](){const _0x3f9d09=_0x44336f,_0xd467f3=await this[_0x3f9d09(0x19e)][_0x3f9d09(0x17f)]();return _0xd467f3;}async[_0x44336f(0x16b)](){const _0x202b47=_0x44336f,_0x29eec0=new Date();_0x29eec0[_0x202b47(0x1d5)](0x0,0x0,0x0,0x0);const _0x106783=new Date(_0x29eec0['getTime']()+0x18*0x3c*0x3c*0x3e8),_0x51eba0=this[_0x202b47(0x19e)]['createQueryBuilder'](_0x202b47(0x1b8)),_0x3aaef4=await _0x51eba0[_0x202b47(0x155)](_0x202b47(0x1a2),{'today':_0x29eec0})[_0x202b47(0x188)](_0x202b47(0x1c0),{'tomorrow':_0x106783})['getCount']();return _0x3aaef4;}async[_0x44336f(0x19f)](){const _0x29321a=_0x44336f,_0x156fc0=new Date();_0x156fc0[_0x29321a(0x1d5)](0x0,0x0,0x0,0x0);const _0x1420cd=new Date(_0x156fc0[_0x29321a(0x14c)]()+0x18*0x3c*0x3c*0x3e8),_0x5fd347=this[_0x29321a(0x165)][_0x29321a(0x1c3)](_0x29321a(0x1ac)),_0x5bb2d9=await _0x5fd347[_0x29321a(0x155)](_0x29321a(0x18f))[_0x29321a(0x188)]('chatlog.answer\x20is\x20not\x20null')[_0x29321a(0x188)]('chatlog.createdAt\x20>=\x20:today',{'today':_0x156fc0})[_0x29321a(0x188)]('chatlog.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x1420cd})[_0x29321a(0x1a0)]();return _0x5bb2d9;}async[_0x44336f(0x166)](){const _0x3fba8a=_0x44336f,_0x258ac2=await this[_0x3fba8a(0x165)][_0x3fba8a(0x17f)]({'where':{'modelType':_0x3fba8a(0x19c),'answer':(0x0,typeorm_2['Not'])((0x0,typeorm_2[_0x3fba8a(0x1cc)])())}});return _0x258ac2;}async['countTodayCollection'](){const _0x1d2070=_0x44336f,_0x44dae7=await this[_0x1d2070(0x1aa)][_0x1d2070(0x1b3)](_0x1d2070(0x1d2)),_0x197401=_0x44dae7[_0x1d2070(0x148)]?Number(_0x44dae7[_0x1d2070(0x148)]):0x0;return _0x197401['toFixed'](0x2);}async[_0x44336f(0x152)](){const _0x1e2f25=_0x44336f,_0x4f9106=await this[_0x1e2f25(0x1aa)][_0x1e2f25(0x1b3)](_0x1e2f25(0x199)),_0x49d37a=_0x4f9106[_0x1e2f25(0x148)]?Number(_0x4f9106[_0x1e2f25(0x148)]):0x0;return _0x49d37a[_0x1e2f25(0x1a9)](0x2);}async[_0x44336f(0x1c6)](_0xdd932e){const _0x3da84a=_0x44336f,_0x13a704=await this[_0x3da84a(0x1aa)]['query'](_0x3da84a(0x18d)+_0xdd932e[_0x3da84a(0x179)]+_0x3da84a(0x16e)+_0xdd932e['endTime']+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x0a\x20\x20\x20\x20'),_0x15969d=(0x0,date_1[_0x3da84a(0x1c1)])(_0xdd932e[_0x3da84a(0x179)])[_0x3da84a(0x159)]((0x0,date_1[_0x3da84a(0x1c1)])(_0xdd932e[_0x3da84a(0x1b1)]),_0x3da84a(0x1d4)),_0x4cf79d=_0x15969d===0x0?_0x3da84a(0x1a4):'%Y-%m-%d',_0x1d3782=await this[_0x3da84a(0x1aa)][_0x3da84a(0x1b3)](_0x3da84a(0x16c)+_0x4cf79d+_0x3da84a(0x1c5)+_0xdd932e[_0x3da84a(0x179)]+_0x3da84a(0x16e)+_0xdd932e[_0x3da84a(0x1b1)]+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x20\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName;\x0a\x20\x20\x20\x20');return{'pie':_0x13a704,'line':_0x1d3782};}};StatisticService=__decorate([(0x0,common_1[_0x44336f(0x1a3)])(),__param(0x0,(0x0,typeorm_1[_0x44336f(0x197)])(user_entity_1['UserEntity'])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(chatLog_entity_1[_0x44336f(0x1c4)])),__param(0x2,(0x0,typeorm_1[_0x44336f(0x197)])(config_entity_1[_0x44336f(0x15a)])),__param(0x3,(0x0,typeorm_1[_0x44336f(0x197)])(order_entity_1[_0x44336f(0x1a8)])),__param(0x4,(0x0,typeorm_1[_0x44336f(0x197)])(midjourney_entity_1['MidjourneyEntity'])),__metadata(_0x44336f(0x1bb),[typeorm_2[_0x44336f(0x192)],typeorm_2[_0x44336f(0x192)],typeorm_2[_0x44336f(0x192)],typeorm_2[_0x44336f(0x192)],typeorm_2[_0x44336f(0x192)],typeorm_2['Connection']])],StatisticService),exports[_0x44336f(0x181)]=StatisticService;