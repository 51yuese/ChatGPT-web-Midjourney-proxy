'use strict';const _0x49230f=_0x35c5;(function(_0xe2fcfd,_0x22d71b){const _0x5b32ee=_0x35c5,_0x472212=_0xe2fcfd();while(!![]){try{const _0x38b9aa=parseInt(_0x5b32ee(0xaa))/0x1+-parseInt(_0x5b32ee(0xd8))/0x2*(parseInt(_0x5b32ee(0xab))/0x3)+-parseInt(_0x5b32ee(0xaf))/0x4+parseInt(_0x5b32ee(0xcb))/0x5*(-parseInt(_0x5b32ee(0xc3))/0x6)+parseInt(_0x5b32ee(0xa4))/0x7*(-parseInt(_0x5b32ee(0xd3))/0x8)+-parseInt(_0x5b32ee(0xcc))/0x9+-parseInt(_0x5b32ee(0xa7))/0xa*(-parseInt(_0x5b32ee(0xce))/0xb);if(_0x38b9aa===_0x22d71b)break;else _0x472212['push'](_0x472212['shift']());}catch(_0x3b1be8){_0x472212['push'](_0x472212['shift']());}}}(_0x4b05,0x3a9e6));var __decorate=this&&this['__decorate']||function(_0x5f0275,_0x51257b,_0x229374,_0x3445a9){const _0x55b2ef=_0x35c5;var _0x5869b8=arguments[_0x55b2ef(0xbd)],_0x30d946=_0x5869b8<0x3?_0x51257b:_0x3445a9===null?_0x3445a9=Object[_0x55b2ef(0xad)](_0x51257b,_0x229374):_0x3445a9,_0x17a54e;if(typeof Reflect===_0x55b2ef(0xb7)&&typeof Reflect['decorate']===_0x55b2ef(0xc7))_0x30d946=Reflect[_0x55b2ef(0xb0)](_0x5f0275,_0x51257b,_0x229374,_0x3445a9);else{for(var _0x50297a=_0x5f0275[_0x55b2ef(0xbd)]-0x1;_0x50297a>=0x0;_0x50297a--)if(_0x17a54e=_0x5f0275[_0x50297a])_0x30d946=(_0x5869b8<0x3?_0x17a54e(_0x30d946):_0x5869b8>0x3?_0x17a54e(_0x51257b,_0x229374,_0x30d946):_0x17a54e(_0x51257b,_0x229374))||_0x30d946;}return _0x5869b8>0x3&&_0x30d946&&Object[_0x55b2ef(0xc1)](_0x51257b,_0x229374,_0x30d946),_0x30d946;},__metadata=this&&this[_0x49230f(0xc6)]||function(_0xfa3fc9,_0x17957d){const _0x340cf3=_0x49230f;if(typeof Reflect===_0x340cf3(0xb7)&&typeof Reflect[_0x340cf3(0xd0)]===_0x340cf3(0xc7))return Reflect[_0x340cf3(0xd0)](_0xfa3fc9,_0x17957d);},__param=this&&this[_0x49230f(0xbf)]||function(_0x51b850,_0x4f7494){return function(_0x284c42,_0x2a8ae1){_0x4f7494(_0x284c42,_0x2a8ae1,_0x51b850);};};Object[_0x49230f(0xc1)](exports,_0x49230f(0xca),{'value':!![]}),exports[_0x49230f(0xb1)]=void 0x0;const globalConfig_service_1=require(_0x49230f(0xc0)),common_1=require(_0x49230f(0xba)),schedule_1=require(_0x49230f(0xa6)),userBalance_entity_1=require(_0x49230f(0xd1)),typeorm_1=require(_0x49230f(0xc4)),typeorm_2=require('typeorm'),models_service_1=require(_0x49230f(0xd2));function _0x4b05(){const _0x55b7d7=['design:type','534UnBSwI','@nestjs/typeorm','UserBalanceEntity','__metadata','function','prototype','EVERY_HOUR','__esModule','13640ETXHhk','3236058bjdhsW','CronExpression','7494146xCiJzR','getWechatAccessToken','metadata','../userBalance/userBalance.entity','../models/models.service','180392EnPXBv','pushLog','Cron','globalConfigService','modelsService','11874ZUmhBS','update','21onFlue','refreshBaiduAccesstoken','@nestjs/schedule','10QotcAs','会员已到期、清空所有余额并移除会员身份！','Injectable','441348DvMQxr','69dSieMg','debug','getOwnPropertyDescriptor','Repository','303920GgAjEm','decorate','TaskService','userBalanceEntity','design:returntype','forEach','goMaxAiAuth','checkUserMemerExpire','object','find','then','@nestjs/common','checkAuth','EVERY_5_MINUTES','length','design:paramtypes','__param','./../globalConfig/globalConfig.service','defineProperty'];_0x4b05=function(){return _0x55b7d7;};return _0x4b05();}let TaskService=class TaskService{constructor(_0x1d35cc,_0x1d6d4b,_0x40573c){const _0x219b0d=_0x49230f;this[_0x219b0d(0xb2)]=_0x1d35cc,this[_0x219b0d(0xd6)]=_0x1d6d4b,this['modelsService']=_0x40573c;}['handleCron'](){const _0x2471e5=_0x49230f;common_1['Logger'][_0x2471e5(0xac)]('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x2471e5(0xb1)),this[_0x2471e5(0xd6)][_0x2471e5(0xcf)]();}async[_0x49230f(0xbb)](){const _0x3aa8b1=_0x49230f;await this['globalConfigService'][_0x3aa8b1(0xb5)](),await this[_0x3aa8b1(0xd6)][_0x3aa8b1(0xd4)]();}async[_0x49230f(0xb6)](){const _0x50704a=_0x49230f,_0x4c464c=await this[_0x50704a(0xb2)][_0x50704a(0xb8)]({'where':{'expirationTime':(0x0,typeorm_2['LessThanOrEqual'])(new Date())}});if(!_0x4c464c||!_0x4c464c[_0x50704a(0xbd)])return;_0x4c464c[_0x50704a(0xb4)](_0x76e00a=>{const _0x4e822b=_0x50704a;this[_0x4e822b(0xb2)][_0x4e822b(0xd9)]({'id':_0x76e00a['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x4e822b(0xb9)](_0x93fbf7=>{const _0x206edc=_0x4e822b;common_1['Logger'][_0x206edc(0xac)](_0x76e00a['id']+_0x206edc(0xa8),_0x206edc(0xb1));});});}['refreshBaiduAccesstoken'](){const _0x272626=_0x49230f;this[_0x272626(0xd7)]['refreshBaiduAccesstoken']();}};function _0x35c5(_0x282ffd,_0x1feb1b){const _0x4b05e1=_0x4b05();return _0x35c5=function(_0x35c5d2,_0x4d47b1){_0x35c5d2=_0x35c5d2-0xa4;let _0x3a2d59=_0x4b05e1[_0x35c5d2];return _0x3a2d59;},_0x35c5(_0x282ffd,_0x1feb1b);}__decorate([(0x0,schedule_1['Cron'])(schedule_1['CronExpression'][_0x49230f(0xc9)]),__metadata(_0x49230f(0xc2),Function),__metadata(_0x49230f(0xbe),[]),__metadata(_0x49230f(0xb3),void 0x0)],TaskService[_0x49230f(0xc8)],'handleCron',null),__decorate([(0x0,schedule_1[_0x49230f(0xd5)])(schedule_1[_0x49230f(0xcd)][_0x49230f(0xc9)]),__metadata(_0x49230f(0xc2),Function),__metadata(_0x49230f(0xbe),[]),__metadata(_0x49230f(0xb3),Promise)],TaskService[_0x49230f(0xc8)],_0x49230f(0xbb),null),__decorate([(0x0,schedule_1[_0x49230f(0xd5)])(schedule_1[_0x49230f(0xcd)][_0x49230f(0xbc)]),__metadata(_0x49230f(0xc2),Function),__metadata(_0x49230f(0xbe),[]),__metadata(_0x49230f(0xb3),Promise)],TaskService[_0x49230f(0xc8)],_0x49230f(0xb6),null),__decorate([(0x0,schedule_1['Cron'])('0\x200\x20*/5\x20*\x20*'),__metadata(_0x49230f(0xc2),Function),__metadata(_0x49230f(0xbe),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x49230f(0xc8)],_0x49230f(0xa5),null),TaskService=__decorate([(0x0,common_1[_0x49230f(0xa9)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(userBalance_entity_1[_0x49230f(0xc5)])),__metadata(_0x49230f(0xbe),[typeorm_2[_0x49230f(0xae)],globalConfig_service_1['GlobalConfigService'],models_service_1['ModelsService']])],TaskService),exports[_0x49230f(0xb1)]=TaskService;